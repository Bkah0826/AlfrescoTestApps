!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/cdk/keycodes"),require("@angular/material/core"),require("@angular/platform-browser"),require("@angular/animations"),require("@mat-datetimepicker/core"),require("@mat-datetimepicker/moment"),require("@angular/flex-layout"),require("@angular/material/dialog"),require("moment-es6"),require("@angular/material"),require("@ngx-translate/core"),require("rxjs"),require("@angular/cdk/tree"),require("@alfresco/js-api"),require("rxjs/operators"),require("@angular/common"),require("@angular/core"),require("@angular/forms"),require("@alfresco/adf-core")):"function"==typeof define&&define.amd?define("@alfresco/adf-content-services",["exports","@angular/cdk/keycodes","@angular/material/core","@angular/platform-browser","@angular/animations","@mat-datetimepicker/core","@mat-datetimepicker/moment","@angular/flex-layout","@angular/material/dialog","moment-es6","@angular/material","@ngx-translate/core","rxjs","@angular/cdk/tree","@alfresco/js-api","rxjs/operators","@angular/common","@angular/core","@angular/forms","@alfresco/adf-core"],t):t((e.alfresco=e.alfresco||{},e.alfresco["adf-content-services"]={}),e.ng.cdk.keycodes,e["@angular/material/core"],e.ng.platformBrowser,e["@angular/animations"],e["@mat-datetimepicker/core"],e["@mat-datetimepicker/moment"],e["@angular/flex-layout"],e.ng.material.dialog,e["moment-es6"],e["@angular/material"],e["@ngx-translate/core"],e.rxjs,e.ng.cdk.tree,e["@alfresco/js-api"],e.rxjs.operators,e.ng.common,e.ng.core,e.ng.forms,e["@alfresco/adf-core"])}(this,function(e,n,t,i,o,r,a,s,l,c,d,p,u,h,f,m,g,y,v,b){"use strict";function S(){return[d.MatButtonModule,d.MatChipsModule,d.MatDialogModule,d.MatIconModule,d.MatCardModule,d.MatInputModule,d.MatListModule,d.MatProgressSpinnerModule,d.MatProgressBarModule,d.MatRippleModule,d.MatMenuModule,d.MatOptionModule,d.MatExpansionModule,d.MatSelectModule,d.MatCheckboxModule,d.MatDatepickerModule,d.MatSlideToggleModule,d.MatRadioModule,d.MatSliderModule,d.MatTreeModule]}c=c&&c.hasOwnProperty("default")?c["default"]:c;var I=(E.decorators=[{type:y.NgModule,args:[{imports:S(),exports:S()}]}],E);function E(){}var A=function(e,t){return(A=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function C(e,t){function n(){this.constructor=e}A(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var T=function(){return(T=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function O(t,a,s,l){return new(s=s||Promise)(function(e,n){function i(e){try{r(l.next(e))}catch(t){n(t)}}function o(e){try{r(l["throw"](e))}catch(t){n(t)}}function r(t){t.done?e(t.value):new s(function(e){e(t.value)}).then(i,o)}r((l=l.apply(t,a||[])).next())})}function D(i,o){var r,a,s,e,l={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return e={next:t(0),"throw":t(1),"return":t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function n(e){if(r)throw new TypeError("Generator is already executing.");for(;l;)try{if(r=1,a&&(s=2&e[0]?a["return"]:e[0]?a["throw"]||((s=a["return"])&&s.call(a),0):a.next)&&!(s=s.call(a,e[1])).done)return s;switch(a=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return l.label++,{value:e[1],done:!1};case 5:l.label++,a=e[1],e=[0];continue;case 7:e=l.ops.pop(),l.trys.pop();continue;default:if(!(s=0<(s=l.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){l=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){l.label=e[1];break}if(6===e[0]&&l.label<s[1]){l.label=s[1],s=e;break}if(s&&l.label<s[2]){l.label=s[2],l.ops.push(e);break}s[2]&&l.ops.pop(),l.trys.pop();continue}e=o.call(i,l)}catch(t){e=[6,t],a=0}finally{r=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([t,e])}}}function w(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}function L(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,o,r=n.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(i=r.next()).done;)a.push(i.value)}catch(s){o={error:s}}finally{try{i&&!i.done&&(n=r["return"])&&n.call(r)}finally{if(o)throw o.error}}return a}function N(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(L(arguments[t]));return e}
/*!
     * @license
     * Copyright 2019 Alfresco Software, Ltd.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *     http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var F=function Go(e,t){this.currentNode=e,this.children=t},R=(k.prototype.getRecentFiles=function(e,r,a){var s=this,l=['TYPE:"content"','-PNAME:"0/wiki"','-TYPE:"app:filelink"','-TYPE:"cm:thumbnail"','-TYPE:"cm:failedThumbnail"','-TYPE:"cm:rating"','-TYPE:"dl:dataList"','-TYPE:"dl:todoList"','-TYPE:"dl:issue"','-TYPE:"dl:contact"','-TYPE:"dl:eventAgenda"','-TYPE:"dl:event"','-TYPE:"dl:task"','-TYPE:"dl:simpletask"','-TYPE:"dl:meetingAgenda"','-TYPE:"dl:location"','-TYPE:"fm:topic"','-TYPE:"fm:post"','-TYPE:"ia:calendarEvent"','-TYPE:"lnk:link"'];return new u.Observable(function(o){s.apiService.peopleApi.getPerson(e).then(function(e){var t=e.entry.id,n=[{query:"cm:modified:[NOW/DAY-30DAYS TO NOW/DAY+1DAY]"},{query:"cm:modifier:"+t+" OR cm:creator:"+t},{query:l.join(" AND ")}];a&&0<a.length&&n.push({query:a.join()});var i=new f.SearchRequest({query:{query:"*",language:"afts"},filterQueries:n,include:["path","properties","allowableOperations"],sort:[{type:"FIELD",field:"cm:modified",ascending:!1}],paging:{maxItems:r.maxItems,skipCount:r.skipCount}});return s.apiService.searchApi.search(i).then(function(e){o.next(e),o.complete()},function(e){o.error(e),o.complete()})},function(e){o.error(e),o.complete()})}).pipe(m.catchError(function(e){return s.handleError(e)}))},k.prototype.loadFavorites=function(e,t){var i=this;void 0===t&&(t=[]);var n=this.getIncludesFields(t),o={maxItems:e.maxItems,skipCount:e.skipCount,where:"(EXISTS(target/file) OR EXISTS(target/folder))",include:n};return new u.Observable(function(n){i.apiService.favoritesApi.getFavorites("-me-",o).then(function(e){var t={list:{entries:e.list.entries.map(function(e){var t=e.entry.target;return{entry:t.file||t.folder}}).map(function(e){var t=e.entry;return t.properties={"cm:title":t.title,"cm:description":t.description},{entry:t}}),pagination:e.list.pagination}};n.next(t),n.complete()},function(e){n.error(e),n.complete()})}).pipe(m.catchError(function(e){return i.handleError(e)}))},k.prototype.loadMemberSites=function(e){var i=this,t={include:["properties"],maxItems:e.maxItems,skipCount:e.skipCount};return new u.Observable(function(n){i.apiService.peopleApi.listSiteMembershipsForPerson("-me-",t).then(function(e){var t=new f.SiteMemberPaging({list:{entries:e.list.entries.map(function(e){var t=e.entry.site;return t.allowableOperations=t.allowableOperations?t.allowableOperations:[i.CREATE_PERMISSION],t.name=t.name||t.title,{entry:t}}),pagination:e.list.pagination}});n.next(t),n.complete()},function(e){n.error(e),n.complete()})}).pipe(m.catchError(function(e){return i.handleError(e)}))},k.prototype.loadSites=function(e){var n=this,i={include:["properties","aspectNames"],maxItems:e.maxItems,skipCount:e.skipCount};return new u.Observable(function(t){n.apiService.sitesApi.getSites(i).then(function(e){e.list.entries.map(function(e){var t=e.entry;return t.name=t.name||t.title,{entry:t}}),t.next(e),t.complete()},function(e){t.error(e),t.complete()})}).pipe(m.catchError(function(e){return n.handleError(e)}))},k.prototype.loadTrashcan=function(e,t){var n=this;void 0===t&&(t=[]);var i={include:this.getIncludesFields(t),maxItems:e.maxItems,skipCount:e.skipCount};return u.from(this.apiService.nodesApi.getDeletedNodes(i)).pipe(m.catchError(function(e){return n.handleError(e)}))},k.prototype.loadSharedLinks=function(e,t){var n=this;void 0===t&&(t=[]);var i={include:this.getIncludesFields(t),maxItems:e.maxItems,skipCount:e.skipCount};return u.from(this.apiService.sharedLinksApi.findSharedLinks(i)).pipe(m.catchError(function(e){return n.handleError(e)}))},k.prototype.isCustomSource=function(e){var t=!1;return-1<["-trashcan-","-sharedlinks-","-sites-","-mysites-","-favorites-","-recent-"].indexOf(e)&&(t=!0),t},k.prototype.isSupportedSource=function(e){var t=!1;return-1<["-my-","-root-","-shared-"].indexOf(e)&&(t=!0),t},k.prototype.loadFolderByNodeId=function(e,t,n){return void 0===n&&(n=[]),"-trashcan-"===e?this.loadTrashcan(t,n):"-sharedlinks-"===e?this.loadSharedLinks(t,n):"-sites-"===e?this.loadSites(t):"-mysites-"===e?this.loadMemberSites(t):"-favorites-"===e?this.loadFavorites(t,n):"-recent-"===e?this.getRecentFiles("-me-",t):void 0},k.prototype.getCorrespondingNodeIds=function(t,e){var n=this;return void 0===e&&(e={}),this.isCustomSource(t)?this.loadFolderByNodeId(t,e).pipe(m.map(function(e){return e.list.entries.map(function(e){return n.getIdFromEntry(e,t)})})):t?u.from(this.apiService.nodesApi.getNode(t).then(function(e){return[e.entry.id]})):u.of([])},k.prototype.getIdFromEntry=function(e,t){return"-sharedlinks-"===t?e.entry.nodeId:"-sites-"===t||"-mysites-"===t?e.entry.guid:"-favorites-"===t?e.entry.targetGuid:e.entry.id},k.prototype.hasCorrespondingNodeIds=function(e){return this.isCustomSource(e)||this.isSupportedSource(e)},k.prototype.getIncludesFields=function(e){return N(["path","properties","allowableOperations","permissions","aspectNames"],e).filter(function(e,t,n){return t===n.indexOf(e)})},k.prototype.handleError=function(e){return this.logService.error(e),u.throwError(e||"Server error")},k.decorators=[{type:y.Injectable,args:[{providedIn:"root"}]}],k.ctorParameters=function(){return[{type:b.AlfrescoApiService},{type:b.LogService}]},k.ngInjectableDef=y.defineInjectable({factory:function(){return new k(y.inject(b.AlfrescoApiService),y.inject(b.LogService))},token:k,providedIn:"root"}),k);function k(e,t){this.apiService=e,this.logService=t,this.CREATE_PERMISSION="create"}var x=(P.prototype.deleteNode=function(e){return u.from(this.apiService.getInstance().nodes.deleteNode(e))},P.prototype.copyNode=function(e,t){var n=this;return u.from(this.apiService.getInstance().nodes.copyNode(e,{targetParentId:t})).pipe(m.catchError(function(e){return n.handleError(e)}))},P.prototype.moveNode=function(e,t){var n=this;return u.from(this.apiService.getInstance().nodes.moveNode(e,{targetParentId:t})).pipe(m.catchError(function(e){return n.handleError(e)}))},P.prototype.getFolder=function(e,t,n){var i=this;void 0===n&&(n=[]);var o=P.ROOT_ID;t&&t.rootFolderId&&(o=t.rootFolderId);var r={includeSource:!0,include:N(["path","properties","allowableOperations","permissions","aspectNames"],n).filter(function(e,t,n){return t===n.indexOf(e)})};return e&&(r.relativePath=e),t&&(t.maxItems&&(r.maxItems=t.maxItems),t.skipCount&&(r.skipCount=t.skipCount),t.where&&(r.where=t.where)),u.from(this.apiService.getInstance().nodes.getNodeChildren(o,r)).pipe(m.catchError(function(e){return i.handleError(e)}))},P.prototype.getNode=function(e,t){void 0===t&&(t=[]);var n={includeSource:!0,include:N(["path","properties","allowableOperations","permissions"],t).filter(function(e,t,n){return t===n.indexOf(e)})};return this.contentService.getNode(e,n)},P.prototype.getFolderNode=function(e,t){var n=this;void 0===t&&(t=[]);var i={includeSource:!0,include:N(["path","properties","allowableOperations","permissions","aspectNames"],t).filter(function(e,t,n){return t===n.indexOf(e)})};return u.from(this.apiService.getInstance().nodes.getNode(e,i)).pipe(m.catchError(function(e){return n.handleError(e)}))},P.prototype.isCustomSourceService=function(e){return this.customResourcesService.isCustomSource(e)},P.prototype.loadFolderByNodeId=function(e,t,n,i){return this.customResourcesService.isCustomSource(e)?this.customResourcesService.loadFolderByNodeId(e,t,n).pipe(m.map(function(e){return new F(null,e)})):this.retrieveDocumentNode(e,t,n,i)},P.prototype.retrieveDocumentNode=function(e,t,n,i){return u.forkJoin(this.getFolderNode(e,n),this.getFolder(null,{maxItems:t.maxItems,skipCount:t.skipCount,rootFolderId:e,where:i},n)).pipe(m.map(function(e){return new F(e[0],e[1])}))},P.prototype.handleError=function(e){return this.logService.error(e),u.throwError(e||"Server error")},P.ROOT_ID="-root-",P.decorators=[{type:y.Injectable,args:[{providedIn:"root"}]}],P.ctorParameters=function(){return[{type:b.ContentService},{type:b.AlfrescoApiService},{type:b.LogService},{type:R}]},P.ngInjectableDef=y.defineInjectable({factory:function(){return new P(y.inject(b.ContentService),y.inject(b.AlfrescoApiService),y.inject(b.LogService),y.inject(R))},token:P,providedIn:"root"}),P);function P(e,t,n,i){this.contentService=e,this.apiService=t,this.logService=n,this.customResourcesService=i}var M=(_.prototype.close=function(){this.data.select.complete()},_.prototype.onSelect=function(e){this.chosenNode=e},_.prototype.onClick=function(){this.data.select.next(this.chosenNode),this.data.select.complete()},_.decorators=[{type:y.Component,args:[{selector:"adf-content-node-selector",template:'<header\n    mat-dialog-title\n    data-automation-id="content-node-selector-title">{{data?.title}}\n</header>\n\n<mat-dialog-content>\n    <adf-content-node-selector-panel\n        [currentFolderId]="data?.currentFolderId"\n        [dropdownHideMyFiles]="data?.dropdownHideMyFiles"\n        [dropdownSiteList]="data?.dropdownSiteList"\n        [rowFilter]="data?.rowFilter"\n        [imageResolver]="data?.imageResolver"\n        [isSelectionValid]="data?.isSelectionValid"\n        [breadcrumbTransform]="data?.breadcrumbTransform"\n        [excludeSiteContent]="data?.excludeSiteContent"\n        [where]="data?.where"\n        (select)="onSelect($event)">\n    </adf-content-node-selector-panel>\n</mat-dialog-content>\n\n<mat-dialog-actions align="end">\n    <button\n        mat-button\n        (click)="close()"\n        data-automation-id="content-node-selector-actions-cancel">{{ \'NODE_SELECTOR.CANCEL\' | translate }}\n    </button>\n\n    <button mat-button\n        [disabled]="!chosenNode"\n        class="adf-choose-action"\n        (click)="onClick()"\n        data-automation-id="content-node-selector-actions-choose">{{ buttonActionName | translate }}\n    </button>\n</mat-dialog-actions>\n',encapsulation:y.ViewEncapsulation.None,styles:[""]}]}],_.ctorParameters=function(){return[{type:undefined,decorators:[{type:y.Inject,args:[d.MAT_DIALOG_DATA]}]}]},_);function _(e){this.data=e,this.buttonActionName=e.actionName?"NODE_SELECTOR."+e.actionName.toUpperCase():"NODE_SELECTOR.CHOOSE"}var U=(B.prototype.ngOnInit=function(){var e=this.data.node;this.nodeName=e.name,this.form=this.formBuilder.group({isLocked:e.isLocked||!1,allowOwner:"WRITE_LOCK"===e.properties["cm:lockType"],isTimeLock:!!e.properties["cm:expiryDate"],time:e.properties["cm:expiryDate"]?c(e.properties["cm:expiryDate"]):c()})},Object.defineProperty(B.prototype,"lockTimeInSeconds",{get:function(){return this.form.value.isTimeLock?c.duration(c(this.form.value.time).diff(c())).asSeconds():0},enumerable:!0,configurable:!0}),Object.defineProperty(B.prototype,"nodeBodyLock",{get:function(){return new f.NodeBodyLock({timeToExpire:this.lockTimeInSeconds,type:this.form.value.allowOwner?"ALLOW_OWNER_CHANGES":"FULL",lifetime:"PERSISTENT"})},enumerable:!0,configurable:!0}),B.prototype.toggleLock=function(){var e=this.alfrescoApi.nodesApi,t=this.data.node;return this.form.value.isLocked?e.lockNode(t.id,this.nodeBodyLock):e.unlockNode(t.id)},B.prototype.submit=function(){var t=this;this.toggleLock().then(function(e){t.data.node.isLocked=t.form.value.isLocked,t.dialog.close(e.entry)})["catch"](function(e){return t.data.onError(e)})},B.decorators=[{type:y.Component,args:[{selector:"adf-node-lock",template:'<h2 mat-dialog-title>\n    {{ \'CORE.FILE_DIALOG.FILE_LOCK\' | translate }}\n</h2>\n\n<mat-dialog-content>\n    <br />\n    <form [formGroup]="form" (submit)="submit()">\n        <mat-checkbox  data-automation-id="adf-lock-node-checkbox" class="adf-lock-file-name" [formControl]="form.controls[\'isLocked\']" ngDefaultControl>\n            {{ \'CORE.FILE_DIALOG.FILE_LOCK_CHECKBOX\' | translate }} <strong>"{{ nodeName }}"</strong>\n        </mat-checkbox>\n\n        <br />\n\n        <div *ngIf="form.value.isLocked">\n            <mat-checkbox class="adf-lock-file-name" [formControl]="form.controls[\'allowOwner\']" ngDefaultControl>\n                {{ \'CORE.FILE_DIALOG.ALLOW_OTHERS_CHECKBOX\' | translate }}\n            </mat-checkbox>\n\n            <br />\n\n            <mat-checkbox class="adf-lock-file-name" [formControl]="form.controls[\'isTimeLock\']" ngDefaultControl>\n                {{ \'CORE.FILE_DIALOG.TIME_LOCK_CHECKBOX\' | translate }}\n            </mat-checkbox>\n\n            <br />\n\n            <mat-form-field *ngIf="form.value.isTimeLock">\n                <mat-datetimepicker-toggle [for]="datetimePicker" matSuffix></mat-datetimepicker-toggle>\n                <mat-datetimepicker #datetimePicker type="datetime" openOnFocus="true" timeInterval="1"></mat-datetimepicker>\n                <input matInput [formControl]="form.controls[\'time\']" [matDatetimepicker]="datetimePicker" required autocomplete="false">\n            </mat-form-field>\n        </div>\n    </form>\n    <br />\n</mat-dialog-content>\n\n<mat-dialog-actions class="adf-dialog-buttons">\n    <span class="adf-fill-remaining-space"></span>\n\n    <button mat-button mat-dialog-close data-automation-id="lock-dialog-btn-cancel">\n        {{ \'CORE.FILE_DIALOG.CANCEL_BUTTON.LABEL\' | translate }}\n    </button>\n\n    <button class="adf-dialog-action-button" mat-button (click)="submit()">\n        {{ \'CORE.FILE_DIALOG.SAVE_BUTTON.LABEL\' | translate }}\n    </button>\n</mat-dialog-actions>\n',styles:[".adf-fill-remaining-space{flex:1 1 auto}.adf-full-width,.adf-lock-file-name .mat-checkbox-layout{width:100%}.adf-lock-file-name .mat-checkbox-label{text-overflow:ellipsis;overflow:hidden}.adf-lock-file-name .mat-checkbox-inner-container{margin:auto 8px auto 0}"]}]}],B.ctorParameters=function(){return[{type:v.FormBuilder},{type:d.MatDialogRef},{type:b.AlfrescoApiService},{type:undefined,decorators:[{type:y.Optional},{type:y.Inject,args:[d.MAT_DIALOG_DATA]}]}]},B);function B(e,t,n,i){this.formBuilder=e,this.dialog=t,this.alfrescoApi=n,this.data=i,this.node=null}var V=(j.prototype.openFileBrowseDialogByFolderId=function(e){var t=this;return this.documentListService.getFolderNode(e).pipe(m.switchMap(function(e){return t.openUploadFileDialog("Choose",e.entry)}))},j.prototype.openLockNodeDialog=function(e){var t=this,n=new u.Subject;return this.contentService.hasAllowableOperations(e,b.AllowableOperationsEnum.LOCK)?this.dialog.open(U,{data:{node:e,onError:function(e){t.error.emit(e),n.error(e)}},width:"400px"}):n.error("OPERATION.FAIL.NODE.NO_PERMISSION"),n},j.prototype.openFileBrowseDialogBySite=function(){var t=this;return this.siteService.getSites().pipe(m.switchMap(function(e){return t.openFileBrowseDialogByFolderId(e.list.entries[0].entry.guid)}))},j.prototype.openFolderBrowseDialogBySite=function(){return this.openFolderBrowseDialogByFolderId("-my-")},j.prototype.openFolderBrowseDialogByFolderId=function(e){var t=this;return this.documentListService.getFolderNode(e).pipe(m.switchMap(function(e){return t.openUploadFolderDialog("Choose",e.entry)}))},j.prototype.openCopyMoveDialog=function(e,t,n,i){if(this.contentService.hasAllowableOperations(t,n)){var o=new u.Subject;o.subscribe({complete:this.close.bind(this)});var r={title:this.getTitleTranslation(e,t.name),actionName:e,currentFolderId:t.parentId,imageResolver:this.imageResolver.bind(this),where:"(isFolder=true)",isSelectionValid:this.isCopyMoveSelectionValid.bind(this),excludeSiteContent:i||j.nonDocumentSiteContent,select:o};return this.openContentNodeDialog(r,"adf-content-node-selector-dialog","630px"),o}var a=new Error(JSON.stringify({error:{statusCode:403}}));return u.throwError(a)},j.prototype.getTitleTranslation=function(e,t){return this.translation.instant("NODE_SELECTOR."+e.toUpperCase()+"_ITEM",{name:t})},j.prototype.openUploadFolderDialog=function(e,t){var n=new u.Subject;n.subscribe({complete:this.close.bind(this)});var i={title:e+" '"+t.name+"' to ...",actionName:e,currentFolderId:t.id,imageResolver:this.imageResolver.bind(this),isSelectionValid:this.hasAllowableOperationsOnNodeFolder.bind(this),where:"(isFolder=true)",select:n};return this.openContentNodeDialog(i,"adf-content-node-selector-dialog","630px"),n},j.prototype.openUploadFileDialog=function(e,t){var n=new u.Subject;n.subscribe({complete:this.close.bind(this)});var i={title:e+" '"+t.name+"' to ...",actionName:e,currentFolderId:t.id,imageResolver:this.imageResolver.bind(this),isSelectionValid:this.isNodeFile.bind(this),select:n};return this.openContentNodeDialog(i,"adf-content-node-selector-dialog","630px"),n},j.prototype.openContentNodeDialog=function(e,t,n){this.dialog.open(M,{data:e,panelClass:t,width:n})},j.prototype.imageResolver=function(e,t){var n=e.node.entry;return this.contentService.hasAllowableOperations(n,"create")?null:this.thumbnailService.getMimeTypeIcon("disable/folder")},j.prototype.isNodeFile=function(e){return e.isFile},j.prototype.hasAllowableOperationsOnNodeFolder=function(e){return this.isNodeFolder(e)&&this.contentService.hasAllowableOperations(e,"create")},j.prototype.isNodeFolder=function(e){return e.isFolder},j.prototype.isCopyMoveSelectionValid=function(e){return this.hasEntityCreatePermission(e)&&!this.isSite(e)},j.prototype.hasEntityCreatePermission=function(e){return this.contentService.hasAllowableOperations(e,"create")},j.prototype.isSite=function(e){return!!e.guid||"st:site"===e.nodeType||"st:sites"===e.nodeType},j.prototype.close=function(){this.dialog.closeAll()},j.nonDocumentSiteContent=["blog","calendar","dataLists","discussions","links","wiki"],j.decorators=[{type:y.Injectable,args:[{providedIn:"root"}]}],j.ctorParameters=function(){return[{type:d.MatDialog},{type:b.ContentService},{type:x},{type:b.SitesService},{type:b.TranslationService},{type:b.ThumbnailService}]},j.propDecorators={error:[{type:y.Output}]},j.ngInjectableDef=y.defineInjectable({factory:function(){return new j(y.inject(l.MatDialog),y.inject(b.ContentService),y.inject(x),y.inject(b.SitesService),y.inject(b.TranslationService),y.inject(b.ThumbnailService))},token:j,providedIn:"root"}),j);function j(e,t,n,i,o,r){this.dialog=e,this.contentService=t,this.documentListService=n,this.siteService=i,this.translation=o,this.thumbnailService=r,this.error=new y.EventEmitter}var $=(H.prototype.onClick=function(e){e.preventDefault(),this.contentNodeDialogService.openLockNodeDialog(this.node)},H.prototype.ngAfterViewInit=function(){var e=this.contentService.hasAllowableOperations(this.node,b.AllowableOperationsEnum.LOCK);this.renderer.setProperty(this.element.nativeElement,"disabled",!e)},H.decorators=[{type:y.Directive,args:[{selector:"[adf-node-lock]"}]}],H.ctorParameters=function(){return[{type:y.ElementRef},{type:y.Renderer2},{type:b.ContentService},{type:V}]},H.propDecorators={node:[{type:y.Input,args:["adf-node-lock"]}],onClick:[{type:y.HostListener,args:["click",["$event"]]}]},H);function H(e,t,n,i){this.element=e,this.renderer=t,this.contentService=n,this.contentNodeDialogService=i}var G=(q.decorators=[{type:y.NgModule,args:[{imports:[g.CommonModule,I],declarations:[$],exports:[$]}]}],q);function q(){}var Y=(z.prototype.getRating=function(e,t){return u.from(this.apiService.getInstance().core.ratingsApi.getRating(e,t)).pipe(m.catchError(this.handleError))},z.prototype.postRating=function(e,t,n){var i=new f.RatingBody({id:t,myRating:n});return u.from(this.apiService.getInstance().core.ratingsApi.rate(e,i)).pipe(m.catchError(this.handleError))},z.prototype.deleteRating=function(e,t){return u.from(this.apiService.getInstance().core.ratingsApi.removeRating(e,t)).pipe(m.catchError(this.handleError))},z.prototype.handleError=function(e){return console.error(e),u.throwError(e||"Server error")},z.decorators=[{type:y.Injectable,args:[{providedIn:"root"}]}],z.ctorParameters=function(){return[{type:b.AlfrescoApiService}]},z.ngInjectableDef=y.defineInjectable({factory:function(){return new z(y.inject(b.AlfrescoApiService))},token:z,providedIn:"root"}),z);function z(e){this.apiService=e}var Q=(W.prototype.ngOnChanges=function(){var t=this;this.ratingService.getRating(this.nodeId,this.ratingType).pipe(m.takeUntil(this.onDestroy$)).subscribe(function(e){t.refreshRating(e)})},W.prototype.ngOnDestroy=function(){this.onDestroy$.next(!0),this.onDestroy$.complete()},W.prototype.calculateStars=function(){this.stars=[];for(var e=Math.round(this.average),t=0;t<5;t++)t<e?this.stars.push({fill:!0}):this.stars.push({fill:!1})},W.prototype.updateVote=function(e){this.ratingValue===e?this.unRateItem():this.rateItem(e)},W.prototype.rateItem=function(e){var t=this;this.ratingService.postRating(this.nodeId,this.ratingType,e).pipe(m.takeUntil(this.onDestroy$)).subscribe(function(e){t.refreshRating(e)})},W.prototype.unRateItem=function(){var t=this;this.ratingService.deleteRating(this.nodeId,this.ratingType).subscribe(function(){t.ratingService.getRating(t.nodeId,t.ratingType).pipe(m.takeUntil(t.onDestroy$)).subscribe(function(e){t.refreshRating(e)})})},W.prototype.refreshRating=function(e){this.ratingValue=Number.parseFloat(e.entry.myRating),this.average=e.entry.aggregate.average,this.ratingsCounter=e.entry.aggregate.numberOfRatings,this.calculateStars(),this.changeVote.emit(this.average)},W.decorators=[{type:y.Component,args:[{selector:"adf-rating",template:'<mat-list id="adf-rating-container" class="adf-rating-container">\n    <mat-list-item class="adf-rating-star" *ngFor="let currentRate of stars; let idx = index;">\n            <span id="adf-rate-{{idx}}">\n                <mat-icon id="adf-colored-star-{{idx}}" *ngIf="currentRate.fill" class="adf-colored-star"\n                          [ngClass]="{\'adf-average-star\': !ratingValue}"\n                          (click)="updateVote(idx + 1)">star_rate\n                </mat-icon>\n                <mat-icon id="adf-grey-star-{{idx}}" *ngIf="!currentRate.fill" class="adf-grey-star"\n                          (click)="updateVote(idx + 1)">star_border\n                </mat-icon>\n            </span>\n    </mat-list-item>\n    <div class="adf-rating-counter-container">\n    <div id="adf-rating-counter" class="adf-rating-counter">{{ratingsCounter}}</div>\n    <div class="adf-rating-left" *ngIf="ratingsCounter<=1">Rating</div>\n    <div class="adf-rating-left" *ngIf="ratingsCounter>1">Ratings</div>\n    </div>\n</mat-list>\n',encapsulation:y.ViewEncapsulation.None,styles:[".adf-rating-container{display:flex;overflow:hidden;width:100%}.adf-rating-container .adf-rating-counter-container{display:flex;align-items:center;padding:0 6px}.adf-rating-container .adf-rating-left{padding:0 6px}.adf-rating-container .adf-rating-star{display:flex;justify-content:center;transition:.3s;cursor:pointer;width:25px}.adf-rating-container .adf-rating-star .mat-list-item-content{padding:0!important}.adf-rating-container .adf-rating-star:hover{transform:rotate(13deg) scale(1.2)}.adf-rating-container .adf-colored-star{color:#ffe944}.adf-rating-container .adf-average-star,.adf-rating-container .adf-grey-star{color:grey!important}[dir=rtl] .adf-rating-container .adf-rating-star{transform:rotate(145deg)}[dir=rtl] .adf-rating-container .adf-rating-star:hover{transform:rotate(158deg) scale(1.2)}"]}]}],W.ctorParameters=function(){return[{type:Y}]},W.propDecorators={nodeId:[{type:y.Input}],changeVote:[{type:y.Output}]},W);function W(e){this.ratingService=e,this.average=0,this.ratingsCounter=0,this.ratingType="fiveStar",this.changeVote=new y.EventEmitter,this.stars=[],this.onDestroy$=new u.Subject}var X=(Z.prototype.ngOnChanges=function(){var t=this;this.clean(),this.ratingService.getRating(this.nodeId,this.ratingType).subscribe(function(e){e.entry.aggregate&&(t.likesCounter=e.entry.aggregate.numberOfRatings,e.entry.ratedAt&&(t.isLike=!0))})},Z.prototype.likeClick=function(){var t=this;this.isLike?this.ratingService.deleteRating(this.nodeId,this.ratingType).subscribe(function(){t.likesCounter-=1,t.isLike=!1,t.changeVote.emit(t.likesCounter)}):this.ratingService.postRating(this.nodeId,this.ratingType,!0).subscribe(function(e){t.likesCounter=e.entry.aggregate.numberOfRatings,t.isLike=!0,t.changeVote.emit(t.likesCounter)})},Z.prototype.clean=function(){this.isLike=!1,this.likesCounter=0},Z.decorators=[{type:y.Component,args:[{selector:"adf-like",template:'<div id="adf-like-container" class="adf-like-container">\n    <div class="adf-like">\n        <span id="adf-like-{{nodeId}}" [ngClass]="{\'adf-like-select\': isLike ,\'adf-like-grey\': !isLike  }"\n              (click)="likeClick()">\n            <mat-icon>thumb_up</mat-icon>\n        </span>\n    </div>\n    <div class="adf-like-counter-container">\n        <div id="adf-like-counter" class="adf-like-counter">{{likesCounter}}</div>\n        <div class="adf-left" *ngIf="likesCounter<=1">Like</div>\n        <div class="adf-left" *ngIf="likesCounter>1">Likes</div>\n    </div>\n</div>\n',encapsulation:y.ViewEncapsulation.None,styles:[".adf-like-container{display:flex;overflow:hidden;width:100%;align-items:center;margin-top:13px}.adf-like-container .adf-like-counter-container{display:inherit;padding:0 6px}.adf-like-container .adf-left{padding:0 6px}.adf-like-container .adf-like-select{cursor:pointer;color:#2196f3}.adf-like-container .adf-like-select:hover{color:grey}.adf-like-container .adf-like-grey{cursor:pointer;color:grey}.adf-like-container .adf-like-grey:hover{color:#2196f3}"]}]}],Z.ctorParameters=function(){return[{type:Y}]},Z.propDecorators={nodeId:[{type:y.Input}],changeVote:[{type:y.Output}]},Z);function Z(e){this.ratingService=e,this.changeVote=new y.EventEmitter,this.likesCounter=0,this.ratingType="likes",this.isLike=!1}var K=(J.decorators=[{type:y.NgModule,args:[{imports:[g.CommonModule,I],exports:[Q,X],declarations:[Q,X]}]}],J);function J(){}var ee=(te.prototype.getTagsByNodeId=function(e){var t=this;return u.from(this.apiService.getInstance().core.tagsApi.getNodeTags(e)).pipe(m.catchError(function(e){return t.handleError(e)}))},te.prototype.getAllTheTags=function(e){var t=this;return u.from(this.apiService.getInstance().core.tagsApi.getTags(e)).pipe(m.catchError(function(e){return t.handleError(e)}))},te.prototype.addTag=function(e,t){var n=this,i=new f.TagBody;i.tag=t;var o=u.from(this.apiService.getInstance().core.tagsApi.addTag(e,i));return o.subscribe(function(e){n.refresh.emit(e)},function(e){n.handleError(e)}),o},te.prototype.removeTag=function(e,t){var n=this,i=u.from(this.apiService.getInstance().core.tagsApi.removeTag(e,t));return i.subscribe(function(e){n.refresh.emit(e)},function(e){n.handleError(e)}),i},te.prototype.handleError=function(e){return this.logService.error(e),u.throwError(e||"Server error")},te.decorators=[{type:y.Injectable,args:[{providedIn:"root"}]}],te.ctorParameters=function(){return[{type:b.AlfrescoApiService},{type:b.LogService}]},te.propDecorators={refresh:[{type:y.Output}]},te.ngInjectableDef=y.defineInjectable({factory:function(){return new te(y.inject(b.AlfrescoApiService),y.inject(b.LogService))},token:te,providedIn:"root"}),te);function te(e,t){this.apiService=e,this.logService=t,this.refresh=new y.EventEmitter}var ne=(ie.prototype.ngOnInit=function(){var e=this;this.tagService.refresh.pipe(m.takeUntil(this.onDestroy$)).subscribe(function(){return e.refreshTag()})},ie.prototype.ngOnChanges=function(){return this.refreshTag()},ie.prototype.ngOnDestroy=function(){this.onDestroy$.next(!0),this.onDestroy$.complete()},ie.prototype.refreshTag=function(){var t=this;this.nodeId&&this.tagService.getTagsByNodeId(this.nodeId).subscribe(function(e){t.tagsEntries=e.list.entries,t.disableAddTag=!1,t.result.emit(t.tagsEntries)},function(){t.tagsEntries=null,t.disableAddTag=!0,t.result.emit(t.tagsEntries)})},ie.prototype.addTag=function(){var e=this;this.searchTag(this.newTagName)?(this.errorMsg=this.translateService.instant("TAG.MESSAGES.EXIST"),this.error.emit(this.errorMsg)):this.tagService.addTag(this.nodeId,this.newTagName).subscribe(function(){e.newTagName="",e.successAdd.emit(e.nodeId)})},ie.prototype.searchTag=function(t){if(this.tagsEntries)return this.tagsEntries.find(function(e){return t===e.entry.tag})},ie.prototype.cleanErrorMsg=function(){this.errorMsg=""},ie.prototype.removeTag=function(e){this.tagService.removeTag(this.nodeId,e)},ie.decorators=[{type:y.Component,args:[{selector:"adf-tag-node-actions-list",template:'<mat-list>\n    <mat-list-item *ngFor="let currentEntry of tagsEntries; let idx = index">\n        <div class="adf-tag-actions-container" id="tag_delete_{{currentEntry.entry.tag}}" (click)="removeTag(currentEntry.entry.id)">\n            <div class="adf-tag-actions-delete-text" id="tag_name_{{currentEntry.entry.tag}}">\n                {{currentEntry.entry.tag}}\n            </div>\n            <mat-icon class="adf-tag-actions-delete-icon">delete</mat-icon>\n        </div>\n    </mat-list-item>\n</mat-list>\n<table class="adf-full-width" cellspacing="0">\n    <tr>\n        <td>\n            <mat-form-field class="adf-full-width">\n                <input matInput placeholder="{{\'TAG.LABEL.NEWTAG\' | translate }}"\n                       type="text"\n                       (keypress)="cleanErrorMsg()"\n                       [(ngModel)]="newTagName"\n                       id="new-tag-text"/>\n                <mat-hint data-automation-id="errorMessage" *ngIf="error" [ngStyle]="{\'color\': \'red\'}" align="start">{{errorMsg}}</mat-hint>\n            </mat-form-field>\n        </td>\n        <td>\n            <button class="adf-full-width" color="primary" id="add-tag" (click)="addTag()" [disabled]="disableAddTag"\n                    mat-raised-button>\n                {{\'TAG.BUTTON.ADD\' | translate }}\n            </button>\n        </td>\n    </tr>\n</table>\n',encapsulation:y.ViewEncapsulation.None,styles:[".adf-full-width{width:100%}.adf-tag-actions-delete-icon{float:right;cursor:pointer}.adf-tag-actions-delete-text{font-size:16px;float:left}.adf-tag-actions-container{padding:8px 0;height:20px}"]}]}],ie.ctorParameters=function(){return[{type:ee},{type:b.TranslationService}]},ie.propDecorators={nodeId:[{type:y.Input}],successAdd:[{type:y.Output}],error:[{type:y.Output}],result:[{type:y.Output}]},ie);function ie(e,t){this.tagService=e,this.translateService=t,this.successAdd=new y.EventEmitter,this.error=new y.EventEmitter,this.result=new y.EventEmitter,this.disableAddTag=!0,this.onDestroy$=new u.Subject}var oe=(re.prototype.ngOnInit=function(){this.refreshTag(this.defaultPagination)},re.prototype.ngOnDestroy=function(){this.onDestroy$.next(!0),this.onDestroy$.complete()},re.prototype.refreshTag=function(e){var t=this;this.tagService.getAllTheTags(e).subscribe(function(e){t.tagsEntries=t.tagsEntries.concat(e.list.entries),t.pagination=e.list.pagination,t.result.emit(t.tagsEntries),t.isLoading=!1})},re.prototype.loadMoreTags=function(){this.pagination.hasMoreItems&&(this.isLoading=!0,this.isSizeMinimum=!1,this.refreshTag({skipCount:this.pagination.skipCount+this.pagination.count,maxItems:this.size}))},re.prototype.loadLessTags=function(){this.isSizeMinimum=!1,this.tagsEntries=this.tagsEntries.slice(0,this.tagsEntries.length-this.pagination.count),this.pagination.skipCount=this.pagination.skipCount-this.pagination.count,this.pagination.hasMoreItems=!0,this.tagsEntries.length<=this.size&&(this.isSizeMinimum=!0)},re.decorators=[{type:y.Component,args:[{selector:"adf-tag-list",template:'<mat-chip-list class="adf-tag-chips-list">\n    <div class="adf-list-tag" *ngFor="let currentEntry of tagsEntries; let idx = index">\n        <mat-chip class="adf-primary-background-color">\n            <span id="tag_name_{{idx}}">{{currentEntry.entry.tag}}</span>\n        </mat-chip>\n    </div>\n</mat-chip-list>\n\n<div class="adf-tag-list-controls">\n    <button\n        *ngIf="!isSizeMinimum"\n        [disabled]="isLoading"\n        data-automation-id="show-fewer-tags"\n        mat-icon-button\n        (click)="loadLessTags()">\n        <mat-icon>keyboard_arrow_up</mat-icon>\n    </button>\n    <button\n        *ngIf="pagination.hasMoreItems"\n        [disabled]="isLoading"\n        data-automation-id="show-more-tags"\n        mat-icon-button\n        (click)="loadMoreTags()">\n        <mat-icon>keyboard_arrow_down</mat-icon>\n    </button>\n</div>\n',encapsulation:y.ViewEncapsulation.None,styles:[".adf-tag-chips-list,.adf-tag-chips-list div{display:flex;flex-direction:column}.adf-list-tag{display:block;font-size:16px}.adf-tag-list-controls{margin-top:30px;display:flex;justify-content:center}"]}]}],re.ctorParameters=function(){return[{type:ee}]},re.propDecorators={result:[{type:y.Output}]},re);function re(e){var t=this;this.tagService=e,this.result=new y.EventEmitter,this.tagsEntries=[],this.size=10,this.isLoading=!1,this.isSizeMinimum=!0,this.onDestroy$=new u.Subject,this.defaultPagination={skipCount:0,maxItems:this.size,hasMoreItems:!1},this.pagination=this.defaultPagination,this.tagService.refresh.pipe(m.takeUntil(this.onDestroy$)).subscribe(function(){t.tagsEntries=[],t.refreshTag(t.defaultPagination)})}var ae=(se.prototype.ngOnChanges=function(){this.refreshTag()},se.prototype.ngOnInit=function(){var e=this;this.tagService.refresh.pipe(m.takeUntil(this.onDestroy$)).subscribe(function(){return e.refreshTag()})},se.prototype.ngOnDestroy=function(){this.onDestroy$.next(!0),this.onDestroy$.complete()},se.prototype.refreshTag=function(){var t=this;this.nodeId&&this.tagService.getTagsByNodeId(this.nodeId).subscribe(function(e){t.tagsEntries=e.list.entries,t.results.emit(t.tagsEntries)})},se.prototype.removeTag=function(e){var t=this;this.tagService.removeTag(this.nodeId,e).subscribe(function(){t.refreshTag()})},se.decorators=[{type:y.Component,args:[{selector:"adf-tag-node-list",template:'<mat-chip-list>\n    <mat-chip class="adf-tag-chips adf-primary-background-color"\n              *ngFor="let currentEntry of tagsEntries; let idx = index" (removed)="removeTag(currentEntry.entry.id)">\n        <span id="tag_name_{{idx}}">{{currentEntry.entry.tag}}</span>\n        <mat-icon *ngIf="showDelete" id="tag_chips_delete_{{currentEntry.entry.tag}}"\n                  class="adf-tag-chips-delete-icon adf-primary-contrast-text-color" matChipRemove>cancel\n        </mat-icon>\n    </mat-chip>\n</mat-chip-list>\n',encapsulation:y.ViewEncapsulation.None,styles:[".adf-tag-chips-delete{overflow:visible;cursor:pointer;height:17px;width:20px;float:right;border:0;background:0 0;padding:0;margin:-1px 0 0 10px}.adf-tag-chips-delete-icon{font-size:20px;background-repeat:no-repeat;display:inline-block;fill:currentColor;height:20px;width:20px}"]}]}],se.ctorParameters=function(){return[{type:ee}]},se.propDecorators={nodeId:[{type:y.Input}],showDelete:[{type:y.Input}],results:[{type:y.Output}]},se);function se(e){this.tagService=e,this.showDelete=!0,this.results=new y.EventEmitter,this.onDestroy$=new u.Subject}var le=(ce.decorators=[{type:y.NgModule,args:[{imports:[g.CommonModule,I,v.FormsModule,v.ReactiveFormsModule,b.CoreModule.forChild()],exports:[ne,oe,ae],declarations:[ne,oe,ae]}]}],ce);function ce(){}var de=(pe.prototype.ngOnChanges=function(e){var i=this;return this.showData&&this.clean(),new Promise(function(t,n){i.apiService.getInstance().webScript.executeWebScript("GET",i.scriptPath,i.scriptArgs,i.contextRoot,i.servicePath).then(function(e){i.data=e,i.showData&&"DATATABLE"===i.contentType&&(i.data=i.showDataAsDataTable(e)),i.success.emit(i.data),t()},function(e){i.logService.log("Error"+e),n()})})},pe.prototype.showDataAsDataTable=function(e){try{e.schema||(e.schema=b.ObjectDataTableAdapter.generateSchema(e.data)),e.schema&&0<e.schema.length&&(this.data=new b.ObjectDataTableAdapter(e.data,e.schema))}catch(t){this.logService.error("error during the cast as datatable")}return null},pe.prototype.clean=function(){this.data=undefined},pe.prototype.isDataTableContent=function(){return"DATATABLE"===this.contentType},pe.decorators=[{type:y.Component,args:[{selector:"adf-webscript-get",template:'<div *ngIf="showData">\n    <div *ngIf="contentType === \'JSON\'" id="webscript-data-JSON">{{data | json}}</div>\n    <div *ngIf="contentType === \'HTML\'" id="webscript-data-HTML" [innerHTML]="data"></div>\n    <div *ngIf="contentType === \'TEXT\'" id="webscript-data-TEXT">{{data}}</div>\n    <div *ngIf="isDataTableContent()">\n        <adf-datatable id="webscript-datatable-wrapper" [data]="data"></adf-datatable>\n        <div>\n            <div *ngIf="showError" id="error">{{\'WEBSCRIPT.ERROR\' | translate: {\n                data: data,\n                contentType: contentType\n                }\n                }}\n            </div>\n        </div>\n    </div>\n</div>\n'}]}],pe.ctorParameters=function(){return[{type:b.AlfrescoApiService},{type:b.LogService}]},pe.propDecorators={scriptPath:[{type:y.Input}],scriptArgs:[{type:y.Input}],showData:[{type:y.Input}],contextRoot:[{type:y.Input}],servicePath:[{type:y.Input}],contentType:[{type:y.Input}],success:[{type:y.Output}]},pe);function pe(e,t){this.apiService=e,this.logService=t,this.showData=!0,this.contextRoot="alfresco",this.servicePath="service",this.contentType="TEXT",this.success=new y.EventEmitter,this.data=undefined,this.showError=!1}var ue=(he.decorators=[{type:y.NgModule,args:[{imports:[g.CommonModule,I,b.CoreModule.forChild()],exports:[de],declarations:[de]}]}],he);function he(){}var fe=(Object.defineProperty(me.prototype,"node",{get:function(){return this.obj},set:function(e){this.obj=e,this.cache={}},enumerable:!0,configurable:!0}),me.prototype.getPermissionClass=function(t){var n=this,i="";return this.permissionsStyle.forEach(function(e){(n.applyPermissionStyleToFolder(t.entry,e)||n.applyPermissionStyleToFile(t.entry,e))&&n.contentService.hasAllowableOperations(t.entry,e.permission)&&(i+=" "+e.css)}),i},me.prototype.applyPermissionStyleToFile=function(e,t){return t.isFile&&e.isFile},me.prototype.applyPermissionStyleToFolder=function(e,t){return t.isFolder&&e.isFolder},me.prototype.isFolderAndHasPermissionToUpload=function(e){return this.isFolder(e)&&this.contentService.hasAllowableOperations(e.entry,"create")},me.prototype.isFolder=function(e){return e.entry&&e.entry.isFolder},me.prototype.cacheValue=function(e,t){return this.cache[e]=t},me.prototype.getValue=function(e){return this.cache[e]!==undefined?this.cache[e]:b.ObjectUtils.getValue(this.obj.entry,e)},me.prototype.imageErrorResolver=function(e){if(this.obj.entry.content)return this.thumbnailService.getMimeTypeIcon(this.obj.entry.content.mimeType)},me.prototype.hasValue=function(e){return this.getValue(e)!==undefined},me.ERR_OBJECT_NOT_FOUND="Object source not found",me);function me(e,t,n,i){if(this.obj=e,this.contentService=t,this.permissionsStyle=n,this.thumbnailService=i,this.cache={},this.isSelected=!1,this.cssClass="",!e)throw new Error(me.ERR_OBJECT_NOT_FOUND);this.isDropTarget=this.isFolderAndHasPermissionToUpload(e),n&&(this.cssClass=this.getPermissionClass(e))}var ge=(Object.defineProperty(ye.prototype,"sortingMode",{get:function(){return this._sortingMode},set:function(e){var t=(e||"client").toLowerCase();"client"!==t&&"server"!==t&&(t="client"),this._sortingMode=t},enumerable:!0,configurable:!0}),ye.prototype.getRows=function(){return this.rows},ye.prototype.setRows=function(e){this.rows=e||[],this.sort()},ye.prototype.getColumns=function(){return this.columns},ye.prototype.setColumns=function(e){this.columns=e||[]},ye.prototype.getValue=function(e,t){if(!e)throw new Error(this.ERR_ROW_NOT_FOUND);if(!t)throw new Error(this.ERR_COL_NOT_FOUND);var n,i=e,o=e.getValue(t.key);if(i.cache[t.key]!==undefined)return i.cache[t.key];if("$thumbnail"!==t.key)return"image"===t.type&&this.imageResolver&&(n=this.imageResolver(e,t))?n:i.cacheValue(t.key,o);if(this.imageResolver&&(n=this.imageResolver(e,t)))return n;var r=e.node;if(r.entry.isFolder)return this.getFolderIcon(r);if(r.entry.isFile&&this.thumbnails)return this.thumbnailService.getDocumentThumbnailUrl(r);if(r.entry.content){var a=r.entry.content.mimeType;if(a)return this.thumbnailService.getMimeTypeIcon(a)}return this.thumbnailService.getDefaultMimeTypeIcon()},ye.prototype.getSorting=function(){return this.sorting},ye.prototype.setSorting=function(e){this.sorting=e,this.sortRows(this.rows,this.sorting)},ye.prototype.sort=function(e,t){var n=this.sorting||new b.DataSorting;e&&(n.key=e,n.direction=t||"asc"),this.setSorting(n)},ye.prototype.setFilter=function(e){this.filter=e},ye.prototype.setImageResolver=function(e){this.imageResolver=e},ye.prototype.getFolderIcon=function(e){return this.isSmartFolder(e)?this.thumbnailService.getMimeTypeIcon("smartFolder"):this.isRuleFolder(e)?this.thumbnailService.getMimeTypeIcon("ruleFolder"):this.isALinkFolder(e)?this.thumbnailService.getMimeTypeIcon("linkFolder"):this.thumbnailService.getMimeTypeIcon("folder")},ye.prototype.isSmartFolder=function(e){var t=this.getNodeAspectNames(e);return-1<t.indexOf("smf:customConfigSmartFolder")||-1<t.indexOf("smf:systemConfigSmartFolder")},ye.prototype.isRuleFolder=function(e){var t=this.getNodeAspectNames(e);return-1<t.indexOf("rule:rules")||-1<t.indexOf("rule:rules")},ye.prototype.isALinkFolder=function(e){return"app:folderlink"===(e.entry?e.entry.nodeType:e.nodeType)},ye.prototype.getNodeAspectNames=function(e){return e.entry&&e.entry.aspectNames?e.entry.aspectNames:e.aspectNames?e.aspectNames:[]},ye.prototype.sortRows=function(e,o){if("server"!==this.sortingMode){var r={};o&&o.key&&e&&0<e.length&&(!o.key.includes("sizeInBytes")&&"name"!==o.key||(r.numeric=!0),e.sort(function(e,t){if(e.node.entry.isFolder!==t.node.entry.isFolder)return e.node.entry.isFolder?-1:1;var n=e.getValue(o.key);n=n?n instanceof Date?n.valueOf().toString():n.toString():"";var i=t.getValue(o.key);return i=i?i instanceof Date?i.valueOf().toString():i.toString():"","asc"===o.direction?n.localeCompare(i,undefined,r):i.localeCompare(n,undefined,r)}))}},ye.prototype.loadPage=function(e,t){var n=this;void 0===t&&(t=!1);var i=[];if(e&&e.list){var o=e.list.entries;if(o&&0<o.length&&(i=o.map(function(e){return new fe(e,n.contentService,n.permissionsStyle,n.thumbnailService)}),this.filter&&(i=i.filter(this.filter)),"server"!==this.sortingMode&&this.columns&&0<this.columns.length)){var r=this.getSorting();if(r)this.sortRows(i,r);else{var a=this.columns.filter(function(e){return e.sortable});0<a.length?this.sort(a[0].key,"asc"):this.sort(this.columns[0].key,"asc")}}}if(t){var s=i.filter(function(t){return!n.rows.find(function(e){return e.obj.entry.id===t.obj.entry.id})});this.rows=this.rows.concat(s)}else this.rows=i},ye);
/*!
     * @license
     * Copyright 2019 Alfresco Software, Ltd.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *     http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function ye(e,t,n,i,o){void 0===n&&(n=[]),void 0===o&&(o="client"),this.thumbnailService=e,this.contentService=t,this.ERR_ROW_NOT_FOUND="Row not found",this.ERR_COL_NOT_FOUND="Column not found",this.thumbnails=!1,this.rows=[],this.columns=n||[],this.sorting=i,this.sortingMode=o}var ve,be={"-trashcan-":[{key:"$thumbnail",type:"image",srTitle:"ADF-DOCUMENT-LIST.LAYOUT.THUMBNAIL",sortable:!1},{key:"name",type:"text",title:"ADF-DOCUMENT-LIST.LAYOUT.NAME",cssClass:"full-width ellipsis-cell",sortable:!0},{key:"path",type:"location",title:"ADF-DOCUMENT-LIST.LAYOUT.LOCATION",sortable:!0},{key:"content.sizeInBytes",type:"fileSize",title:"ADF-DOCUMENT-LIST.LAYOUT.SIZE",sortable:!0},{key:"archivedAt",type:"date",title:"ADF-DOCUMENT-LIST.LAYOUT.DELETED_ON",format:"timeAgo",sortable:!0},{key:"archivedByUser.displayName",type:"text",title:"ADF-DOCUMENT-LIST.LAYOUT.DELETED_BY",sortable:!0}],"-sites-":[{key:"$thumbnail",type:"image",srTitle:"ADF-DOCUMENT-LIST.LAYOUT.THUMBNAIL",sortable:!1},{key:"title",type:"text",title:"ADF-DOCUMENT-LIST.LAYOUT.NAME",cssClass:"full-width ellipsis-cell",sortable:!0},{key:"visibility",type:"text",title:"ADF-DOCUMENT-LIST.LAYOUT.STATUS",sortable:!0}],"-mysites-":[{key:"$thumbnail",type:"image",srTitle:"ADF-DOCUMENT-LIST.LAYOUT.THUMBNAIL",sortable:!1},{key:"title",type:"text",title:"ADF-DOCUMENT-LIST.LAYOUT.NAME",cssClass:"full-width ellipsis-cell",sortable:!0},{key:"visibility",type:"text",title:"ADF-DOCUMENT-LIST.LAYOUT.STATUS",sortable:!0}],"-favorites-":[{key:"$thumbnail",type:"image",srTitle:"ADF-DOCUMENT-LIST.LAYOUT.THUMBNAIL",sortable:!1},{key:"name",type:"text",title:"ADF-DOCUMENT-LIST.LAYOUT.NAME",cssClass:"full-width ellipsis-cell",sortable:!0},{key:"path",type:"location",title:"ADF-DOCUMENT-LIST.LAYOUT.LOCATION",sortable:!0},{key:"content.sizeInBytes",type:"fileSize",title:"ADF-DOCUMENT-LIST.LAYOUT.SIZE",sortable:!0},{key:"modifiedAt",type:"date",title:"ADF-DOCUMENT-LIST.LAYOUT.MODIFIED_ON",format:"timeAgo",sortable:!0},{key:"modifiedByUser.displayName",type:"text",title:"ADF-DOCUMENT-LIST.LAYOUT.MODIFIED_BY",sortable:!0}],"-recent-":[{key:"$thumbnail",type:"image",srTitle:"ADF-DOCUMENT-LIST.LAYOUT.THUMBNAIL",sortable:!1},{key:"name",type:"text",title:"ADF-DOCUMENT-LIST.LAYOUT.NAME",cssClass:"full-width ellipsis-cell",sortable:!0},{key:"path",type:"location",title:"ADF-DOCUMENT-LIST.LAYOUT.LOCATION",cssClass:"ellipsis-cell",sortable:!0},{key:"content.sizeInBytes",type:"fileSize",title:"ADF-DOCUMENT-LIST.LAYOUT.SIZE",sortable:!0},{key:"modifiedAt",type:"date",title:"ADF-DOCUMENT-LIST.LAYOUT.MODIFIED_ON",format:"timeAgo",sortable:!0}],"-sharedlinks-":[{key:"$thumbnail",type:"image",srTitle:"ADF-DOCUMENT-LIST.LAYOUT.THUMBNAIL",sortable:!1},{key:"name",type:"text",title:"ADF-DOCUMENT-LIST.LAYOUT.NAME",cssClass:"full-width ellipsis-cell",sortable:!0},{key:"path",type:"location",title:"ADF-DOCUMENT-LIST.LAYOUT.LOCATION",cssClass:"ellipsis-cell",sortable:!0},{key:"content.sizeInBytes",type:"fileSize",title:"ADF-DOCUMENT-LIST.LAYOUT.SIZE",sortable:!0},{key:"modifiedAt",type:"date",title:"ADF-DOCUMENT-LIST.LAYOUT.MODIFIED_ON",format:"timeAgo",sortable:!0},{key:"modifiedByUser.displayName",type:"text",title:"ADF-DOCUMENT-LIST.LAYOUT.MODIFIED_BY",sortable:!0},{key:"sharedByUser.displayName",type:"text",title:"ADF-DOCUMENT-LIST.LAYOUT.SHARED_BY",sortable:!0}],"default":[{key:"$thumbnail",type:"image",srTitle:"ADF-DOCUMENT-LIST.LAYOUT.THUMBNAIL",sortable:!1},{key:"name",type:"text",title:"ADF-DOCUMENT-LIST.LAYOUT.NAME",cssClass:"full-width ellipsis-cell",sortable:!0},{key:"content.sizeInBytes",type:"fileSize",title:"ADF-DOCUMENT-LIST.LAYOUT.SIZE",sortable:!0},{key:"modifiedAt",type:"date",title:"ADF-DOCUMENT-LIST.LAYOUT.MODIFIED_ON",format:"timeAgo",sortable:!0},{key:"modifiedByUser.displayName",type:"text",title:"ADF-DOCUMENT-LIST.LAYOUT.MODIFIED_BY",sortable:!0}]},Se=function qo(e){this.disableWithNoPermission=!1,this.disabled=!1,this.visible=!0,e&&(this.icon=e.icon,this.title=e.title,this.handler=e.handler,this.execute=e.execute,this.target=e.target,this.permission=e.permission,this.disableWithNoPermission=e.disableWithNoPermission,e.hasOwnProperty("disabled")&&(this.disabled=e.disabled),e.hasOwnProperty("visible")&&(this.visible=e.visible))},Ie={Document:"document",Folder:"folder",All:"all"},Ee=(C(Ae,ve=Se),Ae);
/*!
     * @license
     * Copyright 2019 Alfresco Software, Ltd.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *     http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Ae(e){var t=ve.call(this,e)||this;return t.target="document",t}var Ce,Te=(C(Oe,Ce=Se),Oe);function Oe(e){var t=Ce.call(this,e)||this;return t.target="folder",t}var De,we=(C(Le,De=b.BaseEvent),Le);function Le(e){var t=De.call(this)||this;return t.value=e,t}var Ne,Fe=(C(Re,Ne=b.BaseEvent),Re);function Re(e){var t=Ne.call(this)||this;return t.value=e,t}var ke=(Object.defineProperty(xe.prototype,"rowFilter",{get:function(){return this._rowFilter},set:function(e){this._rowFilter=e,this.data&&(this.data.setFilter(this._rowFilter),this._currentFolderId&&this.reload())},enumerable:!0,configurable:!0}),Object.defineProperty(xe.prototype,"currentFolderId",{get:function(){return this._currentFolderId},set:function(e){this._currentFolderId!==e&&(this._currentFolderId=e,this.data&&(this.data.loadPage(null,!1),this.resetNewFolderPagination()),this._currentFolderId&&this.loadFolder())},enumerable:!0,configurable:!0}),xe.prototype.getContextActions=function(t){var n=this;if(t&&t.entry){var e=this.getNodeActions(t);if(e&&0<e.length)return e.map(function(e){return{model:e,node:t,subject:n.contextActionHandler}})}return null},Object.defineProperty(xe.prototype,"hasCustomLayout",{get:function(){return this.columnList&&this.columnList.columns&&0<this.columnList.columns.length},enumerable:!0,configurable:!0}),xe.prototype.getDefaultSorting=function(){var e;if(this.sorting){var t=L(this.sorting,2),n=t[0],i=t[1];e=new b.DataSorting(n,i)}return e},xe.prototype.getLayoutPreset=function(e){return void 0===e&&(e="default"),(this.layoutPresets[e]||this.layoutPresets["default"]).map(function(e){return new b.ObjectDataColumn(e)})},xe.prototype.isMobile=function(){return!!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)},xe.prototype.isEmpty=function(){return!this.data||0===this.data.getRows().length},xe.prototype.ngOnInit=function(){var t=this;this.rowMenuCache={},this.loadLayoutPresets(),this.data=new ge(this.thumbnailService,this.contentService,null,this.getDefaultSorting(),this.sortingMode),this.data.thumbnails=this.thumbnails,this.data.permissionsStyle=this.permissionsStyle,this._rowFilter&&this.data.setFilter(this._rowFilter),this.imageResolver&&this.data.setImageResolver(this.imageResolver),this.contextActionHandler.pipe(m.takeUntil(this.onDestroy$)).subscribe(function(e){return t.contextActionCallback(e)}),this.enforceSingleClickNavigationForMobile()},xe.prototype.ngAfterContentInit=function(){var e=this;this.columnList&&this.columnList.columns.changes.pipe(m.takeUntil(this.onDestroy$)).subscribe(function(){return e.setTableSchema()}),this.setTableSchema()},xe.prototype.setTableSchema=function(){var e=[];this.hasCustomLayout&&(e=this.columnList.columns.map(function(e){return e})),this.data?e&&0<e.length&&this.data.setColumns(e):this.data=new ge(this.thumbnailService,this.contentService,e,this.getDefaultSorting(),this.sortingMode);var t=this.data.getColumns();t&&0!==t.length||this.setupDefaultColumns(this._currentFolderId)},xe.prototype.ngOnChanges=function(e){if(this.resetSelection(),this.data&&(this.data.thumbnails=this.thumbnails),e.sortingMode&&!e.sortingMode.firstChange&&this.data&&(this.data.sortingMode=e.sortingMode.currentValue),e.sorting&&!e.sorting.firstChange&&this.data){var t=e.sorting.currentValue;if(t&&0<t.length){var n=L(t,2),i=n[0],o=n[1];this.data.setSorting(new b.DataSorting(i,o))}}if(this.data)if(e.node&&e.node.currentValue){var r=!!this._pagination&&this._pagination.merge;this.data.loadPage(e.node.currentValue,r),this.onDataReady(e.node.currentValue)}else e.imageResolver&&this.data.setImageResolver(e.imageResolver.currentValue)},xe.prototype.reload=function(){var e=this;this.ngZone.run(function(){e.resetSelection(),e.node?(e.data.loadPage(e.node,e._pagination.merge),e.onDataReady(e.node)):e.loadFolder()})},xe.prototype.contextActionCallback=function(e){e&&this.executeContentAction(e.node,e.model)},xe.prototype.getNodeActions=function(t){var n=this;if(t&&t.entry){var i=null;if(t.entry.isFile?i="document":t.entry.isFolder&&(i="folder"),i){var e=this.rowMenuCache[t.entry.id];if(e)return e.forEach(function(e){n.refreshAction(e,t)}),e;var o=this.actions.filter(function(e){return("function"==typeof e.visible?e.visible(t):e.visible)&&e.target.toLowerCase()===i}).map(function(e){return new Se(e)});return o.forEach(function(e){n.refreshAction(e,t)}),this.rowMenuCache[t.entry.id]=o}}return[]},xe.prototype.refreshAction=function(e,t){e.disabled=this.isActionDisabled(e,t),e.visible=this.isActionVisible(e,t)},xe.prototype.isActionVisible=function(e,t){return"function"==typeof e.visible?e.visible(t):e.visible},xe.prototype.isActionDisabled=function(e,t){return"function"==typeof e.disabled?e.disabled(t):!!(e.permission&&e.disableWithNoPermission&&!this.contentService.hasAllowableOperations(t.entry,e.permission)||this.lockService.isLocked(t.entry))||e.disabled},xe.prototype.onShowContextMenu=function(e){e&&this.contextMenuActions&&e.preventDefault()},xe.prototype.navigateTo=function(e){return"string"==typeof e?(this.resetNewFolderPagination(),this._currentFolderId=e,this.folderChange.emit(new Fe({id:e})),this.reload(),!0):!!this.canNavigateFolder(e)&&(this.resetNewFolderPagination(),this._currentFolderId=this.getNodeFolderDestinationId(e),this.folderChange.emit(new Fe({id:this._currentFolderId})),this.reload(),!0)},xe.prototype.getNodeFolderDestinationId=function(e){return this.isLinkFolder(e)?e.properties["cm:destination"]:e.id},xe.prototype.isLinkFolder=function(e){return"app:folderlink"===e.nodeType&&e.properties&&e.properties["cm:destination"]},xe.prototype.updateCustomSourceData=function(e){this._currentFolderId=e},xe.prototype.executeContentAction=function(e,t){if(e&&e.entry&&t){var n=void 0;n="function"==typeof t.handler?t.handler(e,this,t.permission):u.of(!0),"function"==typeof t.execute&&n&&n.pipe(m.takeUntil(this.onDestroy$)).subscribe(function(){return t.execute(e)})}},xe.prototype.setLoadingState=function(e){var t=this;e?(clearTimeout(this.loadingTimeout),this.loadingTimeout=setTimeout(function(){t.loading=!0},1e3)):(clearTimeout(this.loadingTimeout),this.loading=!1)},xe.prototype.loadFolder=function(){var t=this;this._pagination.merge||this.setLoadingState(!0),this.hasCustomLayout||this.setupDefaultColumns(this._currentFolderId),this.documentListService.isCustomSourceService(this._currentFolderId)&&this.updateCustomSourceData(this._currentFolderId),this.documentListService.loadFolderByNodeId(this._currentFolderId,this._pagination,this.includeFields,this.where).subscribe(function(e){e.currentNode&&(t.folderNode=e.currentNode.entry,t.$folderNode.next(e.currentNode.entry)),t.onPageLoaded(e.children)},function(e){t.handleError(e)})},xe.prototype.resetSelection=function(){this.dataTable.resetSelection(),this.selection=[],this.noPermission=!1},xe.prototype.onPageLoaded=function(e){e&&(this.data.loadPage(e,this._pagination.merge),this.setLoadingState(!1),this.onDataReady(e))},xe.prototype.setupDefaultColumns=function(e){if(void 0===e&&(e="default"),this.data){var t=this.getLayoutPreset(e);this.data.setColumns(t)}},xe.prototype.onPreviewFile=function(e){e&&this.preview.emit(new we(e))},xe.prototype.onNodeClick=function(e){var t=new CustomEvent("node-click",{detail:{sender:this,node:e},bubbles:!0});this.elementRef.nativeElement.dispatchEvent(t);var n=new we(e);this.nodeClick.emit(n),n.defaultPrevented||this.navigate&&this.navigationMode===xe.SINGLE_CLICK_NAVIGATION&&this.executeActionClick(e)},xe.prototype.onNodeDblClick=function(e){var t=new CustomEvent("node-dblclick",{detail:{sender:this,node:e},bubbles:!0});this.elementRef.nativeElement.dispatchEvent(t);var n=new we(e);this.nodeDblClick.emit(n),n.defaultPrevented||this.navigate&&this.navigationMode===xe.DOUBLE_CLICK_NAVIGATION&&this.executeActionClick(e)},xe.prototype.executeActionClick=function(e){var t=this;if(e&&e.entry&&(e.entry.isFile&&this.onPreviewFile(e),e.entry.isFolder&&this.navigateTo(e.entry),e.entry.guid)){var n={include:this.includeFields};this.alfrescoApiService.nodesApi.getNode(e.entry.guid,n).then(function(e){t.navigateTo(e.entry)})}},xe.prototype.onNodeSelect=function(e){this.selection=e.selection.map(function(e){return e.node});var t=new CustomEvent("node-select",{detail:{node:e.row.node,selection:this.selection},bubbles:!0});this.elementRef.nativeElement.dispatchEvent(t)},xe.prototype.onNodeUnselect=function(e){this.selection=e.selection.map(function(e){return e.node});var t=new CustomEvent("node-unselect",{detail:{node:e.row?e.row.node:null,selection:this.selection},bubbles:!0});this.elementRef.nativeElement.dispatchEvent(t)},xe.prototype.onShowRowContextMenu=function(e){if(this.contextMenuActions){var t=e.value,n=t.row.node;n&&(t.actions=this.getContextActions(n)||[])}},xe.prototype.onShowRowActionsMenu=function(e){if(this.contentActions){var t=e.value,n=t.row.node;n&&(t.actions=this.getNodeActions(n)||[])}},xe.prototype.onExecuteRowAction=function(e){if(this.contentActions){var t=e.value,n=t.row.node,i=t.action;this.executeContentAction(n,i)}},xe.prototype.enforceSingleClickNavigationForMobile=function(){this.isMobile()&&(this.navigationMode=xe.SINGLE_CLICK_NAVIGATION)},xe.prototype.canNavigateFolder=function(e){var t=!1;return e&&e.isFolder&&(t=!0),t},xe.prototype.loadLayoutPresets=function(){var e=this.appConfig.get("document-list.presets",null);this.layoutPresets=e?Object.assign({},be,e):be},xe.prototype.onDataReady=function(e){this.ready.emit(e),this.pagination.next(e.list.pagination)},xe.prototype.updatePagination=function(e){this._pagination.maxItems=e.maxItems,this._pagination.merge=e.merge,this._pagination.skipCount=e.skipCount,this.reload()},xe.prototype.resetNewFolderPagination=function(){this._pagination.skipCount=0,this._pagination.maxItems=this.maxItems},xe.prototype.ngOnDestroy=function(){this.onDestroy$.next(!0),this.onDestroy$.complete()},xe.prototype.handleError=function(e){if(e.message)try{403===JSON.parse(e.message).error.statusCode&&(this.setLoadingState(!1),this.noPermission=!0)}catch(t){}this.error.emit(e)},xe.SINGLE_CLICK_NAVIGATION="click",xe.DOUBLE_CLICK_NAVIGATION="dblclick",xe.decorators=[{type:y.Component,args:[{selector:"adf-document-list",template:'<adf-datatable\n    #dataTable\n    [selectionMode]="selectionMode"\n    [data]="data"\n    [actions]="contentActions"\n    [actionsPosition]="contentActionsPosition"\n    [multiselect]="multiselect"\n    [allowDropFiles]="allowDropFiles"\n    [contextMenu]="contextMenuActions"\n    [rowStyle]="rowStyle"\n    [rowStyleClass]="rowStyleClass"\n    [loading]="loading"\n    [display]="display"\n    [noPermission]="noPermission"\n    [showHeader]="!isEmpty() && showHeader"\n    [rowMenuCacheEnabled]="false"\n    [stickyHeader]="stickyHeader"\n    (showRowContextMenu)="onShowRowContextMenu($event)"\n    (showRowActionsMenu)="onShowRowActionsMenu($event)"\n    (executeRowAction)="onExecuteRowAction($event)"\n    (rowClick)="onNodeClick($event.value?.node)"\n    (rowDblClick)="onNodeDblClick($event.value?.node)"\n    (row-select)="onNodeSelect($event.detail)"\n    (row-unselect)="onNodeUnselect($event.detail)"\n    [class.adf-datatable-gallery-thumbnails]="data.thumbnails">\n\n    <adf-no-content-template>\n        <ng-template>\n            <adf-empty-list *ngIf="!customNoContentTemplate">\n                <div class="adf-empty-list_template adf-empty-folder">\n                    <div class="adf-empty-folder-this-space-is-empty">{{\'ADF-DOCUMENT-LIST.EMPTY.HEADER\' | translate}}</div>\n                    <div fxHide.lt-md="true" class="adf-empty-folder-drag-drop">{{ \'ADF-DATATABLE.EMPTY.DRAG-AND-DROP.TITLE\' | translate }}</div>\n                    <div fxHide.lt-md="true" class="adf-empty-folder-any-files-here-to-add">{{ \'ADF-DATATABLE.EMPTY.DRAG-AND-DROP.SUBTITLE\' | translate }}</div>\n                    <img [alt]="\'ADF-DATATABLE.EMPTY.DRAG-AND-DROP.TITLE\' | translate" class="adf-empty-folder-image" [src]="emptyFolderImageUrl">\n                </div>\n            </adf-empty-list>\n            <ng-content select="adf-custom-empty-content-template, empty-folder-content"></ng-content>\n        </ng-template>\n    </adf-no-content-template>\n\n    <adf-no-permission-template>\n        <ng-template>\n            <div class="adf-no-permission__template" *ngIf="!customNoPermissionsTemplate">\n                <mat-icon>error</mat-icon>\n                <p class="adf-no-permission__template--text">{{ \'ADF-DOCUMENT-LIST.NO_PERMISSION\' | translate }}</p>\n            </div>\n            <ng-content select="adf-custom-no-permission-template, no-permission-content"></ng-content>\n        </ng-template>\n    </adf-no-permission-template>\n\n    <adf-loading-content-template>\n        <ng-template>\n            <div class="adf-document-list-loading-container" *ngIf="!customLoadingContent">\n                <mat-progress-spinner\n                    id="adf-document-list-loading"\n                    class="adf-document-list-loading-margin"\n                    [color]="\'primary\'"\n                    [mode]="\'indeterminate\'">\n                </mat-progress-spinner>\n            </div>\n            <ng-content select="adf-custom-loading-content-template"></ng-content>\n        </ng-template>\n    </adf-loading-content-template>\n\n</adf-datatable>\n',encapsulation:y.ViewEncapsulation.None,host:{"class":"adf-document-list"},styles:[""]}]}],xe.ctorParameters=function(){return[{type:x},{type:y.NgZone},{type:y.ElementRef},{type:b.AppConfigService},{type:b.UserPreferencesService},{type:b.ContentService},{type:b.ThumbnailService},{type:b.AlfrescoApiService},{type:b.LockService}]},xe.propDecorators={columnList:[{type:y.ContentChild,args:[b.DataColumnListComponent]}],customLoadingContent:[{type:y.ContentChild,args:[b.CustomLoadingContentTemplateDirective]}],customNoPermissionsTemplate:[{type:y.ContentChild,args:[b.CustomNoPermissionTemplateDirective]}],customNoContentTemplate:[{type:y.ContentChild,args:[b.CustomEmptyContentTemplateDirective]}],includeFields:[{type:y.Input}],where:[{type:y.Input}],display:[{type:y.Input}],permissionsStyle:[{type:y.Input}],locationFormat:[{type:y.Input}],navigate:[{type:y.Input}],showHeader:[{type:y.Input}],navigationMode:[{type:y.Input}],thumbnails:[{type:y.Input}],selectionMode:[{type:y.Input}],multiselect:[{type:y.Input}],contentActions:[{type:y.Input}],contentActionsPosition:[{type:y.Input}],contextMenuActions:[{type:y.Input}],emptyFolderImageUrl:[{type:y.Input}],allowDropFiles:[{type:y.Input}],sorting:[{type:y.Input}],sortingMode:[{type:y.Input}],rowStyle:[{type:y.Input}],rowStyleClass:[{type:y.Input}],loading:[{type:y.Input}],_rowFilter:[{type:y.Input}],rowFilter:[{type:y.Input}],imageResolver:[{type:y.Input}],stickyHeader:[{type:y.Input}],currentFolderId:[{type:y.Input}],node:[{type:y.Input}],maxItems:[{type:y.Input}],nodeClick:[{type:y.Output}],nodeDblClick:[{type:y.Output}],folderChange:[{type:y.Output}],preview:[{type:y.Output}],ready:[{type:y.Output}],error:[{type:y.Output}],dataTable:[{type:y.ViewChild,args:["dataTable"]}],onShowContextMenu:[{type:y.HostListener,args:["contextmenu",["$event"]]}]},xe);function xe(e,t,n,i,o,r,a,s,l){var c=this;this.documentListService=e,this.ngZone=t,this.elementRef=n,this.appConfig=i,this.userPreferencesService=o,this.contentService=r,this.thumbnailService=a,this.alfrescoApiService=s,this.lockService=l,this.DEFAULT_PAGINATION=new f.Pagination({hasMoreItems:!1,skipCount:0,maxItems:25,totalItems:0}),this.display=b.DisplayMode.List,this.permissionsStyle=[],this.locationFormat="/",this.navigate=!0,this.showHeader=!0,this.navigationMode=xe.DOUBLE_CLICK_NAVIGATION,this.thumbnails=!1,this.selectionMode="single",this.multiselect=!1,this.contentActions=!1,this.contentActionsPosition="right",this.contextMenuActions=!1,this.emptyFolderImageUrl="./assets/images/empty_doc_lib.svg",this.allowDropFiles=!1,this.sorting=["name","asc"],this.sortingMode="client",this.loading=!1,this._rowFilter=null,this.imageResolver=null,this.stickyHeader=!1,this._currentFolderId=null,this.node=null,this.maxItems=this.DEFAULT_PAGINATION.maxItems,this.nodeClick=new y.EventEmitter,this.nodeDblClick=new y.EventEmitter,this.folderChange=new y.EventEmitter,this.preview=new y.EventEmitter,this.ready=new y.EventEmitter,this.error=new y.EventEmitter,this.actions=[],this.contextActionHandler=new u.Subject,this.noPermission=!1,this.selection=new Array,this.$folderNode=new u.Subject,this._pagination=this.DEFAULT_PAGINATION,this.pagination=new u.BehaviorSubject(this.DEFAULT_PAGINATION),this.layoutPresets={},this.rowMenuCache={},this.onDestroy$=new u.Subject,this.userPreferencesService.select(b.UserPreferenceValues.PaginationSize).pipe(m.takeUntil(this.onDestroy$)).subscribe(function(e){c.maxItems=c._pagination.maxItems=e})}var Pe=(Me.prototype.registerColumn=function(e){return!(!this.documentList||!e||(this.documentList.data.getColumns().push(e),0))},Me.decorators=[{type:y.Component,args:[{selector:"content-columns",template:""}]}],Me.ctorParameters=function(){return[{type:ke},{type:b.LogService}]},Me);function Me(e,t){this.documentList=e,this.logService=t,this.logService.log("ContentColumnListComponent is deprecated starting with 1.7.0 and may be removed in future versions. Use DataColumnListComponent instead.")}var _e=(Ue.prototype.ngOnInit=function(){this.srTitle||"$thumbnail"!==this.key||(this.srTitle="Thumbnail")},Ue.prototype.ngAfterContentInit=function(){this.register()},Ue.prototype.register=function(){return!!this.list&&this.list.registerColumn(this)},Ue.decorators=[{type:y.Component,args:[{selector:"content-column",template:""}]}],Ue.ctorParameters=function(){return[{type:Pe},{type:b.LogService}]},Ue.propDecorators={key:[{type:y.Input}],type:[{type:y.Input}],format:[{type:y.Input}],sortable:[{type:y.Input}],title:[{type:y.Input}],template:[{type:y.ContentChild,args:[y.TemplateRef]}],srTitle:[{type:y.Input,args:["sr-title"]}],cssClass:[{type:y.Input,args:["class"]}]},Ue);
/*!
     * @license
     * Copyright 2019 Alfresco Software, Ltd.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *     http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Ue(e,t){this.list=e,this.logService=t,this.type="text",this.sortable=!1,this.title="",this.logService.log("ContentColumnComponent is deprecated starting with 1.7.0 and may be removed in future versions. Use DataColumnComponent instead.")}var Be=function Yo(e){e&&(this.type=e.type||null,this.action=e.action||null,this.permission=e.permission||null)},Ve=(je.prototype.downloadNode=function(e){new b.NodeDownloadDirective(this.apiService,this.dialog).downloadNode(e)},je.prototype.copyContent=function(e,t){return this.doFileOperation("copy","content",e,t)},je.prototype.copyFolder=function(e,t){return this.doFileOperation("copy","folder",e,t)},je.prototype.moveContent=function(e,t){return this.doFileOperation("move","content",e,t)},je.prototype.moveFolder=function(e,t){return this.doFileOperation("move","folder",e,t)},je.prototype.doFileOperation=function(n,i,o,e){var r=this,a=new u.Subject;return this.contentDialogService.openCopyMoveDialog(n,o,e).subscribe(function(e){var t=e[0];r.documentListService[n+"Node"].call(r.documentListService,o.id,t.id).subscribe(a.next.bind(a,"OPERATION.SUCCESS."+i.toUpperCase()+"."+n.toUpperCase()),a.error.bind(a))},function(e){return a.error(e),a}),a},je.decorators=[{type:y.Injectable,args:[{providedIn:"root"}]}],je.ctorParameters=function(){return[{type:V},{type:d.MatDialog},{type:b.ContentService},{type:x},{type:b.AlfrescoApiService},{type:d.MatDialog}]},je.propDecorators={error:[{type:y.Output}]},je.ngInjectableDef=y.defineInjectable({factory:function(){return new je(y.inject(V),y.inject(l.MatDialog),y.inject(b.ContentService),y.inject(x),y.inject(b.AlfrescoApiService),y.inject(l.MatDialog))},token:je,providedIn:"root"}),je);function je(e,t,n,i,o,r){this.contentDialogService=e,this.dialogRef=t,this.content=n,this.documentListService=i,this.apiService=o,this.dialog=r,this.error=new y.EventEmitter}var $e=(He.prototype.getHandler=function(e){if(e){var t=e.toLowerCase();return this.handlers[t]||null}return null},He.prototype.setHandler=function(e,t){if(e){var n=e.toLowerCase();return this.handlers[n]=t,!0}return!1},He.prototype.canExecuteAction=function(e){return this.documentListService&&e&&!0===e.entry.isFile},He.prototype.setupActionHandlers=function(){this.handlers.copy=this.copyNode.bind(this),this.handlers.move=this.moveNode.bind(this),this.handlers["delete"]=this.deleteNode.bind(this),this.handlers.download=this.downloadNode.bind(this),this.handlers.lock=this.lockNode.bind(this)},He.prototype.lockNode=function(e,t,n){return this.contentNodeDialogService.openLockNodeDialog(e.entry)},He.prototype.downloadNode=function(e,t,n){this.nodeActionsService.downloadNode(e)},He.prototype.copyNode=function(e,t,n){var i=this.nodeActionsService.copyContent(e.entry,n);return this.prepareHandlers(i,"content","copy",t,n),i},He.prototype.moveNode=function(e,t,n){var i=this.nodeActionsService.moveContent(e.entry,n);return this.prepareHandlers(i,"content","move",t,n),i},He.prototype.prepareHandlers=function(e,t,n,i,o){var r=this;e.subscribe(function(e){r.success.next(e)},this.error.next.bind(this.error))},He.prototype.deleteNode=function(t,e,n){var i,o=this;if(this.canExecuteAction(t))return this.contentService.hasAllowableOperations(t.entry,n)?((i=this.documentListService.deleteNode(t.entry.id)).subscribe(function(){var e=o.translation.instant("CORE.DELETE_NODE.SINGULAR",{name:t.entry.name});o.success.next(e)},function(){var e=o.translation.instant("CORE.DELETE_NODE.ERROR_SINGULAR",{name:t.entry.name});o.error.next(e)}),i):(this.permissionEvent.next(new Be({type:"content",action:"delete",permission:n})),u.throwError(new Error("No permission to delete")))},He.decorators=[{type:y.Injectable,args:[{providedIn:"root"}]}],He.ctorParameters=function(){return[{type:Ve},{type:V},{type:b.TranslationService},{type:x},{type:b.ContentService}]},He.ngInjectableDef=y.defineInjectable({factory:function(){return new He(y.inject(Ve),y.inject(V),y.inject(b.TranslationService),y.inject(x),y.inject(b.ContentService))},token:He,providedIn:"root"}),He);function He(e,t,n,i,o){this.nodeActionsService=e,this.contentNodeDialogService=t,this.translation=n,this.documentListService=i,this.contentService=o,this.permissionEvent=new u.Subject,this.error=new u.Subject,this.success=new u.Subject,this.handlers={},this.setupActionHandlers()}var Ge=(qe.prototype.getHandler=function(e){if(e){var t=e.toLowerCase();return this.handlers[t]||null}return null},qe.prototype.setHandler=function(e,t){if(e){var n=e.toLowerCase();return this.handlers[n]=t,!0}return!1},qe.prototype.canExecuteAction=function(e){return this.documentListService&&e&&!0===e.entry.isFolder},qe.prototype.setupActionHandlers=function(){this.handlers.copy=this.copyNode.bind(this),this.handlers.move=this.moveNode.bind(this),this.handlers["delete"]=this.deleteNode.bind(this),this.handlers.download=this.downloadNode.bind(this)},qe.prototype.downloadNode=function(e){this.nodeActionsService.downloadNode(e)},qe.prototype.copyNode=function(e,t,n){var i=this.nodeActionsService.copyFolder(e.entry,n);return this.prepareHandlers(i,"folder","copy",t,n),i},qe.prototype.moveNode=function(e,t,n){var i=this.nodeActionsService.moveFolder(e.entry,n);return this.prepareHandlers(i,"folder","move",t,n),i},qe.prototype.prepareHandlers=function(e,t,n,i,o){var r=this;e.subscribe(function(e){i&&"function"==typeof i.reload&&i.reload(),r.success.next(e)},this.error.next.bind(this.error))},qe.prototype.deleteNode=function(t,n,e){var i,o=this;if(this.canExecuteAction(t))return this.contentService.hasAllowableOperations(t.entry,e)?((i=this.documentListService.deleteNode(t.entry.id)).subscribe(function(){n&&"function"==typeof n.reload&&n.reload();var e=o.translation.instant("CORE.DELETE_NODE.SINGULAR",{name:t.entry.name});o.success.next(e)},function(){var e=o.translation.instant("CORE.DELETE_NODE.ERROR_SINGULAR",{name:t.entry.name});o.error.next(e)}),i):(this.permissionEvent.next(new Be({type:"folder",action:"delete",permission:e})),u.throwError(new Error("No permission to delete")))},qe.decorators=[{type:y.Injectable,args:[{providedIn:"root"}]}],qe.ctorParameters=function(){return[{type:Ve},{type:x},{type:b.ContentService},{type:b.TranslationService}]},qe.ngInjectableDef=y.defineInjectable({factory:function(){return new qe(y.inject(Ve),y.inject(x),y.inject(b.ContentService),y.inject(b.TranslationService))},token:qe,providedIn:"root"}),qe);function qe(e,t,n,i){this.nodeActionsService=e,this.documentListService=t,this.contentService=n,this.translation=i,this.permissionEvent=new u.Subject,this.error=new u.Subject,this.success=new u.Subject,this.handlers={},this.setupActionHandlers()}var Ye=(ze.prototype.registerAction=function(e){return!(!this.documentList||!e||(this.documentList.actions.push(e),0))},ze.prototype.unregisterAction=function(e){if(this.documentList&&e){var t=this.documentList.actions.indexOf(e);if(0<=t)return this.documentList.actions.splice(t,1),!0}return!1},ze.decorators=[{type:y.Component,args:[{selector:"content-actions",template:""}]}],ze.ctorParameters=function(){return[{type:ke}]},ze);function ze(e){this.documentList=e}var Qe=(We.prototype.ngOnInit=function(){this.target===Ie.All?(this.folderActionModel=this.generateAction(Ie.Folder),this.documentActionModel=this.generateAction(Ie.Document)):this.documentActionModel=this.generateAction(this.target)},We.prototype.ngOnChanges=function(e){e.visible&&!e.visible.firstChange&&(this.documentActionModel&&(this.documentActionModel.visible=e.visible.currentValue),this.folderActionModel&&(this.folderActionModel.visible=e.visible.currentValue)),e.disabled&&!e.disabled.firstChange&&(this.documentActionModel&&(this.documentActionModel.disabled=e.disabled.currentValue),this.folderActionModel&&(this.folderActionModel.disabled=e.disabled.currentValue))},We.prototype.ngOnDestroy=function(){this.subscriptions.forEach(function(e){return e.unsubscribe()}),this.subscriptions=[],this.documentActionModel&&(this.unregister(this.documentActionModel),this.documentActionModel=null),this.folderActionModel&&(this.unregister(this.folderActionModel),this.folderActionModel=null)},We.prototype.register=function(e){return!!this.list&&this.list.registerAction(e)},We.prototype.unregister=function(e){return!!this.list&&this.list.unregisterAction(e)},We.prototype.generateAction=function(e){var t=this,n=new Se({title:this.title,icon:this.icon,permission:this.permission,disableWithNoPermission:this.disableWithNoPermission,target:e,disabled:this.disabled,visible:this.visible});return this.handler&&(n.handler=this.getSystemHandler(e,this.handler)),this.execute&&(n.execute=function(e){t.execute.emit({value:e})}),this.register(n),n},We.prototype.getSystemHandler=function(e,t){var n=this;if(e){if((e=e.toLowerCase())===Ie.Document)return this.documentActions?(this.subscriptions.push(this.documentActions.permissionEvent.subscribe(function(e){n.permissionEvent.emit(e)}),this.documentActions.error.subscribe(function(e){n.error.emit(e)}),this.documentActions.success.subscribe(function(e){n.success.emit(e)})),this.documentActions.getHandler(t)):null;if(e===Ie.Folder)return this.folderActions?(this.subscriptions.push(this.folderActions.permissionEvent.subscribe(function(e){n.permissionEvent.emit(e)}),this.folderActions.error.subscribe(function(e){n.error.emit(e)}),this.folderActions.success.subscribe(function(e){n.success.emit(e)})),this.folderActions.getHandler(t)):null}return null},We.decorators=[{type:y.Component,args:[{selector:"content-action",template:"",providers:[$e,Ge]}]}],We.ctorParameters=function(){return[{type:Ye},{type:$e},{type:Ge}]},We.propDecorators={title:[{type:y.Input}],icon:[{type:y.Input}],visible:[{type:y.Input}],handler:[{type:y.Input}],target:[{type:y.Input}],permission:[{type:y.Input}],disableWithNoPermission:[{type:y.Input}],disabled:[{type:y.Input}],execute:[{type:y.Output}],permissionEvent:[{type:y.Output}],error:[{type:y.Output}],success:[{type:y.Output}]},We);function We(e,t,n){this.list=e,this.documentActions=t,this.folderActions=n,this.title="Action",this.visible=!0,this.target=Ie.All,this.disabled=!1,this.execute=new y.EventEmitter,this.permissionEvent=new y.EventEmitter,this.error=new y.EventEmitter,this.success=new y.EventEmitter,this.subscriptions=[]}var Xe=(Ze.prototype.ngOnInit=function(){var i=this;this.updateValue(),this.alfrescoApiService.nodeUpdated.pipe(m.takeUntil(this.onDestroy$)).subscribe(function(e){var t=i.context.row;if(t){var n=t.node.entry;n===e&&(t.node={entry:n},i.updateValue())}})},Ze.prototype.updateValue=function(){this.node=this.context.row.node;var e=this.context.data.rows||[];this.node&&this.node.entry&&(this.displayText$.next(this.makeLibraryTitle(this.node.entry,e)),this.displayTooltip$.next(this.makeLibraryTooltip(this.node.entry)))},Ze.prototype.onClick=function(){this.element.nativeElement.dispatchEvent(new CustomEvent("name-click",{bubbles:!0,detail:{node:this.node}}))},Ze.prototype.makeLibraryTooltip=function(e){var t=e.description,n=e.title;return t||n||""},Ze.prototype.makeLibraryTitle=function(e,t){var n=t.map(function(e){return e.node.entry}),i=e.title,o=e.id,r=!1;return n&&(r=n.some(function(e){return e.id!==o&&e.title===i})),r?i+" ("+o+")":""+i},Ze.prototype.ngOnDestroy=function(){this.onDestroy$.next(!0),this.onDestroy$.complete()},Ze.decorators=[{type:y.Component,args:[{selector:"adf-library-name-column",template:'\n        <span class="adf-datatable-cell-value" title="{{ displayTooltip$ | async }}" (click)="onClick()">\n            {{ displayText$ | async }}\n        </span>\n    ',changeDetection:y.ChangeDetectionStrategy.OnPush,encapsulation:y.ViewEncapsulation.None,host:{"class":"adf-datatable-content-cell adf-datatable-link adf-library-name-column"}}]}],Ze.ctorParameters=function(){return[{type:y.ElementRef},{type:b.AlfrescoApiService}]},Ze.propDecorators={context:[{type:y.Input}]},Ze);function Ze(e,t){this.element=e,this.alfrescoApiService=t,this.displayTooltip$=new u.BehaviorSubject(""),this.displayText$=new u.BehaviorSubject(""),this.onDestroy$=new u.Subject}var Ke=(Je.prototype.ngOnInit=function(){var i=this;this.updateValue(),this.api.nodeUpdated.pipe(m.takeUntil(this.onDestroy$)).subscribe(function(e){var t=i.context.row;if(t){var n=t.node.entry;n===e&&(t.node={entry:n},i.updateValue())}})},Je.prototype.updateValue=function(){var e=this.context.row.node;if(e&&e.entry)switch(e.entry.role){case f.Site.RoleEnum.SiteManager:this.displayText$.next("LIBRARY.ROLE.MANAGER");break;case f.Site.RoleEnum.SiteCollaborator:this.displayText$.next("LIBRARY.ROLE.COLLABORATOR");break;case f.Site.RoleEnum.SiteContributor:this.displayText$.next("LIBRARY.ROLE.CONTRIBUTOR");break;case f.Site.RoleEnum.SiteConsumer:this.displayText$.next("LIBRARY.ROLE.CONSUMER");break;default:this.displayText$.next("")}},Je.prototype.ngOnDestroy=function(){this.onDestroy$.next(!0),this.onDestroy$.complete()},Je.decorators=[{type:y.Component,args:[{selector:"adf-library-role-column",template:'\n        <span class="adf-datatable-cell-value" title="{{ (displayText$ | async) | translate }}">\n            {{ (displayText$ | async) | translate }}\n        </span>\n    ',changeDetection:y.ChangeDetectionStrategy.OnPush,encapsulation:y.ViewEncapsulation.None,host:{"class":"adf-library-role-column adf-datatable-content-cell"}}]}],Je.ctorParameters=function(){return[{type:b.AlfrescoApiService}]},Je.propDecorators={context:[{type:y.Input}]},Je);function Je(e){this.api=e,this.displayText$=new u.BehaviorSubject(""),this.onDestroy$=new u.Subject}var et=(tt.prototype.ngOnInit=function(){var i=this;this.updateValue(),this.api.nodeUpdated.pipe(m.takeUntil(this.onDestroy$)).subscribe(function(e){var t=i.context.row;if(t){var n=t.node.entry;n===e&&(t.node={entry:n},i.updateValue())}})},tt.prototype.updateValue=function(){var e=this.context.row.node;if(e&&e.entry)switch(e.entry.visibility){case f.Site.VisibilityEnum.PUBLIC:this.displayText$.next("LIBRARY.VISIBILITY.PUBLIC");break;case f.Site.VisibilityEnum.PRIVATE:this.displayText$.next("LIBRARY.VISIBILITY.PRIVATE");break;case f.Site.VisibilityEnum.MODERATED:this.displayText$.next("LIBRARY.VISIBILITY.MODERATED");break;default:this.displayText$.next("UNKNOWN")}},tt.prototype.ngOnDestroy=function(){this.onDestroy$.next(!0),this.onDestroy$.complete()},tt.decorators=[{type:y.Component,args:[{selector:"adf-library-status-column",template:'\n        <span class="adf-datatable-cell-value" title="{{ (displayText$ | async) | translate }}">\n            {{ (displayText$ | async) | translate }}\n        </span>\n    ',host:{"class":"adf-library-status-column adf-datatable-content-cell"}}]}],tt.ctorParameters=function(){return[{type:b.AlfrescoApiService}]},tt.propDecorators={context:[{type:y.Input}]},tt);function tt(e){this.api=e,this.displayText$=new u.BehaviorSubject(""),this.onDestroy$=new u.Subject}var nt=(it.prototype.ngOnInit=function(){var i=this;this.updateValue(),this.alfrescoApiService.nodeUpdated.pipe(m.takeUntil(this.onDestroy$)).subscribe(function(e){var t=i.context.row;if(t){var n=t.node.entry;n===e&&(t.node={entry:n},i.updateValue())}})},it.prototype.updateValue=function(){this.node=this.context.row.node,this.node&&this.node.entry&&this.displayText$.next(this.node.entry.name||this.node.entry.id)},it.prototype.onClick=function(){this.element.nativeElement.dispatchEvent(new CustomEvent("name-click",{bubbles:!0,detail:{node:this.node}}))},it.prototype.ngOnDestroy=function(){this.onDestroy$.next(!0),this.onDestroy$.complete()},it.decorators=[{type:y.Component,args:[{selector:"adf-name-column",template:'\n        <span class="adf-datatable-cell-value" title="{{ node | adfNodeNameTooltip }}" (click)="onClick()">\n            {{ displayText$ | async }}\n        </span>\n    ',changeDetection:y.ChangeDetectionStrategy.OnPush,encapsulation:y.ViewEncapsulation.None,host:{"class":"adf-datatable-content-cell adf-datatable-link adf-name-column"}}]}],it.ctorParameters=function(){return[{type:y.ElementRef},{type:b.AlfrescoApiService}]},it.propDecorators={context:[{type:y.Input}]},it);function it(e,t){this.element=e,this.alfrescoApiService=t,this.displayText$=new u.BehaviorSubject(""),this.onDestroy$=new u.Subject}var ot=(rt.prototype.ngOnInit=function(){this.node=this.context.row.node;var e=this.context.data.rows||[];if(this.node&&this.node.entry)if(this.isLibrary="st:site"===this.node.entry.nodeType,this.isLibrary){var t=this.node.entry.properties;this.displayText=this.makeLibraryTitle(this.node.entry,e),this.displayTooltip=t["cm:description"]||t["cm:title"]}else this.displayText=this.node.entry.name||this.node.entry.id},rt.prototype.makeLibraryTitle=function(e,t){var n=t.map(function(e){return e.node.entry}),i=e.id,o=e.properties["cm:title"],r=!1;return n&&(r=n.some(function(e){return e.id!==i&&e.properties["cm:title"]===o})),r?e.properties["cm:title"]+" ("+e.name+")":""+e.properties["cm:title"]},rt.decorators=[{type:y.Component,args:[{selector:"adf-trashcan-name-column",template:'\n    <ng-container *ngIf="!isLibrary">\n      <span class="adf-datatable-cell-value" title="{{ node | adfNodeNameTooltip }}">{{ displayText }}</span>\n    </ng-container>\n    <ng-container *ngIf="isLibrary">\n      <span class="adf-datatable-cell-value" title="{{ displayTooltip }}">{{ displayText }}</span>\n    </ng-container>\n  ',changeDetection:y.ChangeDetectionStrategy.OnPush,encapsulation:y.ViewEncapsulation.None,host:{"class":"adf-datatable-content-cell adf-trashcan-name-column"}}]}],rt.propDecorators={context:[{type:y.Input}]},rt);
/*!
     * @license
     * Copyright 2019 Alfresco Software, Ltd.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *     http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function rt(){this.isLibrary=!1}function at(){}function st(){}function lt(){}function ct(){}function dt(){this.properties={}}function pt(){}function ut(){}function ht(){}function ft(){}function mt(e,t,n,i){void 0===n&&(n=!0),void 0===i&&(i=!0),this.isFolder=!0,this.isFile=!0,this.css=e,this.permission=t,this.isFile=n,this.isFolder=i}var gt=(Object.defineProperty(yt.prototype,"isPositionRight",{get:function(){return"ltr"===this.direction&&"right"===this.position||"rtl"===this.direction&&"left"===this.position||null},enumerable:!0,configurable:!0}),Object.defineProperty(yt.prototype,"isPositionLeft",{get:function(){return"ltr"===this.direction&&"left"===this.position||"rtl"===this.direction&&"right"===this.position||null},enumerable:!0,configurable:!0}),yt.prototype.ngOnInit=function(){var n=this;this.listSubscription=this.uploadService.queueChanged.pipe(m.takeUntil(this.onDestroy$)).subscribe(function(e){n.filesUploadingList=e,n.filesUploadingList.length&&(n.isDialogActive=!0)}),this.counterSubscription=u.merge(this.uploadService.fileUploadComplete,this.uploadService.fileUploadDeleted).pipe(m.takeUntil(this.onDestroy$)).subscribe(function(e){n.totalCompleted=e.totalComplete,n.changeDetector.detectChanges()}),this.errorSubscription=this.uploadService.fileUploadError.pipe(m.takeUntil(this.onDestroy$)).subscribe(function(e){n.totalErrors=e.totalError,n.changeDetector.detectChanges()}),this.fileUploadSubscription=this.uploadService.fileUpload.pipe(m.takeUntil(this.onDestroy$)).subscribe(function(){n.changeDetector.detectChanges()}),this.uploadService.fileDeleted.pipe(m.takeUntil(this.onDestroy$)).subscribe(function(t){if(n.filesUploadingList){var e=n.filesUploadingList.find(function(e){return e.data.entry.id===t});e&&(e.status=b.FileUploadStatus.Cancelled,n.changeDetector.detectChanges())}}),this.userPreferencesService.select("textOrientation").pipe(m.takeUntil(this.onDestroy$)).subscribe(function(e){n.direction=e})},yt.prototype.toggleConfirmation=function(){this.isConfirmation=!this.isConfirmation,this.isDialogMinimized&&(this.isDialogMinimized=!1)},yt.prototype.cancelAllUploads=function(){this.toggleConfirmation(),this.uploadList.cancelAllFiles()},yt.prototype.toggleMinimized=function(){this.isDialogMinimized=!this.isDialogMinimized,this.changeDetector.detectChanges()},yt.prototype.close=function(){this.isConfirmation=!1,this.totalCompleted=0,this.totalErrors=0,this.filesUploadingList=[],this.isDialogActive=!1,this.isDialogMinimized=!1,this.uploadService.clearQueue(),this.changeDetector.detectChanges()},yt.prototype.ngOnDestroy=function(){this.uploadService.clearQueue(),this.listSubscription.unsubscribe(),this.counterSubscription.unsubscribe(),this.fileUploadSubscription.unsubscribe(),this.errorSubscription.unsubscribe(),this.onDestroy$.next(!0),this.onDestroy$.complete()},yt.decorators=[{type:y.Component,args:[{selector:"adf-file-uploading-dialog",template:'<div *ngIf="isDialogActive"\n     class="adf-upload-dialog"\n     id="upload-dialog"\n     [class.adf-upload-dialog--minimized]="isDialogMinimized">\n    <header class="adf-upload-dialog__header">\n        <button\n            mat-button\n            color="secondary"\n            [disabled]="isConfirmation"\n            (click)="toggleMinimized()">\n            <mat-icon\n                mat-list-icon\n                title="{{ (isDialogMinimized ? \'ADF_FILE_UPLOAD.BUTTON.MAXIMIZE\': \'ADF_FILE_UPLOAD.BUTTON.MINIMIZE\') | translate }}">\n                    {{ isDialogMinimized ? \'keyboard_arrow_up\' : \'keyboard_arrow_down\' }}\n            </mat-icon>\n        </button>\n\n        <span\n            class="adf-upload-dialog__title"\n            *ngIf="!uploadList.isUploadCancelled()">\n            {{ \'FILE_UPLOAD.MESSAGES.UPLOAD_PROGRESS\'\n                | translate: {\n                    completed: totalCompleted,\n                    total: filesUploadingList.length\n                }\n            }}\n        </span>\n\n        <span\n            class="adf-upload-dialog__title"\n            *ngIf="uploadList.isUploadCancelled()">\n            {{ \'FILE_UPLOAD.MESSAGES.UPLOAD_CANCELED\' | translate }}\n        </span>\n    </header>\n\n    <section class="adf-upload-dialog__info"\n        *ngIf="totalErrors">\n        {{\n            (totalErrors > 1\n                 ? \'FILE_UPLOAD.MESSAGES.UPLOAD_ERRORS\'\n                 : \'FILE_UPLOAD.MESSAGES.UPLOAD_ERROR\')\n                 | translate: { total: totalErrors }\n        }}\n    </section>\n\n    <section class="adf-upload-dialog__content"\n        [class.adf-upload-dialog--padding]="isConfirmation">\n        <adf-file-uploading-list\n            [class.adf-upload-dialog--hide]="isConfirmation"\n            #uploadList\n            [files]="filesUploadingList">\n                <ng-template let-file="$implicit">\n                     <adf-file-uploading-list-row\n                        [file]="file"\n                        (remove)="uploadList.removeFile(file)"\n                        (cancel)="uploadList.cancelFile(file)">\n                    </adf-file-uploading-list-row>\n                </ng-template>\n        </adf-file-uploading-list>\n\n        <div\n            class="adf-upload-dialog__confirmation"\n            [class.adf-upload-dialog--hide]="!isConfirmation">\n                <p class="adf-upload-dialog__confirmation--title">\n                    {{ \'ADF_FILE_UPLOAD.CONFIRMATION.MESSAGE.TITLE\' | translate }}\n                </p>\n\n                <p class="adf-upload-dialog__confirmation--text">\n                    {{ \'ADF_FILE_UPLOAD.CONFIRMATION.MESSAGE.TEXT\' | translate }}\n                </p>\n        </div>\n    </section>\n\n    <footer class="adf-upload-dialog__actions"\n            *ngIf="!isConfirmation">\n        <button\n            id="adf-upload-dialog-cancel-all"\n            color="primary"\n            mat-button\n            *ngIf="!uploadList.isUploadCompleted() && !uploadList.isUploadCancelled()"\n            (click)="toggleConfirmation()">\n            {{ \'ADF_FILE_UPLOAD.BUTTON.CANCEL_ALL\' | translate }}\n        </button>\n\n        <button\n            id="adf-upload-dialog-close"\n            *ngIf="uploadList.isUploadCompleted() || uploadList.isUploadCancelled()"\n            mat-button\n            color="primary"\n            (click)="close()">\n            {{ \'ADF_FILE_UPLOAD.BUTTON.CLOSE\' | translate }}\n        </button>\n    </footer>\n\n    <footer class="adf-upload-dialog__actions"\n            *ngIf="isConfirmation">\n        <button\n            id="adf-upload-dialog-cancel"\n            color="secondary"\n            mat-button\n            (click)="cancelAllUploads()">\n            {{ \'ADF_FILE_UPLOAD.CONFIRMATION.BUTTON.CANCEL\' | translate }}\n        </button>\n\n        <button\n            id="adf-upload-dialog-confirm"\n            mat-button\n            color="primary"\n            (click)="toggleConfirmation()">\n            {{ \'ADF_FILE_UPLOAD.CONFIRMATION.BUTTON.CONTINUE\' | translate }}\n        </button>\n    </footer>\n</div>\n',styles:[""]}]}],yt.ctorParameters=function(){return[{type:b.UploadService},{type:y.ChangeDetectorRef},{type:b.UserPreferencesService}]},yt.propDecorators={uploadList:[{type:y.ViewChild,args:["uploadList"]}],position:[{type:y.Input}],error:[{type:y.Output}],isPositionRight:[{type:y.HostBinding,args:["attr.adfUploadDialogRight"]}],isPositionLeft:[{type:y.HostBinding,args:["attr.adfUploadDialogLeft"]}]},yt);function yt(e,t,n){this.uploadService=e,this.changeDetector=t,this.userPreferencesService=n,this.direction="ltr",this.onDestroy$=new u.Subject,this.position="right",this.error=new y.EventEmitter,this.filesUploadingList=[],this.isDialogActive=!1,this.totalCompleted=0,this.totalErrors=0,this.isDialogMinimized=!1,this.isConfirmation=!1}var vt=(bt.prototype.onCancel=function(e){this.cancel.emit(e)},bt.prototype.onRemove=function(e){this.remove.emit(e)},bt.prototype.showCancelledStatus=function(){return this.file.status===b.FileUploadStatus.Cancelled||this.file.status===b.FileUploadStatus.Aborted||this.file.status===b.FileUploadStatus.Deleted},Object.defineProperty(bt.prototype,"versionNumber",{get:function(){return this.file.data.entry.properties["cm:versionLabel"]},enumerable:!0,configurable:!0}),Object.defineProperty(bt.prototype,"mimeType",{get:function(){return this.file&&this.file.file&&this.file.file.type?this.file.file.type:"default"},enumerable:!0,configurable:!0}),bt.prototype.isUploadVersion=function(){return!!this.file.data&&this.file.options&&this.file.options.newVersion&&this.file.data.entry.properties&&this.file.data.entry.properties["cm:versionLabel"]},bt.decorators=[{type:y.Component,args:[{selector:"adf-file-uploading-list-row",template:'<div class="adf-file-uploading-row">\n    <mat-icon *ngIf="mimeType === \'default\'" mat-list-icon class="adf-file-uploading-row__type">\n        insert_drive_file\n    </mat-icon>\n\n    <adf-icon *ngIf="mimeType !== \'default\'" value="adf:{{ mimeType }}"></adf-icon>\n\n    <span\n        class="adf-file-uploading-row__name"\n        title="{{ file.name }}">\n        {{ file.name }}\n    </span>\n\n    <span *ngIf="isUploadVersion()" class="adf-file-uploading-row__version">\n        <mat-chip color="primary" [attr.aria-label]="\'ADF_FILE_UPLOAD.ARIA-LABEL.VERSION\' | translate" [title]="\'version\' + versionNumber" disabled>{{\n            versionNumber\n        }}</mat-chip>\n    </span>\n\n    <div\n        *ngIf="file.status === FileUploadStatus.Progress || file.status === FileUploadStatus.Starting"\n        (click)="onCancel(file)"\n        class="adf-file-uploading-row__group adf-file-uploading-row__group--toggle"\n        title="{{ \'ADF_FILE_UPLOAD.BUTTON.CANCEL_FILE\' | translate }}">\n        <span class="adf-file-uploading-row__status">\n            {{ file.progress.loaded | adfFileSize }} / {{ file.progress.total | adfFileSize }}\n        </span>\n\n        <mat-icon\n            mat-list-icon\n            class="adf-file-uploading-row__action adf-file-uploading-row__action--cancel">\n            clear\n        </mat-icon>\n    </div>\n\n    <div\n        *ngIf="file.status === FileUploadStatus.Complete && !isUploadVersion()"\n        (click)="onRemove(file)"\n        class="adf-file-uploading-row__group adf-file-uploading-row__group--toggle"\n        title="{{ \'ADF_FILE_UPLOAD.BUTTON.REMOVE_FILE\' | translate }}">\n        <mat-icon\n            mat-list-icon\n            class="adf-file-uploading-row__status adf-file-uploading-row__status--done">\n            check_circle\n        </mat-icon>\n\n        <mat-icon\n            mat-list-icon\n            class="adf-file-uploading-row__action adf-file-uploading-row__action--remove">\n            remove_circle\n        </mat-icon>\n    </div>\n\n    <div\n        *ngIf="file.status === FileUploadStatus.Complete && isUploadVersion()"\n        class="adf-file-uploading-row__file-version">\n        <mat-icon\n            mat-list-icon\n            class="adf-file-uploading-row__status--done">\n            check_circle\n        </mat-icon>\n    </div>\n\n    <div\n        *ngIf="file.status === FileUploadStatus.Pending"\n        (click)="onCancel(file)"\n        class="adf-file-uploading-row__group adf-file-uploading-row__group--toggle">\n        <mat-icon\n            mat-list-icon\n            class="adf-file-uploading-row__status adf-file-uploading-row__status--pending">\n            schedule\n        </mat-icon>\n\n        <mat-icon\n            mat-list-icon\n            class="adf-file-uploading-row__action adf-file-uploading-row__action--remove">\n            remove_circle\n        </mat-icon>\n    </div>\n\n    <div\n        *ngIf="file.status === FileUploadStatus.Error"\n        class="adf-file-uploading-row__block adf-file-uploading-row__status--error">\n        <mat-icon mat-list-icon\n            [attr.aria-label]="\'ADF_FILE_UPLOAD.ARIA-LABEL.ERROR\' | translate"\n            [matTooltip]="file.errorCode | adfFileUploadError">\n            report_problem\n        </mat-icon>\n    </div>\n\n    <div\n        *ngIf="showCancelledStatus()"\n        class="adf-file-uploading-row__block adf-file-uploading-row__status--cancelled">\n        {{ \'ADF_FILE_UPLOAD.STATUS.FILE_CANCELED_STATUS\' | translate }}\n    </div>\n</div>\n',styles:[""]}]}],bt.propDecorators={file:[{type:y.Input}],cancel:[{type:y.Output}],remove:[{type:y.Output}]},bt);function bt(){this.cancel=new y.EventEmitter,this.remove=new y.EventEmitter,this.FileUploadStatus=b.FileUploadStatus}var St=(It.prototype.cancelFile=function(e){this.uploadService.cancelUpload(e)},It.prototype.removeFile=function(e){var t=this;this.deleteNode(e).subscribe(function(){e.status===b.FileUploadStatus.Error&&t.notifyError(e),t.cancelNodeVersionInstances(e),t.uploadService.cancelUpload(e)})},It.prototype.cancelAllFiles=function(){var i=this;this.getUploadingFiles().forEach(function(e){return i.uploadService.cancelUpload(e)});var e=this.files.filter(function(e){return e.status===b.FileUploadStatus.Complete}).map(function(e){return i.deleteNode(e)});u.forkJoin.apply(void 0,N(e)).subscribe(function(e){var t,n=e.filter(function(e){return e.status===b.FileUploadStatus.Error});n.length&&i.notifyError.apply(i,N(n)),(t=i.uploadService).cancelUpload.apply(t,N(e))})},It.prototype.isUploadCompleted=function(){return!this.isUploadCancelled()&&Boolean(this.files.length)&&!this.files.some(function(e){var t=e.status;return t===b.FileUploadStatus.Starting||t===b.FileUploadStatus.Progress||t===b.FileUploadStatus.Pending})},It.prototype.isUploadCancelled=function(){return!!this.files.length&&this.files.every(function(e){var t=e.status;return t===b.FileUploadStatus.Aborted||t===b.FileUploadStatus.Cancelled||t===b.FileUploadStatus.Deleted})},It.prototype.deleteNode=function(e){var t=e.data.entry.id;return this.nodesApi.deleteNode(t,{permanent:!0}).pipe(m.map(function(){return e.status=b.FileUploadStatus.Deleted,e}),m.catchError(function(){return e.status=b.FileUploadStatus.Error,u.of(e)}))},It.prototype.cancelNodeVersionInstances=function(t){this.files.filter(function(e){return e.data.entry.id===t.data.entry.id&&e.options.newVersion}).map(function(e){e.status=b.FileUploadStatus.Deleted})},It.prototype.notifyError=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=null;n=1===e.length?this.translateService.instant("FILE_UPLOAD.MESSAGES.REMOVE_FILE_ERROR",{fileName:e[0].name}):this.translateService.instant("FILE_UPLOAD.MESSAGES.REMOVE_FILES_ERROR",{total:e.length}),this.error.emit(n)},It.prototype.getUploadingFiles=function(){return this.files.filter(function(e){if(e.status===b.FileUploadStatus.Pending||e.status===b.FileUploadStatus.Progress||e.status===b.FileUploadStatus.Starting)return e})},It.decorators=[{type:y.Component,args:[{selector:"adf-file-uploading-list",template:'<div class="upload-list">\n    <ng-template\n        ngFor\n        [ngForOf]="files"\n        [ngForTemplate]="template">\n    </ng-template>\n</div>\n',styles:[":host{display:flex;flex-direction:column}"]}]}],It.ctorParameters=function(){return[{type:b.UploadService},{type:b.NodesApiService},{type:b.TranslationService}]},It.propDecorators={template:[{type:y.ContentChild,args:[y.TemplateRef]}],files:[{type:y.Input}],error:[{type:y.Output}]},It);
/*!
     * @license
     * Copyright 2019 Alfresco Software, Ltd.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *     http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function It(e,t,n){this.uploadService=e,this.nodesApi=t,this.translateService=n,this.FileUploadStatus=b.FileUploadStatus,this.files=[],this.error=new y.EventEmitter}var Et=(Object.defineProperty(At.prototype,"defaultPrevented",{get:function(){return this.isDefaultPrevented},enumerable:!0,configurable:!0}),At.prototype.preventDefault=function(){this.isDefaultPrevented=!0},At.prototype.pauseUpload=function(){this.preventDefault()},At.prototype.resumeUpload=function(){var e;this.files&&0<this.files.length&&((e=this.uploadService).addToQueue.apply(e,N(this.files)),this.uploadService.uploadFilesInTheQueue(this.callback))},At);function At(e,t,n){this.files=e,this.uploadService=t,this.callback=n,this.isDefaultPrevented=!1}var Ct=(Tt.prototype.ngOnInit=function(){var t=this;this.uploadService.fileUploadError.pipe(m.takeUntil(this.onDestroy$)).subscribe(function(e){return t.error.emit(e)})},Tt.prototype.ngOnDestroy=function(){this.onDestroy$.next(!0),this.onDestroy$.complete()},Tt.prototype.uploadFiles=function(e){var t=this,n=e.map(function(e){return t.createFileModel(e,t.rootFolderId,(e.webkitRelativePath||"").replace(/\/[^\/]*$/,""))});this.uploadQueue(n)},Tt.prototype.uploadFilesInfo=function(e){var t=this,n=e.map(function(e){return t.createFileModel(e.file,t.rootFolderId,e.relativeFolder)});this.uploadQueue(n)},Tt.prototype.uploadQueue=function(e){var n=this,i=e.filter(this.isFileAcceptable.bind(this)).filter(this.isFileSizeAcceptable.bind(this));this.ngZone.run(function(){var e,t=new Et(N(i),n.uploadService,n.success);n.beginUpload.emit(t),t.defaultPrevented||0<i.length&&((e=n.uploadService).addToQueue.apply(e,N(i)),n.uploadService.uploadFilesInTheQueue(n.success))})},Tt.prototype.isFileAcceptable=function(e){return"*"===this.acceptedFilesType||-1!==this.acceptedFilesType.split(",").map(function(e){return e.trim().replace(/^\./,"")}).indexOf(e.extension)},Tt.prototype.createFileModel=function(e,t,n,i){return new b.FileModel(e,{comment:this.comment,majorVersion:this.majorVersion,newVersion:this.versioning,parentId:t,path:n,nodeType:this.nodeType},i)},Tt.prototype.isFileSizeAllowed=function(e){var t=!0;return this.isMaxFileSizeDefined()&&(t=this.isFileSizeCorrect(e)),t},Tt.prototype.isMaxFileSizeDefined=function(){return this.maxFilesSize!==undefined&&null!==this.maxFilesSize},Tt.prototype.isFileSizeCorrect=function(e){return 0<=this.maxFilesSize&&e.size<=this.maxFilesSize},Tt.prototype.isFileSizeAcceptable=function(e){var t=!0;if(!this.isFileSizeAllowed(e)){t=!1;var n=this.translationService.instant("FILE_UPLOAD.MESSAGES.EXCEED_MAX_FILE_SIZE",{fileName:e.name});this.error.emit(n)}return t},Tt.propDecorators={maxFilesSize:[{type:y.Input}],rootFolderId:[{type:y.Input}],disabled:[{type:y.Input}],acceptedFilesType:[{type:y.Input}],versioning:[{type:y.Input}],majorVersion:[{type:y.Input}],comment:[{type:y.Input}],nodeType:[{type:y.Input}],success:[{type:y.Output}],error:[{type:y.Output}],beginUpload:[{type:y.Output}]},Tt);function Tt(e,t,n){this.uploadService=e,this.translationService=t,this.ngZone=n,this.rootFolderId="-root-",this.disabled=!1,this.acceptedFilesType="*",this.versioning=!1,this.majorVersion=!1,this.nodeType="cm:content",this.success=new y.EventEmitter,this.error=new y.EventEmitter,this.beginUpload=new y.EventEmitter,this.onDestroy$=new u.Subject}var Ot,Dt=(C(wt,Ot=Ct),wt.prototype.ngOnInit=function(){var t=this;this.permissionValue.subscribe(function(e){t.hasAllowableOperations=e})},wt.prototype.ngOnChanges=function(e){var t=e.rootFolderId;t&&t.currentValue&&this.checkPermission()},wt.prototype.isButtonDisabled=function(){return!!this.disabled||undefined},wt.prototype.onFilesAdded=function(e){var t=b.FileUtils.toFileArray(e.currentTarget.files);this.hasAllowableOperations?this.uploadFiles(t):this.permissionEvent.emit(new Be({type:"content",action:"upload",permission:"create"})),e.target.value=""},wt.prototype.onDirectoryAdded=function(e){if(this.hasAllowableOperations){var t=b.FileUtils.toFileArray(e.currentTarget.files);this.uploadFiles(t)}else this.permissionEvent.emit(new Be({type:"content",action:"upload",permission:"create"}));e.target.value=""},wt.prototype.checkPermission=function(){var t=this;this.rootFolderId&&this.contentService.getNode(this.rootFolderId,{includeSource:!0,include:["allowableOperations"]}).subscribe(function(e){return t.permissionValue.next(t.nodeHasPermission(e.entry,b.AllowableOperationsEnum.CREATE))},function(e){return t.error.emit(e)})},wt.prototype.nodeHasPermission=function(e,t){return this.contentService.hasAllowableOperations(e,t)},wt.decorators=[{type:y.Component,args:[{selector:"adf-upload-button",template:'<form class="adf-upload-button-file-container">\n    \x3c!--Files Upload--\x3e\n    <div *ngIf="!uploadFolders">\n\n        \x3c!--Single Files Upload--\x3e\n        <button *ngIf="!multipleFiles"\n            [disabled]="isButtonDisabled()"\n            mat-raised-button color="primary"\n            (click)="uploadSingleFile.click()">\n            <mat-icon>file_upload</mat-icon>\n            <span id="upload-single-file-label"\n                *ngIf="!staticTitle">{{ \'FILE_UPLOAD.BUTTON.UPLOAD_FILE\' | translate }}</span>\n            <span id="upload-single-file-label-static"\n                *ngIf="staticTitle">{{ staticTitle }}</span>\n            <input #uploadSingleFile\n                id="upload-single-file"\n                data-automation-id="upload-single-file"\n                type="file"\n                name="uploadFiles"\n                accept="{{acceptedFilesType}}"\n                [attr.disabled]="isButtonDisabled()"\n                [title]="tooltip"\n                (change)="onFilesAdded($event)">\n        </button>\n\n        \x3c!--Multiple Files Upload--\x3e\n        <button *ngIf="multipleFiles"\n            [disabled]="isButtonDisabled()"\n            mat-raised-button color="primary"\n            (click)="uploadMultipleFiles.click()">\n            <mat-icon>file_upload</mat-icon>\n\n            <span id="upload-multiple-file-label"\n                *ngIf="!staticTitle">{{ \'FILE_UPLOAD.BUTTON.UPLOAD_FILE\' | translate }}</span>\n            <span\n                id="upload-multiple-file-label-static"\n                *ngIf="staticTitle">{{ staticTitle }}</span>\n            <input #uploadMultipleFiles\n                id="upload-multiple-files"\n                data-automation-id="upload-multiple-files"\n                type="file"\n                name="uploadFiles"\n                multiple="multiple"\n                accept="{{acceptedFilesType}}"\n                [attr.disabled]="isButtonDisabled()"\n                [title]="tooltip"\n                (change)="onFilesAdded($event)">\n        </button>\n    </div>\n\n    \x3c!--Folders Upload--\x3e\n    <div *ngIf="uploadFolders">\n        <button\n            [disabled]="isButtonDisabled()"\n            mat-raised-button color="primary"\n            (click)="uploadFolders.click()">\n            <mat-icon>file_upload</mat-icon>\n            <span id="uploadFolder-label"\n                *ngIf="!staticTitle">{{ \'FILE_UPLOAD.BUTTON.UPLOAD_FOLDER\' | translate }}</span>\n            <span id="uploadFolder-label-static"\n                *ngIf="staticTitle">{{ staticTitle }}</span>\n            <input #uploadFolders\n                id="uploadFolder"\n                data-automation-id="uploadFolder"\n                type="file"\n                name="uploadFiles"\n                multiple="multiple"\n                accept="{{acceptedFilesType}}"\n                webkitdirectory directory\n                [attr.disabled]="isButtonDisabled()"\n                [title]="tooltip"\n                (change)="onDirectoryAdded($event)">\n        </button>\n    </div>\n</form>\n',viewProviders:[{provide:b.EXTENDIBLE_COMPONENT,useExisting:y.forwardRef(function(){return wt})}],encapsulation:y.ViewEncapsulation.None,styles:[".adf-upload-button-file-container input{display:none}"]}]}],wt.ctorParameters=function(){return[{type:b.UploadService},{type:b.ContentService},{type:b.TranslationService},{type:b.LogService},{type:y.NgZone}]},wt.propDecorators={uploadFolders:[{type:y.Input}],multipleFiles:[{type:y.Input}],staticTitle:[{type:y.Input}],tooltip:[{type:y.Input}],permissionEvent:[{type:y.Output}]},wt);function wt(e,t,n,i,o){var r=Ot.call(this,e,n,o)||this;return r.uploadService=e,r.contentService=t,r.translationService=n,r.logService=i,r.ngZone=o,r.uploadFolders=!1,r.multipleFiles=!1,r.tooltip=null,r.permissionEvent=new y.EventEmitter,r.hasAllowableOperations=!1,r.permissionValue=new u.Subject,r}var Lt,Nt=(C(Ft,Lt=Dt),Ft.prototype.createFileModel=function(e){var t=Lt.prototype.createFileModel.call(this,e,this.rootFolderId,(e.webkitRelativePath||"").replace(/\/[^\/]*$/,""),this.node.id);if(!this.isFileAcceptable(t)){var n=this.translationService.instant("FILE_UPLOAD.VERSION.MESSAGES.INCOMPATIBLE_VERSION");this.error.emit(n)}return t},Ft.prototype.ngOnInit=function(){Lt.prototype.ngOnInit.call(this),this.checkPermission()},Ft.prototype.checkPermission=function(){this.permissionValue.next(this.nodeHasPermission(this.node,b.AllowableOperationsEnum.UPDATE))},Ft.decorators=[{type:y.Component,args:[{selector:"adf-upload-version-button",template:'<form class="adf-upload-button-file-container">\n    \x3c!--Files Upload--\x3e\n    <div *ngIf="!uploadFolders">\n\n        \x3c!--Single Files Upload--\x3e\n        <button *ngIf="!multipleFiles"\n            [disabled]="isButtonDisabled()"\n            mat-raised-button color="primary"\n            (click)="uploadSingleFile.click()">\n            <mat-icon>file_upload</mat-icon>\n            <span id="upload-single-file-label"\n                *ngIf="!staticTitle">{{ \'FILE_UPLOAD.BUTTON.UPLOAD_FILE\' | translate }}</span>\n            <span id="upload-single-file-label-static"\n                *ngIf="staticTitle">{{ staticTitle }}</span>\n            <input #uploadSingleFile\n                id="upload-single-file"\n                data-automation-id="upload-single-file"\n                type="file"\n                name="uploadFiles"\n                accept="{{acceptedFilesType}}"\n                [attr.disabled]="isButtonDisabled()"\n                [title]="tooltip"\n                (change)="onFilesAdded($event)">\n        </button>\n\n        \x3c!--Multiple Files Upload--\x3e\n        <button *ngIf="multipleFiles"\n            [disabled]="isButtonDisabled()"\n            mat-raised-button color="primary"\n            (click)="uploadMultipleFiles.click()">\n            <mat-icon>file_upload</mat-icon>\n\n            <span id="upload-multiple-file-label"\n                *ngIf="!staticTitle">{{ \'FILE_UPLOAD.BUTTON.UPLOAD_FILE\' | translate }}</span>\n            <span\n                id="upload-multiple-file-label-static"\n                *ngIf="staticTitle">{{ staticTitle }}</span>\n            <input #uploadMultipleFiles\n                id="upload-multiple-files"\n                data-automation-id="upload-multiple-files"\n                type="file"\n                name="uploadFiles"\n                multiple="multiple"\n                accept="{{acceptedFilesType}}"\n                [attr.disabled]="isButtonDisabled()"\n                [title]="tooltip"\n                (change)="onFilesAdded($event)">\n        </button>\n    </div>\n\n    \x3c!--Folders Upload--\x3e\n    <div *ngIf="uploadFolders">\n        <button\n            [disabled]="isButtonDisabled()"\n            mat-raised-button color="primary"\n            (click)="uploadFolders.click()">\n            <mat-icon>file_upload</mat-icon>\n            <span id="uploadFolder-label"\n                *ngIf="!staticTitle">{{ \'FILE_UPLOAD.BUTTON.UPLOAD_FOLDER\' | translate }}</span>\n            <span id="uploadFolder-label-static"\n                *ngIf="staticTitle">{{ staticTitle }}</span>\n            <input #uploadFolders\n                id="uploadFolder"\n                data-automation-id="uploadFolder"\n                type="file"\n                name="uploadFiles"\n                multiple="multiple"\n                accept="{{acceptedFilesType}}"\n                webkitdirectory directory\n                [attr.disabled]="isButtonDisabled()"\n                [title]="tooltip"\n                (change)="onDirectoryAdded($event)">\n        </button>\n    </div>\n</form>\n',viewProviders:[{provide:b.EXTENDIBLE_COMPONENT,useExisting:y.forwardRef(function(){return Ft})}],encapsulation:y.ViewEncapsulation.None,styles:[".adf-upload-button-file-container input{display:none}"]}]}],Ft.propDecorators={node:[{type:y.Input}]},Ft);function Ft(){return null!==Lt&&Lt.apply(this,arguments)||this}var Rt,kt=(C(xt,Rt=Ct),xt.prototype.onFilesDropped=function(e){!this.disabled&&e.length&&this.uploadFiles(e)},xt.prototype.onFolderEntityDropped=function(e){var t=this;!this.disabled&&e.isDirectory&&b.FileUtils.flatten(e).then(function(e){t.uploadFilesInfo(e)})},xt.prototype.showUndoNotificationBar=function(t){var e,n,i=this;e=this.translationService.get("FILE_UPLOAD.MESSAGES.PROGRESS"),n=this.translationService.get("FILE_UPLOAD.ACTION.UNDO"),this.notificationService.openSnackMessageAction(e.value,n.value,3e3).onAction().subscribe(function(){var e;(e=i.uploadService).cancelUpload.apply(e,N(t))})},xt.prototype.isDroppable=function(){return!this.disabled},xt.prototype.onUploadFiles=function(e){if(e.stopPropagation(),e.preventDefault(),this.contentService.hasAllowableOperations(e.detail.data.obj.entry,b.AllowableOperationsEnum.CREATE)){var t=e.detail.files;if(this.isTargetNodeFolder(e)){var n=e.detail.data.obj.entry.name;t.map(function(e){return e.relativeFolder=n?n.concat(e.relativeFolder):e.relativeFolder})}t&&0<t.length&&this.uploadFilesInfo(t)}},xt.prototype.isTargetNodeFolder=function(e){return e.detail.data.obj&&e.detail.data.obj.entry.isFolder},xt.decorators=[{type:y.Component,args:[{selector:"adf-upload-drag-area",template:'<div [adf-file-draggable]="isDroppable()" class="adf-upload-border"\n     (filesDropped)="onFilesDropped($event)"\n     (folderEntityDropped)="onFolderEntityDropped($event)"\n     (upload-files)="onUploadFiles($event)"\n     dropzone="" webkitdropzone="*" #droparea>\n    <ng-content></ng-content>\n</div>\n',host:{"class":"adf-upload-drag-area"},viewProviders:[{provide:b.EXTENDIBLE_COMPONENT,useExisting:y.forwardRef(function(){return xt})}],encapsulation:y.ViewEncapsulation.None,styles:[""]}]}],xt.ctorParameters=function(){return[{type:b.UploadService},{type:b.TranslationService},{type:b.NotificationService},{type:b.ContentService},{type:y.NgZone}]},xt);function xt(e,t,n,i,o){var r=Rt.call(this,e,t,o)||this;return r.uploadService=e,r.translationService=t,r.notificationService=n,r.contentService=i,r.ngZone=o,r}var Pt=(Mt.prototype.transform=function(e){return this.translation.instant("FILE_UPLOAD.ERRORS."+(e||"GENERIC"))},Mt.decorators=[{type:y.Pipe,args:[{name:"adfFileUploadError",pure:!0}]}],Mt.ctorParameters=function(){return[{type:b.TranslationService}]},Mt);function Mt(e){this.translation=e}var _t=(Ut.prototype.ngOnInit=function(){var e=this;this.ngZone.runOutsideAngular(function(){e.element.addEventListener("dragenter",e.onDragEnter.bind(e)),e.element.addEventListener("dragover",e.onDragOver.bind(e)),e.element.addEventListener("dragleave",e.onDragLeave.bind(e)),e.element.addEventListener("drop",e.onDropFiles.bind(e))})},Ut.prototype.ngOnDestroy=function(){this.element.removeEventListener("dragenter",this.onDragEnter),this.element.removeEventListener("dragover",this.onDragOver),this.element.removeEventListener("dragleave",this.onDragLeave),this.element.removeEventListener("drop",this.onDropFiles)},Ut.prototype.onDropFiles=function(e){if(this.enabled&&!e.defaultPrevented){this.preventDefault(e);var t=e.dataTransfer.items;if(t){for(var n=[],i=0;i<t.length;i++)if(t[i].webkitGetAsEntry){var o=t[i].webkitGetAsEntry();if(o)if(o.isFile){var r=t[i].getAsFile();r&&n.push(r)}else o.isDirectory&&this.folderEntityDropped.emit(o)}0<n.length&&this.filesDropped.emit(n)}else n=b.FileUtils.toFileArray(e.dataTransfer.files),this.filesDropped.emit(n);this.element.classList.remove(this.cssClassName)}},Ut.prototype.onDragEnter=function(e){this.enabled&&!e.defaultPrevented&&(this.preventDefault(e),this.element.classList.add(this.cssClassName))},Ut.prototype.onDragLeave=function(e){this.enabled&&!e.defaultPrevented&&(this.preventDefault(e),this.element.classList.remove(this.cssClassName))},Ut.prototype.onDragOver=function(e){this.enabled&&!e.defaultPrevented&&(this.preventDefault(e),this.element.classList.add(this.cssClassName))},Ut.prototype.preventDefault=function(e){e.stopPropagation(),e.preventDefault()},Ut.decorators=[{type:y.Directive,args:[{selector:"[adf-file-draggable]"}]}],Ut.ctorParameters=function(){return[{type:y.ElementRef},{type:y.NgZone}]},Ut.propDecorators={enabled:[{type:y.Input,args:["adf-file-draggable"]}],filesDropped:[{type:y.Output}],folderEntityDropped:[{type:y.Output}]},Ut);function Ut(e,t){this.ngZone=t,this.enabled=!0,this.filesDropped=new y.EventEmitter,this.folderEntityDropped=new y.EventEmitter,this.cssClassName="adf-file-draggable__input-focus",this.element=e.nativeElement}var Bt=(Vt.decorators=[{type:y.NgModule,args:[{imports:[b.CoreModule.forChild(),g.CommonModule,I],declarations:[_t,kt,Dt,Nt,gt,St,vt,Pt],exports:[_t,kt,Dt,Nt,gt,St,vt,Pt]}]}],Vt);function Vt(){}var jt=($t.decorators=[{type:y.NgModule,args:[{imports:[b.CoreModule.forChild(),g.CommonModule,s.FlexLayoutModule,I,Bt],declarations:[ke,_e,ot,et,Ke,Xe,nt,Pe,Qe,Ye],exports:[ke,_e,ot,et,Ke,Xe,nt,Pe,Qe,Ye],entryComponents:[ot,et,Ke,Xe,nt]}]}],$t);function $t(){}var Ht=(Object.defineProperty(Gt.prototype,"userQuery",{get:function(){return this._userQuery},set:function(e){e=(e||"").trim(),this._userQuery=e?"("+e+")":""},enumerable:!0,configurable:!0}),Gt.prototype.resetToDefaults=function(){var e=this.appConfig.get("search");e&&(this.config=JSON.parse(JSON.stringify(e)),this.categories=(this.config.categories||[]).filter(function(e){return e.enabled}),this.filterQueries=this.config.filterQueries||[],this.userFacetBuckets={},this.config.sorting&&(this.sorting=this.config.sorting.defaults||[]))},Gt.prototype.addUserFacetBucket=function(e,t){if(e&&e.field&&t){var n=this.userFacetBuckets[e.field]||[];n.find(function(e){return e.label===t.label})||n.push(t),this.userFacetBuckets[e.field]=n}},Gt.prototype.getUserFacetBuckets=function(e){return this.userFacetBuckets[e]||[]},Gt.prototype.removeUserFacetBucket=function(e,t){if(e&&e.field&&t){var n=this.userFacetBuckets[e.field]||[];this.userFacetBuckets[e.field]=n.filter(function(e){return e.label!==t.label})}},Gt.prototype.addFilterQuery=function(t){t&&(this.filterQueries.find(function(e){return e.query===t})||this.filterQueries.push({query:t}))},Gt.prototype.removeFilterQuery=function(t){t&&(this.filterQueries=this.filterQueries.filter(function(e){return e.query!==t}))},Gt.prototype.getFacetQuery=function(t){if(t&&this.hasFacetQueries){var e=this.config.facetQueries.queries.find(function(e){return e.label===t});if(e)return T({},e)}return null},Gt.prototype.getFacetField=function(t){if(t){var e=(this.config.facetFields.fields||[]).find(function(e){return e.label===t});if(e)return e.label=this.getSupportedLabel(e.label),T({},e)}return null},Gt.prototype.update=function(){var e=this.buildQuery();this.updated.next(e)},Gt.prototype.execute=function(){return O(this,void 0,void 0,function(){var t,n,i;return D(this,function(e){switch(e.label){case 0:return e.trys.push([0,3,,4]),(t=this.buildQuery())?[4,this.alfrescoApiService.searchApi.search(t)]:[3,2];case 1:n=e.sent(),this.executed.next(n),e.label=2;case 2:return[3,4];case 3:return i=e.sent(),this.error.next(i),this.executed.next({list:{pagination:{totalItems:0},entries:[]}}),[3,4];case 4:return[2]}})})},Gt.prototype.buildQuery=function(){var e=this.getFinalQuery(),t=this.config.include||[];if(0===t.length&&t.push("path","allowableOperations"),e){var n={query:{query:e,language:"afts"},include:t,paging:this.paging,fields:this.config.fields,filterQueries:this.filterQueries,facetQueries:this.facetQueries,facetIntervals:this.facetIntervals,facetFields:this.facetFields,sort:this.sort,highlight:this.highlight,facetFormat:"V2"};return n}return null},Gt.prototype.getPrimarySorting=function(){return this.sorting&&0<this.sorting.length?this.sorting[0]:null},Gt.prototype.getSortingOptions=function(){return this.config&&this.config.sorting&&this.config.sorting.options||[]},Gt.prototype.getQueryGroup=function(e){return e.group||this.config.facetQueries.label||"Facet Queries"},Object.defineProperty(Gt.prototype,"hasFacetQueries",{get:function(){return!!(this.config&&this.config.facetQueries&&this.config.facetQueries.queries&&0<this.config.facetQueries.queries.length)},enumerable:!0,configurable:!0}),Object.defineProperty(Gt.prototype,"hasFacetIntervals",{get:function(){return!!(this.config&&this.config.facetIntervals&&this.config.facetIntervals.intervals&&0<this.config.facetIntervals.intervals.length)},enumerable:!0,configurable:!0}),Object.defineProperty(Gt.prototype,"hasFacetHighlight",{get:function(){return!(!this.config||!this.config.highlight)},enumerable:!0,configurable:!0}),Object.defineProperty(Gt.prototype,"sort",{get:function(){return this.sorting.map(function(e){return new f.RequestSortDefinitionInner({type:e.type,field:e.field,ascending:e.ascending})})},enumerable:!0,configurable:!0}),Object.defineProperty(Gt.prototype,"facetQueries",{get:function(){var t=this;return this.hasFacetQueries?this.config.facetQueries.queries.map(function(e){return e.group=t.getQueryGroup(e),T({},e)}):null},enumerable:!0,configurable:!0}),Object.defineProperty(Gt.prototype,"facetIntervals",{get:function(){var t=this;return this.hasFacetIntervals?{intervals:this.config.facetIntervals.intervals.map(function(e){return{label:t.getSupportedLabel(e.label),field:e.field,sets:e.sets.map(function(e){return{label:t.getSupportedLabel(e.label),start:e.start,end:e.end,startInclusive:e.startInclusive,endInclusive:e.endInclusive}})}})}:null},enumerable:!0,configurable:!0}),Object.defineProperty(Gt.prototype,"highlight",{get:function(){return this.hasFacetHighlight?this.config.highlight:null},enumerable:!0,configurable:!0}),Gt.prototype.getFinalQuery=function(){var n=this,i="";this.categories.forEach(function(e){var t=n.queryFragments[e.id];t&&(0<i.length&&(i+=" AND "),i+="("+t+")")});var o=[this.userQuery,i].filter(function(e){return e}).join(" AND ");return this.userFacetBuckets&&Object.keys(this.userFacetBuckets).forEach(function(e){var t=(n.userFacetBuckets[e]||[]).filter(function(e){return e.filterQuery}).map(function(e){return e.filterQuery}).join(" OR ");t&&(0<o.length&&(o+=" AND "),o+="("+t+")")}),o},Object.defineProperty(Gt.prototype,"facetFields",{get:function(){var t=this,e=this.config.facetFields&&this.config.facetFields.fields;return e&&0<e.length?{facets:e.map(function(e){return{field:e.field,mincount:e.mincount,label:t.getSupportedLabel(e.label),limit:e.limit,offset:e.offset,prefix:e.prefix}})}:null},enumerable:!0,configurable:!0}),Gt.prototype.getSupportedLabel=function(e){return-1<e.search(/\s/g)?'"'+e+'"':e},Gt.decorators=[{type:y.Injectable,args:[{providedIn:"root"}]}],Gt.ctorParameters=function(){return[{type:b.AppConfigService},{type:b.AlfrescoApiService}]},Gt.ngInjectableDef=y.defineInjectable({factory:function(){return new Gt(y.inject(b.AppConfigService),y.inject(b.AlfrescoApiService))},token:Gt,providedIn:"root"}),Gt);function Gt(e,t){this.appConfig=e,this.alfrescoApiService=t,this._userQuery="",this.updated=new u.Subject,this.executed=new u.Subject,this.error=new u.Subject,this.categories=[],this.queryFragments={},this.filterQueries=[],this.paging=null,this.sorting=[],this.userFacetBuckets={},this.config={categories:[]},this.ranges={},this.resetToDefaults()}var qt=(Object.defineProperty(Yt.prototype,"classList",{set:function(e){var t=this;e&&e.length&&(e.split(" ").forEach(function(e){return t._classList[e.trim()]=!0}),this._elementRef.nativeElement.className="")},enumerable:!0,configurable:!0}),Object.defineProperty(Yt.prototype,"isOpen",{get:function(){return this._isOpen&&this.showPanel},set:function(e){this._isOpen=e},enumerable:!0,configurable:!0}),Yt.prototype.ngAfterContentInit=function(){this.setVisibility()},Yt.prototype.ngOnChanges=function(e){e.searchTerm&&e.searchTerm.currentValue&&this.loadSearchResults(e.searchTerm.currentValue)},Yt.prototype.ngOnDestroy=function(){this.onDestroy$.next(!0),this.onDestroy$.complete()},Yt.prototype.resetResults=function(){this.cleanResults(),this.setVisibility()},Yt.prototype.reload=function(){this.loadSearchResults(this.searchTerm)},Yt.prototype.cleanResults=function(){this.results&&(this.results={})},Yt.prototype.loadSearchResults=function(e){var t=this;this.resetResults(),e?this.searchService.search(e,this.maxResults,this.skipResults).subscribe(function(e){return t.onSearchDataLoaded(e)},function(e){return t.onSearchDataError(e)}):this.cleanResults()},Yt.prototype.onSearchDataLoaded=function(e){e&&(this.results=e,this.resultLoaded.emit(this.results),this.isOpen=!0,this.setVisibility())},Yt.prototype.onSearchDataError=function(e){e&&400!==e.status&&(this.results=null,this.error.emit(e))},Yt.prototype.hidePanel=function(){this.isOpen&&(this._classList["adf-search-show"]=!1,this._classList["adf-search-hide"]=!0,this.isOpen=!1)},Yt.prototype.setVisibility=function(){this.showPanel=!!this.results&&!!this.results.list,this._classList["adf-search-show"]=this.showPanel,this._classList["adf-search-hide"]=!this.showPanel},Yt.decorators=[{type:y.Component,args:[{selector:"adf-search",template:'<div role="listbox" id="adf-search-results-content" [ngClass]="_classList" #panel>\n    <ng-template\n        [ngTemplateOutlet]="template"\n        [ngTemplateOutletContext]="{ $implicit: results }">\n    </ng-template>\n</div>\n\n\n',encapsulation:y.ViewEncapsulation.None,preserveWhitespaces:!1,exportAs:"searchAutocomplete",host:{"class":"adf-search"},styles:[""]}]}],Yt.ctorParameters=function(){return[{type:b.SearchService},{type:y.ElementRef}]},Yt.propDecorators={panel:[{type:y.ViewChild,args:["panel"]}],template:[{type:y.ContentChild,args:[y.TemplateRef]}],displayWith:[{type:y.Input}],maxResults:[{type:y.Input}],skipResults:[{type:y.Input}],searchTerm:[{type:y.Input}],classList:[{type:y.Input,args:["class"]}],resultLoaded:[{type:y.Output}],error:[{type:y.Output}]},Yt);function Yt(e,t){var n=this;this.searchService=e,this._elementRef=t,this.displayWith=null,this.maxResults=20,this.skipResults=0,this.searchTerm="",this.resultLoaded=new y.EventEmitter,this.error=new y.EventEmitter,this.showPanel=!1,this._isOpen=!1,this.keyPressedStream=new u.Subject,this._classList={},this.onDestroy$=new u.Subject,this.keyPressedStream.pipe(m.debounceTime(200),m.takeUntil(this.onDestroy$)).subscribe(function(e){n.loadSearchResults(e)}),e.dataLoaded.pipe(m.takeUntil(this.onDestroy$)).subscribe(function(e){return n.onSearchDataLoaded(e)},function(e){return n.onSearchDataError(e)})}var zt=o.trigger("transitionMessages",[o.state("active",o.style({"margin-left":"{{ margin-left }}px","margin-right":"{{ margin-right }}px",transform:"{{ transform }}"}),{params:{"margin-left":0,"margin-right":0,transform:"translateX(0%)"}}),o.state("inactive",o.style({"margin-left":"{{ margin-left }}px","margin-right":"{{ margin-right }}px",transform:"{{ transform }}"}),{params:{"margin-left":0,"margin-right":0,transform:"translateX(0%)"}}),o.state("no-animation",o.style({transform:"translateX(0%)",width:"100%"})),o.transition("active <=> inactive",o.animate("400ms cubic-bezier(0.25, 0.8, 0.25, 1)"))]),Qt=(Wt.decorators=[{type:y.Component,args:[{selector:"adf-empty-search-result",template:'<div class="adf-empty-search-result">\n    <ng-content></ng-content>\n</div>\n',encapsulation:y.ViewEncapsulation.None}]}],Wt);function Wt(){}var Xt=(Zt.prototype.applySearchFocus=function(e){"active"===e.toState&&this.searchInput.nativeElement.focus()},Zt.prototype.ngOnInit=function(){var t=this;this.userPreferencesService.select("textOrientation").pipe(m.takeUntil(this.onDestroy$)).subscribe(function(e){t.dir=e,t.subscriptAnimationState=t.getAnimationState()}),this.subscriptAnimationState=this.getAnimationState(),this.setupFocusEventHandlers()},Zt.prototype.isNoSearchTemplatePresent=function(){return!!this.emptySearchTemplate},Zt.prototype.ngOnDestroy=function(){this.focusSubject&&(this.focusSubject.complete(),this.focusSubject=null),this.toggleSearch&&(this.toggleSearch.complete(),this.toggleSearch=null),this.onDestroy$.next(!0),this.onDestroy$.complete()},Zt.prototype.isLoggedIn=function(){return this.authService.isEcmLoggedIn()},Zt.prototype.searchSubmit=function(e){this.submit.emit(e),this.toggleSearchBar()},Zt.prototype.inputChange=function(e){this.searchChange.emit(e)},Zt.prototype.getAutoComplete=function(){return this.autocomplete?"on":"off"},Zt.prototype.getMimeTypeIcon=function(e){var t=this.getMimeType(e);return this.thumbnailService.getMimeTypeIcon(t)},Zt.prototype.getMimeType=function(e){var t;return e.entry.content&&e.entry.content.mimeType&&(t=e.entry.content.mimeType),e.entry.isFolder&&(t="folder"),t},Zt.prototype.isSearchBarActive=function(){return"active"===this.subscriptAnimationState.value&&this.liveSearchEnabled},Zt.prototype.toggleSearchBar=function(){this.toggleSearch&&this.toggleSearch.next()},Zt.prototype.elementClicked=function(e){e.entry&&(this.optionClicked.next(e),this.toggleSearchBar())},Zt.prototype.onFocus=function(e){this.focusSubject.next(e)},Zt.prototype.onBlur=function(e){this.focusSubject.next(e)},Zt.prototype.activateToolbar=function(){this.isSearchBarActive()||this.toggleSearchBar()},Zt.prototype.selectFirstResult=function(){this.listResultElement&&0<this.listResultElement.length&&this.listResultElement.first._getHostElement().focus()},Zt.prototype.onRowArrowDown=function(e){var t=this.getNextElementSibling(e.target);t&&t.focus()},Zt.prototype.onRowArrowUp=function(e){var t=this.getPreviousElementSibling(e.target);t?t.focus():(this.searchInput.nativeElement.focus(),this.focusSubject.next(new FocusEvent("focus")))},Zt.prototype.setupFocusEventHandlers=function(){var t=this;this.focusSubject.pipe(m.debounceTime(50),m.filter(function(e){return t.isSearchBarActive()&&("blur"===e.type||"focusout"===e.type)}),m.takeUntil(this.onDestroy$)).subscribe(function(){t.toggleSearchBar()})},Zt.prototype.getNextElementSibling=function(e){return e.nextElementSibling},Zt.prototype.getPreviousElementSibling=function(e){return e.previousElementSibling},Zt.prototype.toggleAnimation=function(){return"ltr"===this.dir?"inactive"===this.subscriptAnimationState.value?{value:"active",params:{"margin-left":13}}:{value:"inactive",params:{transform:"translateX(82%)"}}:"inactive"===this.subscriptAnimationState.value?{value:"active",params:{"margin-right":13}}:{value:"inactive",params:{transform:"translateX(-82%)"}}},Zt.prototype.getAnimationState=function(){return"ltr"===this.dir?this.expandable?{value:"inactive",params:{transform:"translateX(82%)"}}:{value:"no-animation"}:this.expandable?{value:"inactive",params:{transform:"translateX(-82%)"}}:{value:"no-animation"}},Zt.decorators=[{type:y.Component,args:[{selector:"adf-search-control",template:'<div class="adf-search-container" [attr.state]="subscriptAnimationState.value">\n    <div *ngIf="isLoggedIn()" [@transitionMessages]="subscriptAnimationState"\n         (@transitionMessages.done)="applySearchFocus($event)">\n        <button mat-icon-button\n                *ngIf="expandable"\n                id="adf-search-button"\n                class="adf-search-button"\n                [title]="\'SEARCH.BUTTON.TOOLTIP\' | translate"\n                (click)="toggleSearchBar()"\n                (keyup.enter)="toggleSearchBar()">\n            <mat-icon [attr.aria-label]="\'SEARCH.BUTTON.ARIA-LABEL\' | translate">search</mat-icon>\n        </button>\n        <mat-form-field class="adf-input-form-field-divider">\n            <input matInput\n                   #searchInput\n                   [attr.aria-label]="\'SEARCH.INPUT.ARIA-LABEL\' | translate"\n                   [attr.type]="inputType"\n                   [autocomplete]="getAutoComplete()"\n                   id="adf-control-input"\n                   [(ngModel)]="searchTerm"\n                   (focus)="activateToolbar()"\n                   (blur)="onBlur($event)"\n                   (keyup.escape)="toggleSearchBar()"\n                   (keyup.arrowdown)="selectFirstResult()"\n                   (ngModelChange)="inputChange($event)"\n                   [searchAutocomplete]="auto"\n                   (keyup.enter)="searchSubmit($event)">\n        </mat-form-field>\n    </div>\n</div>\n\n<adf-search #search\n            #auto="searchAutocomplete"\n            class="adf-search-result-autocomplete"\n            [maxResults]="liveSearchMaxResults">\n    <ng-template let-data>\n        <mat-list *ngIf="isSearchBarActive()" id="autocomplete-search-result-list">\n            <mat-list-item\n                *ngFor="let item of data?.list?.entries; let idx = index"\n                id="result_option_{{idx}}"\n                [attr.data-automation-id]="\'autocomplete_for_\' + item.entry.name"\n                [tabindex]="0"\n                (focus)="onFocus($event)"\n                (blur)="onBlur($event)"\n                (keyup.arrowdown)="onRowArrowDown($event)"\n                (keyup.arrowup)="onRowArrowUp($event)"\n                class="adf-search-autocomplete-item"\n                (click)="elementClicked(item)"\n                (keyup.enter)="elementClicked(item)"\n                (touchend)="elementClicked(item)">\n                \x3c!-- This is a comment --\x3e\n                <mat-icon mat-list-icon>\n                    <img [alt]="getMimeType(item)" [src]="getMimeTypeIcon(item)"/>\n                </mat-icon>\n                <h4 mat-line id="result_name_{{idx}}"\n                    *ngIf="highlight; else elseBlock"\n                    class="adf-search-fixed-text"\n                    [innerHtml]="item.entry.name | highlight: searchTerm">\n                    {{ item?.entry.name }}\n                </h4>\n                <ng-template #elseBlock>\n                    <h4 class="adf-search-fixed-text" mat-line id="result_name_{{idx}}"\n                        [innerHtml]="item.entry.name"></h4>\n                </ng-template>\n                <p mat-line class="adf-search-fixed-text"> {{item?.entry.createdByUser.displayName}} </p>\n            </mat-list-item>\n            <mat-list-item id="search_no_result"\n                           data-automation-id="search_no_result_found"\n                           *ngIf="data?.list?.entries.length === 0">\n                <ng-content\n                    selector="adf-empty-search-result"\n                    *ngIf="isNoSearchTemplatePresent() else defaultNoResult">\n                </ng-content>\n                <ng-template #defaultNoResult>\n                    <p mat-line class="adf-search-fixed-text">{{ \'SEARCH.RESULTS.NONE\' | translate:{searchTerm:\n                        searchTerm} }}</p>\n                </ng-template>\n            </mat-list-item>\n        </mat-list>\n    </ng-template>\n</adf-search>\n',animations:[zt],encapsulation:y.ViewEncapsulation.None,host:{"class":"adf-search-control"},styles:[""]}]}],Zt.ctorParameters=function(){return[{type:b.AuthenticationService},{type:b.ThumbnailService},{type:b.UserPreferencesService}]},Zt.propDecorators={expandable:[{type:y.Input}],highlight:[{type:y.Input}],inputType:[{type:y.Input}],autocomplete:[{type:y.Input}],liveSearchEnabled:[{type:y.Input}],liveSearchMaxResults:[{type:y.Input}],submit:[{type:y.Output}],searchChange:[{type:y.Output}],optionClicked:[{type:y.Output}],searchAutocomplete:[{type:y.ViewChild,args:["search"]}],searchInput:[{type:y.ViewChild,args:["searchInput"]}],listResultElement:[{type:y.ViewChildren,args:[d.MatListItem]}],emptySearchTemplate:[{type:y.ContentChild,args:[Qt]}]},Zt);function Zt(e,t,n){var i=this;this.authService=e,this.thumbnailService=t,this.userPreferencesService=n,this.expandable=!0,this.highlight=!1,this.inputType="text",this.autocomplete=!1,this.liveSearchEnabled=!0,this.liveSearchMaxResults=5,this.submit=new y.EventEmitter,this.searchChange=new y.EventEmitter,this.optionClicked=new y.EventEmitter,this.searchTerm="",this.noSearchResultTemplate=null,this.toggleSearch=new u.Subject,this.focusSubject=new u.Subject,this.onDestroy$=new u.Subject,this.dir="ltr",this.toggleSearch.pipe(m.debounceTime(200),m.takeUntil(this.onDestroy$)).subscribe(function(){i.expandable&&(i.subscriptAnimationState=i.toggleAnimation(),"inactive"===i.subscriptAnimationState.value&&(i.searchTerm="",i.searchAutocomplete.resetResults(),document.activeElement.id===i.searchInput.nativeElement.id&&i.searchInput.nativeElement.blur()))})}var Kt={provide:v.NG_VALUE_ACCESSOR,useExisting:y.forwardRef(function(){return Jt}),multi:!0},Jt=(en.prototype.ngOnDestroy=function(){this.onDestroy$.next(!0),this.onDestroy$.complete(),this.escapeEventStream&&(this.escapeEventStream=null),this.closingActionsSubscription&&this.closingActionsSubscription.unsubscribe()},Object.defineProperty(en.prototype,"panelOpen",{get:function(){return this._panelOpen&&this.searchPanel.showPanel},enumerable:!0,configurable:!0}),en.prototype.openPanel=function(){this.searchPanel.isOpen=this._panelOpen=!0,this.closingActionsSubscription=this.subscribeToClosingActions()},en.prototype.closePanel=function(){this._panelOpen&&(this.closingActionsSubscription.unsubscribe(),this._panelOpen=!1,this.searchPanel.resetResults(),this.searchPanel.hidePanel(),this.changeDetectorRef.detectChanges())},Object.defineProperty(en.prototype,"panelClosingActions",{get:function(){return u.merge(this.escapeEventStream,this.outsideClickStream)},enumerable:!0,configurable:!0}),Object.defineProperty(en.prototype,"outsideClickStream",{get:function(){var n=this;return this.document?u.merge(u.fromEvent(this.document,"click"),u.fromEvent(this.document,"touchend")).pipe(m.filter(function(e){var t=e.target;return n._panelOpen&&t!==n.element.nativeElement}),m.takeUntil(this.onDestroy$)):u.of(null)},enumerable:!0,configurable:!0}),en.prototype.writeValue=function(e){var t=this;Promise.resolve(null).then(function(){return t.setTriggerValue(e)})},en.prototype.registerOnChange=function(e){this.onChange=e},en.prototype.registerOnTouched=function(e){this.onTouched=e},en.prototype.handleKeydown=function(e){var t=e.keyCode;t===n.ESCAPE&&this.panelOpen?(this.escapeEventStream.next(),e.stopPropagation()):t===n.ENTER&&(this.escapeEventStream.next(),e.preventDefault())},en.prototype.handleInput=function(e){if(document.activeElement===e.target){var t=e.target.value;this.onChange(t),t?(this.searchPanel.keyPressedStream.next(t),this.openPanel()):(this.searchPanel.resetResults(),this.closePanel())}},en.prototype.isPanelOptionClicked=function(e){var t=!1;if(e){var n=e.target;t=!this.isNoResultOption(e)&&!!this.searchPanel.panel&&!!this.searchPanel.panel.nativeElement.contains(n)}return t},en.prototype.isNoResultOption=function(e){return!this.searchPanel.results.list||0===this.searchPanel.results.list.entries.length},en.prototype.subscribeToClosingActions=function(){var t=this,e=this.ngZone.onStable.asObservable(),n=this.searchPanel.keyPressedStream.asObservable();return u.merge(e,n).pipe(m.switchMap(function(){return t.searchPanel.setVisibility(),t.panelClosingActions}),m.takeUntil(this.onDestroy$)).subscribe(function(e){return t.setValueAndClose(e)})},en.prototype.setTriggerValue=function(e){var t=this.searchPanel&&this.searchPanel.displayWith?this.searchPanel.displayWith(e):e,n=null!=t?t:"";this.element.nativeElement.value=n},en.prototype.setValueAndClose=function(e){this.isPanelOptionClicked(e)&&!e.defaultPrevented&&(this.setTriggerValue(e.target.textContent.trim()),this.onChange(e.target.textContent.trim()),this.element.nativeElement.focus()),this.closePanel()},en.decorators=[{type:y.Directive,args:[{selector:"input[searchAutocomplete], textarea[searchAutocomplete]",host:{role:"combobox","[attr.autocomplete]":"autocomplete","aria-autocomplete":"list","[attr.aria-expanded]":"panelOpen.toString()","(blur)":"onTouched()","(input)":"handleInput($event)","(keydown)":"handleKeydown($event)"},providers:[Kt]}]}],en.ctorParameters=function(){return[{type:y.ElementRef},{type:y.NgZone},{type:y.ChangeDetectorRef},{type:undefined,decorators:[{type:y.Optional},{type:y.Inject,args:[g.DOCUMENT]}]}]},en.propDecorators={searchPanel:[{type:y.Input,args:["searchAutocomplete"]}],autocomplete:[{type:y.Input}]},en);function en(e,t,n,i){this.element=e,this.ngZone=t,this.changeDetectorRef=n,this.document=i,this.onDestroy$=new u.Subject,this.autocomplete="off",this._panelOpen=!1,this.escapeEventStream=new u.Subject,this.onChange=function(){},this.onTouched=function(){}}
/*!
     * @license
     * Copyright 2019 Alfresco Software, Ltd.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *     http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var tn=(Object.defineProperty(nn.prototype,"filterText",{get:function(){return this._filterText},set:function(e){this._filterText=e,this.applyFilter()},enumerable:!0,configurable:!0}),Object.defineProperty(nn.prototype,"filter",{get:function(){return this._filter},set:function(e){this._filter=e,this.applyFilter()},enumerable:!0,configurable:!0}),nn.prototype.applyFilter=function(){this.filter?this.filteredItems=this.items.filter(this.filter):this.filteredItems=this.items,this.currentPageSize=this.pageSize},Object.defineProperty(nn.prototype,"visibleItems",{get:function(){return this.filteredItems.slice(0,this.currentPageSize)},enumerable:!0,configurable:!0}),Object.defineProperty(nn.prototype,"length",{get:function(){return this.items.length},enumerable:!0,configurable:!0}),Object.defineProperty(nn.prototype,"canShowMoreItems",{get:function(){return this.filteredItems.length>this.currentPageSize},enumerable:!0,configurable:!0}),Object.defineProperty(nn.prototype,"canShowLessItems",{get:function(){return this.currentPageSize>this.pageSize},enumerable:!0,configurable:!0}),Object.defineProperty(nn.prototype,"fitsPage",{get:function(){return this.pageSize>=this.filteredItems.length},enumerable:!0,configurable:!0}),nn.prototype.showMoreItems=function(){this.canShowMoreItems&&(this.currentPageSize+=this.pageSize)},nn.prototype.showLessItems=function(){this.canShowLessItems&&(this.currentPageSize-=this.pageSize)},nn.prototype.clear=function(){this.currentPageSize=this.pageSize,this.items=[],this.filteredItems=[],this.filterText=""},nn.prototype.addItem=function(e){e&&(this.items.push(e),this.applyFilter())},nn.prototype.deleteItem=function(e){var t=this.items.indexOf(e);-1<t&&(this.items.splice(t,1),this.filteredItems.splice(t,1))},nn.prototype[Symbol.iterator]=function(){var e=0,t=this.visibleItems;return{next:function(){return e<t.length?{done:!1,value:t[e++]}:{done:!0,value:null}}}},nn);function nn(e,t){void 0===e&&(e=[]),this.filteredItems=[],this._filterText="",this.items=[],this.pageSize=5,this.currentPageSize=5,this._filter=function(){return!0},this.items=e,this.filteredItems=e,this.pageSize=t||5,this.currentPageSize=t||5}var on=(rn.prototype.ngOnInit=function(){var t=this;this.queryBuilder&&this.queryBuilder.executed.pipe(m.takeUntil(this.onDestroy$)).subscribe(function(e){t.onDataLoaded(e),t.searchService.dataLoaded.next(e)})},rn.prototype.ngOnDestroy=function(){this.onDestroy$.next(!0),this.onDestroy$.complete()},rn.prototype.updateSelectedBuckets=function(){var e,t;if(this.responseFacets){this.selectedBuckets=[];var n=function(t){var e;t.buckets&&(e=i.selectedBuckets).push.apply(e,N(i.queryBuilder.getUserFacetBuckets(t.field).filter(function(e){return e.checked}).map(function(e){return{field:t,bucket:e}})))},i=this;try{for(var o=w(this.responseFacets),r=o.next();!r.done;r=o.next())n(r.value)}catch(a){e={error:a}}finally{try{r&&!r.done&&(t=o["return"])&&t.call(o)}finally{if(e)throw e.error}}}else this.selectedBuckets=[]},rn.prototype.onToggleBucket=function(e,t,n){e&&n&&(e.checked?this.selectFacetBucket(t,n):this.unselectFacetBucket(t,n))},rn.prototype.selectFacetBucket=function(e,t){t&&(t.checked=!0,this.queryBuilder.addUserFacetBucket(e,t),this.updateSelectedBuckets(),this.queryBuilder.update())},rn.prototype.unselectFacetBucket=function(e,t){t&&(t.checked=!1,this.queryBuilder.removeUserFacetBucket(e,t),this.updateSelectedBuckets(),this.queryBuilder.update())},rn.prototype.canResetSelectedBuckets=function(e){return!(!e||!e.buckets)&&e.buckets.items.some(function(e){return e.checked})},rn.prototype.resetSelectedBuckets=function(e){var t,n;if(e&&e.buckets){try{for(var i=w(e.buckets.items),o=i.next();!o.done;o=i.next()){var r=o.value;r.checked=!1,this.queryBuilder.removeUserFacetBucket(e,r)}}catch(a){t={error:a}}finally{try{o&&!o.done&&(n=i["return"])&&n.call(i)}finally{if(t)throw t.error}}this.updateSelectedBuckets(),this.queryBuilder.update()}},rn.prototype.resetAllSelectedBuckets=function(){var s=this;this.responseFacets.forEach(function(e){var t,n;if(e&&e.buckets){try{for(var i=w(e.buckets.items),o=i.next();!o.done;o=i.next()){var r=o.value;r.checked=!1,s.queryBuilder.removeUserFacetBucket(e,r)}}catch(a){t={error:a}}finally{try{o&&!o.done&&(n=i["return"])&&n.call(i)}finally{if(t)throw t.error}}s.updateSelectedBuckets()}}),this.queryBuilder.update()},rn.prototype.resetAll=function(){this.resetAllSelectedBuckets(),this.responseFacets=null},rn.prototype.shouldExpand=function(e){return this.facetExpanded[e.type]||this.facetExpanded["default"]},rn.prototype.onDataLoaded=function(e){var t=e.list.context;t?this.parseFacets(t):this.responseFacets=null},rn.prototype.parseFacets=function(e){this.parseFacetFields(e),this.parseFacetIntervals(e),this.parseFacetQueries(e)},rn.prototype.parseFacetItems=function(a,e,s){var l=this;e.forEach(function(e){var t=l.findFacet(a,s,e.label),n=l.getResponseBuckets(t,e).filter(l.getFilterByMinCount(e.mincount)),i=l.findResponseFacet(s,e.label);if(i){var o=i.buckets&&i.buckets.items||[];l.updateExistingBuckets(t,n,i,o)}else if(t){var r=new tn(n,e.pageSize);r.filter=l.getBucketFilterFunction(r),l.responseFacets||(l.responseFacets=[]),l.responseFacets.push(T({},e,{type:t.type||s,label:e.label,pageSize:e.pageSize|l.DEFAULT_PAGE_SIZE,currentPageSize:e.pageSize|l.DEFAULT_PAGE_SIZE,buckets:r}))}})},rn.prototype.parseFacetFields=function(e){var t=this.queryBuilder.config.facetFields&&this.queryBuilder.config.facetFields.fields||[];this.parseFacetItems(e,t,"field")},rn.prototype.parseFacetIntervals=function(e){var t=this.queryBuilder.config.facetIntervals&&this.queryBuilder.config.facetIntervals.intervals||[];this.parseFacetItems(e,t,"interval")},rn.prototype.parseFacetQueries=function(a){var s=this,l=(this.queryBuilder.config.facetQueries&&this.queryBuilder.config.facetQueries.queries||[]).reduce(function(e,t){var n=s.queryBuilder.getQueryGroup(t);return e[n]?e[n].push(t):e[n]=[t],e},[]),e=this.queryBuilder.config.facetQueries&&this.queryBuilder.config.facetQueries.mincount,c=this.getFilterByMinCount(e);Object.keys(l).forEach(function(e){var t=s.findFacet(a,"query",e),n=s.getResponseQueryBuckets(t,l[e]).filter(c),i=s.findResponseFacet("query",e);if(i){var o=i.buckets&&i.buckets.items||[];s.updateExistingBuckets(t,n,i,o)}else if(t){var r=new tn(n,s.facetQueriesPageSize);r.filter=s.getBucketFilterFunction(r),s.responseFacets||(s.responseFacets=[]),s.responseFacets.push({field:e,type:t.type||"query",label:e,pageSize:s.DEFAULT_PAGE_SIZE,currentPageSize:s.DEFAULT_PAGE_SIZE,buckets:r})}})},rn.prototype.getResponseBuckets=function(e,t){var n=this;return(e&&e.buckets||[]).map(function(e){return e.count=n.getCountValue(e),e.filterQuery=e.filterQuery||n.getCorrespondingFilterQuery(t,e.label),T({},e,{checked:!1,display:e.display,label:e.label})})},rn.prototype.getResponseQueryBuckets=function(n,e){var i=this;return(e||[]).map(function(t){var e=(n&&n.buckets||[]).find(function(e){return e.label===t.label});return e.count=i.getCountValue(e),T({},e,{checked:!1,display:e.display,label:e.label})})},rn.prototype.getCountValue=function(e){return!!e&&!!e.metrics&&e.metrics[0]&&e.metrics[0].value&&e.metrics[0].value.count||0},rn.prototype.getBucketCountDisplay=function(e){return null===e.count?"":"("+e.count+")"},rn.prototype.getFilterByMinCount=function(n){return function(e){var t=n;return t===undefined&&(t=1),e.count>=t}},rn.prototype.getCorrespondingFilterQuery=function(e,t){var n=null;if(e.field&&t)if(e.sets){var i=e.sets.find(function(e){return t===e.label});i&&(n=this.buildIntervalQuery(e.field,i))}else n=e.field+':"'+t+'"';return n},rn.prototype.buildIntervalQuery=function(e,t){var n=t.start,i=t.end;return e+":"+(t.startInclusive===undefined||!0===t.startInclusive?"[":"<")+'"'+n+'" TO "'+i+'"'+(t.endInclusive===undefined||!0===t.endInclusive?"]":">")},rn.prototype.findFacet=function(e,t,n){return(e.facets||[]).find(function(e){return e.type===t&&e.label===n})||{}},rn.prototype.findResponseFacet=function(t,n){return(this.responseFacets||[]).find(function(e){return e.type===t&&e.label===n})},rn.prototype.updateExistingBuckets=function(n,e,i,o){var r=this,a=[];o.map(function(t){var e=(n&&n.buckets||[]).find(function(e){return e.label===t.label});return e||a.push(t),t.count=r.getCountValue(e),t}),!this.selectedBuckets.find(function(e){return i.label===e.field.label&&i.type===e.field.type})&&a.length&&a.forEach(function(e){i.buckets.deleteItem(e)}),e.forEach(function(t){o.find(function(e){return e.label===t.label})||i.buckets.addItem(t)})},rn.prototype.getBucketFilterFunction=function(i){var o=this;return function(e){if(e&&i.filterText){var t=(i.filterText||"").toLowerCase(),n=(o.translationService.instant(e.display)||o.translationService.instant(e.label)).toLowerCase();return o.queryBuilder.config.filterWithContains?-1!==n.indexOf(t):n.startsWith(t)}return!0}},rn.decorators=[{type:y.Component,args:[{selector:"adf-search-filter",template:'<mat-accordion multi="true" displayMode="flat">\n\n    <button *ngIf="displayResetButton && responseFacets"\n            mat-button\n            color="primary"\n            matTooltip="{{ \'SEARCH.FILTER.BUTTONS.RESET-ALL.TOOLTIP\' | translate }}"\n            matTooltipPosition="right"\n            (click)="resetAll()">\n        {{ \'SEARCH.FILTER.BUTTONS.RESET-ALL.LABEL\' | translate }}\n    </button>\n    <mat-expansion-panel\n        *ngFor="let category of queryBuilder.categories"\n        [attr.data-automation-id]="\'expansion-panel-\'+category.name"\n        [(expanded)]="category.expanded">\n        <mat-expansion-panel-header>\n            <mat-panel-title>\n                {{ category.name | translate }}\n            </mat-panel-title>\n        </mat-expansion-panel-header>\n        <adf-search-widget-container\n            [id]="category.id"\n            [selector]="category.component.selector"\n            [settings]="category.component.settings">\n        </adf-search-widget-container>\n    </mat-expansion-panel>\n\n    <ng-container *ngIf="responseFacets">\n        <mat-expansion-panel [attr.data-automation-id]="\'expansion-panel-\'+field.label" *ngFor="let field of responseFacets"\n                             [expanded]="shouldExpand(field)">\n            <mat-expansion-panel-header>\n                <mat-panel-title>{{ field.label | translate }}</mat-panel-title>\n            </mat-expansion-panel-header>\n\n            <div class="adf-facet-result-filter">\n                <mat-form-field>\n                    <input\n                        matInput\n                        placeholder="{{ \'SEARCH.FILTER.ACTIONS.FILTER-CATEGORY\' | translate }}"\n                        [attr.data-automation-id]="\'facet-result-filter-\'+field.label"\n                        [(ngModel)]="field.buckets.filterText">\n                    <button *ngIf="field.buckets.filterText"\n                        mat-button matSuffix mat-icon-button\n                        (click)="field.buckets.filterText = \'\'">\n                        <mat-icon>close</mat-icon>\n                    </button>\n                </mat-form-field>\n            </div>\n\n            <div class="adf-checklist">\n                <mat-checkbox\n                    *ngFor="let bucket of field.buckets"\n                    [checked]="bucket.checked"\n                    [attr.data-automation-id]="\'checkbox-\'+field.label+\'-\'+(bucket.display || bucket.label)"\n                    (change)="onToggleBucket($event, field, bucket)">\n                    <div \n                        matTooltip="{{ bucket.display || bucket.label | translate }} {{ getBucketCountDisplay(bucket) }}"\n                        matTooltipPosition="right"\n                        class="adf-facet-label">\n                        {{ bucket.display || bucket.label | translate }} {{ getBucketCountDisplay(bucket) }}\n                    </div>\n                </mat-checkbox>\n            </div>\n\n            <div class="adf-facet-buttons" *ngIf="field.buckets.fitsPage">\n                <button *ngIf="canResetSelectedBuckets(field)"\n                    mat-button\n                    color="primary"\n                    (click)="resetSelectedBuckets(field)">\n                    {{ \'SEARCH.FILTER.ACTIONS.CLEAR-ALL\' | translate }}\n                </button>\n            </div>\n\n            <div class="adf-facet-buttons" *ngIf="!field.buckets.fitsPage">\n                <button mat-icon-button\n                    *ngIf="canResetSelectedBuckets(field)"\n                    title="{{ \'SEARCH.FILTER.ACTIONS.CLEAR-ALL\' | translate }}"\n                    (click)="resetSelectedBuckets(field)">\n                    <mat-icon>clear</mat-icon>\n                </button>\n                <button mat-icon-button\n                    *ngIf="field.buckets.canShowLessItems"\n                    (click)="field.buckets.showLessItems()"\n                    title="{{ \'SEARCH.FILTER.ACTIONS.SHOW-LESS\' | translate }}">\n                    <mat-icon>keyboard_arrow_up</mat-icon>\n                </button>\n                <button mat-icon-button\n                    *ngIf="field.buckets.canShowMoreItems"\n                    (click)="field.buckets.showMoreItems()"\n                    title="{{ \'SEARCH.FILTER.ACTIONS.SHOW-MORE\' | translate }}">\n                    <mat-icon>keyboard_arrow_down</mat-icon>\n                </button>\n            </div>\n        </mat-expansion-panel>\n    </ng-container>\n</mat-accordion>\n',encapsulation:y.ViewEncapsulation.None,host:{"class":"adf-search-filter"},styles:[""]}]}],rn.ctorParameters=function(){return[{type:Ht},{type:b.SearchService},{type:b.TranslationService}]},rn);function rn(e,t,n){var i=this;this.queryBuilder=e,this.searchService=t,this.translationService=n,this.DEFAULT_PAGE_SIZE=5,this.responseFacets=null,this.facetQueriesPageSize=this.DEFAULT_PAGE_SIZE,this.facetQueriesLabel="Facet Queries",this.facetExpanded={"default":!1},this.selectedBuckets=[],this.onDestroy$=new u.Subject,e.config&&e.config.facetQueries&&(this.facetQueriesLabel=e.config.facetQueries.label||"Facet Queries",this.facetQueriesPageSize=e.config.facetQueries.pageSize||this.DEFAULT_PAGE_SIZE,this.facetExpanded.query=e.config.facetQueries.expanded),e.config&&e.config.facetFields&&(this.facetExpanded.field=e.config.facetFields.expanded),e.config&&e.config.facetIntervals&&(this.facetExpanded.interval=e.config.facetIntervals.expanded),this.displayResetButton=this.queryBuilder.config&&!!this.queryBuilder.config.resetButton,this.queryBuilder.updated.pipe(m.takeUntil(this.onDestroy$)).subscribe(function(){return i.queryBuilder.execute()})}var an=(sn.prototype.ngOnInit=function(){if(this.context&&this.settings&&this.settings.pattern){var e=new RegExp(this.settings.pattern,"g").exec(this.context.queryFragments[this.id]||"");e&&1<e.length&&(this.value=e[1])}},sn.prototype.reset=function(){this.value="",this.updateQuery(null)},sn.prototype.onChangedHandler=function(e){this.value=e.target.value,this.updateQuery(this.value)},sn.prototype.updateQuery=function(e){this.context&&this.settings&&this.settings.field&&(this.context.queryFragments[this.id]=e?this.settings.field+":'"+e+"'":"",this.context.update())},sn.decorators=[{type:y.Component,args:[{selector:"adf-search-text",template:'<mat-form-field>\n    <input\n        matInput\n        [placeholder]="settings?.placeholder"\n        [(ngModel)]="value"\n        (change)="onChangedHandler($event)">\n    <button mat-button *ngIf="value" matSuffix mat-icon-button (click)="reset()">\n        <mat-icon>close</mat-icon>\n    </button>\n</mat-form-field>\n',encapsulation:y.ViewEncapsulation.None,host:{"class":"adf-search-text"},styles:[".adf-search-text .mat-form-field{width:100%}"]}]}],sn.propDecorators={value:[{type:y.Input}]},sn);function sn(){this.value=""}var ln=(cn.prototype.ngOnInit=function(){this.settings&&(this.pageSize=this.settings.pageSize||5,this.settings.options&&0<this.settings.options.length&&(this.options=new tn(this.settings.options,this.pageSize)));var e=this.getSelectedValue();null!==e&&this.setValue(e)},cn.prototype.getSelectedValue=function(){var e=this.settings.options||[];if(e&&0<e.length){var t=e.find(function(e){return e["default"]});return(t=t||e[0]).value}return null},cn.prototype.setValue=function(e){this.value=e,this.context.queryFragments[this.id]=e,this.context.update()},cn.prototype.changeHandler=function(e){this.setValue(e.value)},cn.decorators=[{type:y.Component,args:[{selector:"adf-search-radio",template:'<mat-radio-group\n    [(ngModel)]="value"\n    (change)="changeHandler($event)">\n    <mat-radio-button [attr.data-automation-id]="\'search-radio-\'+(option.name | translate)"\n        *ngFor="let option of options"\n        [value]="option.value"\n        class="adf-facet-filter">\n        <div \n            matTooltip="{{ option.name | translate }}"\n            matTooltipPosition="right"\n            class="filter-label">\n            {{ option.name | translate }}\n        </div>\n    </mat-radio-button>\n</mat-radio-group>\n\n<div class="adf-facet-buttons" *ngIf="!options.fitsPage">\n    <button mat-icon-button\n        *ngIf="options.canShowLessItems"\n        title="{{ \'SEARCH.FILTER.ACTIONS.SHOW-LESS\' | translate }}"\n        (click)="options.showLessItems()">\n        <mat-icon>keyboard_arrow_up</mat-icon>\n    </button>\n    <button mat-icon-button\n        *ngIf="options.canShowMoreItems"\n        title="{{ \'SEARCH.FILTER.ACTIONS.SHOW-MORE\' | translate }}"\n        (click)="options.showMoreItems()">\n        <mat-icon>keyboard_arrow_down</mat-icon>\n    </button>\n</div>\n',encapsulation:y.ViewEncapsulation.None,host:{"class":"adf-search-radio"},styles:[".adf-search-radio .mat-radio-group{display:flex;flex-direction:column}.adf-search-radio .mat-radio-button{margin:5px}.adf-search-radio .adf-facet-filter .mat-radio-label-content{text-overflow:ellipsis;overflow:hidden;width:100%}.adf-search-radio .adf-facet-filter .mat-radio-label{width:100%}.adf-search-radio .adf-facet-filter .adf-filter-label{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}"]}]}],cn.ctorParameters=function(){return[]},cn.propDecorators={value:[{type:y.Input}]},cn);function cn(){this.pageSize=5,this.options=new tn}var dn=(pn.prototype.ngOnInit=function(){this.settings&&(this.settings.hasOwnProperty("min")&&(this.min=this.settings.min),this.settings.hasOwnProperty("max")&&(this.max=this.settings.max),this.settings.hasOwnProperty("step")&&(this.step=this.settings.step),this.thumbLabel=!!this.settings.thumbLabel)},pn.prototype.reset=function(){this.value=this.min||0,this.updateQuery(null)},pn.prototype.onChangedHandler=function(e){this.value=e.value,this.updateQuery(this.value)},pn.prototype.updateQuery=function(e){this.id&&this.context&&this.settings&&this.settings.field&&(this.context.queryFragments[this.id]=null===e?"":this.settings.field+":[0 TO "+e+"]",this.context.update())},pn.decorators=[{type:y.Component,args:[{selector:"adf-search-slider",template:'<mat-slider\n    [(value)]="value"\n    [min]="min"\n    [max]="max"\n    [step]="step"\n    [thumbLabel]="thumbLabel"\n    (change)="onChangedHandler($event)"\n    data-automation-id="slider-range">\n</mat-slider>\n\n<div class="facet-buttons">\n    <button mat-button color="primary" (click)="reset()" data-automation-id="slider-btn-clear">\n        {{ \'SEARCH.FILTER.ACTIONS.CLEAR\' | translate }}\n    </button>\n</div>\n',encapsulation:y.ViewEncapsulation.None,host:{"class":"adf-search-slider"},styles:[".adf-search-slider .mat-slider{width:100%}"]}]}],pn.propDecorators={value:[{type:y.Input}]},pn);
/*!
     * @license
     * Copyright 2019 Alfresco Software, Ltd.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *     http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function pn(){this.thumbLabel=!1}var un=(hn.prototype.isErrorState=function(e,t){var n=t&&t.submitted;return!!(e&&e.invalid&&(e.dirty||e.touched||!e.pristine&&n))},hn);function hn(){}var fn=(mn.prototype.ngOnInit=function(){this.settings&&(this.field=this.settings.field,this.format=this.settings.format||"[{FROM} TO {TO}]"),this.validators=v.Validators.compose([v.Validators.required,v.Validators.pattern(/^-?(0|[1-9]\d*)?$/),v.Validators.min(0)]),this.from=new v.FormControl("",this.validators),this.to=new v.FormControl("",this.validators),this.form=new v.FormGroup({from:this.from,to:this.to},this.formValidator)},mn.prototype.formValidator=function(e){return parseInt(e.get("from").value,10)<parseInt(e.get("to").value,10)?null:{mismatch:!0}},mn.prototype.apply=function(e,t){if(t&&this.id&&this.context&&this.field){var n=new Map;n.set("FROM",e.from),n.set("TO",e.to);var i=this.formatString(this.format,n);this.context.queryFragments[this.id]=this.field+":"+i,this.context.update()}},mn.prototype.formatString=function(e,t){var i=e;return t.forEach(function(e,t){var n=new RegExp("{"+t+"}","gm");i=i.replace(n,e)}),i},mn.prototype.reset=function(){this.form.reset({from:"",to:""}),this.id&&this.context&&(this.context.queryFragments[this.id]="",this.context.update())},mn.decorators=[{type:y.Component,args:[{selector:"adf-search-number-range",template:'<form [formGroup]="form" novalidate (ngSubmit)="apply(form.value, form.valid)">\n\n    <mat-form-field>\n        <input\n            matInput [formControl]="from" [errorStateMatcher]="matcher"\n            placeholder="{{ \'SEARCH.FILTER.RANGE.FROM\' | translate }}"\n            autocomplete="off"\n            data-automation-id="number-range-from-input">\n        <mat-error *ngIf="from.hasError(\'pattern\') || from.hasError(\'min\')" data-automation-id="number-range-from-error-invalid">\n            {{ \'SEARCH.FILTER.VALIDATION.INVALID-FORMAT\' | translate }}\n        </mat-error>\n        <mat-error *ngIf="from.hasError(\'required\')" data-automation-id="number-range-from-error-required">\n            {{ \'SEARCH.FILTER.VALIDATION.REQUIRED-VALUE\' | translate }}\n        </mat-error>\n    </mat-form-field>\n\n    <mat-form-field>\n        <input\n            matInput [formControl]="to" [errorStateMatcher]="matcher"\n            placeholder="{{ \'SEARCH.FILTER.RANGE.TO\' | translate }}"\n            autocomplete="off"\n            data-automation-id="number-range-to-input">\n        <mat-error *ngIf="to.hasError(\'pattern\') || to.hasError(\'min\')" data-automation-id="number-range-to-error-invalid">\n            {{ \'SEARCH.FILTER.VALIDATION.INVALID-FORMAT\' | translate }}\n        </mat-error>\n        <mat-error *ngIf="to.hasError(\'required\')" data-automation-id="number-range-to-error-required">\n            {{ \'SEARCH.FILTER.VALIDATION.REQUIRED-VALUE\' | translate }}\n        </mat-error>\n    </mat-form-field>\n\n\n    <div class="adf-facet-buttons">\n        <button mat-button color="primary" type="button" (click)="reset()" data-automation-id="number-range-btn-clear">\n            {{ \'SEARCH.FILTER.ACTIONS.CLEAR\' | translate }}\n        </button>\n        <button mat-button color="primary" type="submit" [disabled]="!form.valid" data-automation-id="number-range-btn-apply">\n            {{ \'SEARCH.FILTER.ACTIONS.APPLY\' | translate }}\n        </button>\n    </div>\n</form>\n',encapsulation:y.ViewEncapsulation.None,host:{"class":"adf-search-number-range"},styles:[".adf-search-number-range>form{display:inline-flex;flex-direction:column;width:100%}"]}]}],mn);function mn(){this.matcher=new un,this.format="[{FROM} TO {TO}]"}var gn=(yn.prototype.ngOnInit=function(){this.settings&&(this.operator=this.settings.operator||"OR",this.pageSize=this.settings.pageSize||5,this.settings.options&&0<this.settings.options.length&&(this.options=new tn(this.settings.options,this.pageSize)))},yn.prototype.reset=function(){this.options.items.forEach(function(e){e.checked=!1}),this.id&&this.context&&(this.context.queryFragments[this.id]="",this.context.update())},yn.prototype.changeHandler=function(e,t){t.checked=e.checked,this.flush()},yn.prototype.flush=function(){var e=this.options.items.filter(function(e){return e.checked}).map(function(e){return e.value}).join(" "+this.operator+" ");this.id&&this.context&&(this.context.queryFragments[this.id]=e,this.context.update())},yn.decorators=[{type:y.Component,args:[{selector:"adf-search-check-list",template:'<div class="checklist">\n    <mat-checkbox\n        *ngFor="let option of options"\n        [checked]="option.checked"\n        [attr.data-automation-id]="\'checkbox-\' + (option.name)"\n        (change)="changeHandler($event, option)"\n        class="adf-facet-filter">\n        <div \n            matTooltip="{{ option.name | translate }}"\n            matTooltipPosition="right"\n            class="facet-name">\n            {{ option.name | translate }}\n        </div>\n        \n    </mat-checkbox>\n</div>\n\n<div class="adf-facet-buttons" *ngIf="options.fitsPage">\n    <button mat-button color="primary" (click)="reset()">\n        {{ \'SEARCH.FILTER.ACTIONS.CLEAR-ALL\' | translate }}\n    </button>\n</div>\n\n<div class="adf-facet-buttons" *ngIf="!options.fitsPage">\n    <button mat-icon-button\n        title="{{ \'SEARCH.FILTER.ACTIONS.CLEAR-ALL\' | translate }}"\n        (click)="reset()">\n        <mat-icon>clear</mat-icon>\n    </button>\n    <button mat-icon-button\n        *ngIf="options.canShowLessItems"\n        title="{{ \'SEARCH.FILTER.ACTIONS.SHOW-LESS\' | translate }}"\n        (click)="options.showLessItems()">\n        <mat-icon>keyboard_arrow_up</mat-icon>\n    </button>\n    <button mat-icon-button\n        *ngIf="options.canShowMoreItems"\n        title="{{ \'SEARCH.FILTER.ACTIONS.SHOW-MORE\' | translate }}"\n        (click)="options.showMoreItems()">\n        <mat-icon>keyboard_arrow_down</mat-icon>\n    </button>\n</div>\n',encapsulation:y.ViewEncapsulation.None,host:{"class":"adf-search-check-list"},styles:[".adf-search-check-list{display:flex;flex-direction:column}.adf-search-check-list .adf-facet-filter .mat-checkbox-label{text-overflow:ellipsis;overflow:hidden;width:100%}.adf-search-check-list .adf-facet-filter .mat-checkbox-layout{width:100%}.adf-search-check-list .adf-facet-filter .adf-facet-name{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}"]}]}],yn.ctorParameters=function(){return[]},yn);function yn(){this.operator="OR",this.pageSize=5,this.options=new tn}var vn="DD/MM/YYYY",bn=b.MOMENT_DATE_FORMATS,Sn=(In.prototype.getFromValidationMessage=function(){return this.from.hasError("invalidOnChange")||this.hasParseError(this.from)?"SEARCH.FILTER.VALIDATION.INVALID-DATE":this.from.hasError("matDatepickerMax")?"SEARCH.FILTER.VALIDATION.BEYOND-MAX-DATE":this.from.hasError("required")?"SEARCH.FILTER.VALIDATION.REQUIRED-VALUE":""},In.prototype.getToValidationMessage=function(){return this.to.hasError("invalidOnChange")||this.hasParseError(this.to)?"SEARCH.FILTER.VALIDATION.INVALID-DATE":this.to.hasError("matDatepickerMin")?"SEARCH.FILTER.VALIDATION.NO-DAYS":this.to.hasError("matDatepickerMax")?"SEARCH.FILTER.VALIDATION.BEYOND-MAX-DATE":this.to.hasError("required")?"SEARCH.FILTER.VALIDATION.REQUIRED-VALUE":""},In.prototype.ngOnInit=function(){var t=this;this.settings&&(this.datePickerDateFormat=this.settings.dateFormat||vn),this.dateAdapter.overrideDisplayFormat=this.datePickerDateFormat,this.userPreferencesService.select(b.UserPreferenceValues.Locale).pipe(m.takeUntil(this.onDestroy$)).subscribe(function(e){return t.setLocale(e)});var e=v.Validators.compose([v.Validators.required]);this.from=new v.FormControl("",e),this.to=new v.FormControl("",e),this.form=new v.FormGroup({from:this.from,to:this.to}),this.maxDate=this.dateAdapter.today().startOf("day")},In.prototype.ngOnDestroy=function(){this.onDestroy$.next(!0),this.onDestroy$.complete()},In.prototype.apply=function(e,t){if(t&&this.id&&this.context&&this.settings&&this.settings.field){var n=moment(e.from).startOf("day").format(),i=moment(e.to).endOf("day").format();this.context.queryFragments[this.id]=this.settings.field+":['"+n+"' TO '"+i+"']",this.context.update()}},In.prototype.reset=function(){this.form.reset({from:"",to:""}),this.id&&this.context&&(this.context.queryFragments[this.id]="",this.context.update())},In.prototype.onChangedHandler=function(e,t){var n=e.srcElement.value,i=this.dateAdapter.parse(n,this.datePickerDateFormat);i&&i.isValid()?t.setValue(i):i?t.setErrors({invalidOnChange:!0}):t.setErrors({required:!0})},In.prototype.setLocale=function(e){this.dateAdapter.setLocale(e),moment.locale(e)},In.prototype.hasParseError=function(e){return e.hasError("matDatepickerParse")&&e.getError("matDatepickerParse").text},In.prototype.forcePlaceholder=function(e){e.srcElement.click()},In.decorators=[{type:y.Component,args:[{selector:"adf-search-date-range",template:'<form [formGroup]="form" novalidate (ngSubmit)="apply(form.value, form.valid)">\n    <mat-form-field>\n        <input matInput\n                (input)="forcePlaceholder($event)"\n                [formControl]="from"\n                [errorStateMatcher]="matcher"\n                placeholder="{{ \'SEARCH.FILTER.RANGE.FROM-DATE\' | translate }}"\n                [matDatepicker]="fromDatepicker"\n                [max]="maxDate"\n                (focusout)="onChangedHandler($event, from)"\n                data-automation-id="date-range-from-input">\n        <mat-datepicker-toggle matSuffix [for]="fromDatepicker" data-automation-id="date-range-from-date-toggle"></mat-datepicker-toggle>\n        <mat-datepicker #fromDatepicker></mat-datepicker>\n        <mat-error *ngIf="from.invalid" data-automation-id="date-range-from-error">\n            {{ getFromValidationMessage() | translate: { requiredFormat: datePickerDateFormat } }}\n        </mat-error>\n    </mat-form-field>\n\n    <mat-form-field>\n        <input matInput\n                (input)="forcePlaceholder($event)"\n                [formControl]="to"\n                [errorStateMatcher]="matcher"\n                placeholder="{{ \'SEARCH.FILTER.RANGE.TO-DATE\' | translate }}"\n                [matDatepicker]="toDatepicker"\n                [min]="from.value"\n                [max]="maxDate"\n                (focusout)="onChangedHandler($event, to)"\n                data-automation-id="date-range-to-input">\n        <mat-datepicker-toggle matSuffix [for]="toDatepicker" data-automation-id="date-range-to-date-toggle"></mat-datepicker-toggle>\n        <mat-datepicker #toDatepicker></mat-datepicker>\n        <mat-error *ngIf="to.invalid" data-automation-id="date-range-to-error">\n            {{ getToValidationMessage() | translate: { requiredFormat: datePickerDateFormat } }}\n        </mat-error>\n    </mat-form-field>\n\n    <div class="adf-facet-buttons adf-facet-buttons--topSpace">\n        <button mat-button color="primary" type="button" (click)="reset()" data-automation-id="date-range-clear-btn">\n            {{ \'SEARCH.FILTER.ACTIONS.CLEAR\' | translate }}\n        </button>\n        <button mat-button color="primary" type="submit" [disabled]="!form.valid" data-automation-id="date-range-apply-btn">\n            {{ \'SEARCH.FILTER.ACTIONS.APPLY\' | translate }}\n        </button>\n    </div>\n</form>\n',providers:[{provide:t.DateAdapter,useClass:b.MomentDateAdapter,deps:[t.MAT_DATE_LOCALE]},{provide:t.MAT_DATE_FORMATS,useValue:bn}],encapsulation:y.ViewEncapsulation.None,host:{"class":"adf-search-date-range"},styles:[".adf-search-date-range>form{display:inline-flex;flex-direction:column;width:100%}"]}]}],In.ctorParameters=function(){return[{type:t.DateAdapter},{type:b.UserPreferencesService}]},In);function In(e,t){this.dateAdapter=e,this.userPreferencesService=t,this.matcher=new un,this.datePickerDateFormat=vn,this.onDestroy$=new u.Subject}var En=(An.decorators=[{type:y.Injectable,args:[{providedIn:"root"}]}],An.ngInjectableDef=y.defineInjectable({factory:function(){return new An},token:An,providedIn:"root"}),An);function An(){this.widgets={text:an,radio:ln,slider:dn,"number-range":fn,"check-list":gn,"date-range":Sn}}var Cn=(Tn.decorators=[{type:y.Component,args:[{selector:"adf-search-chip-list",template:'<mat-chip-list>\n    <ng-container *ngIf="searchFilter && searchFilter.selectedBuckets.length">\n        <mat-chip *ngIf="clearAll && searchFilter.selectedBuckets.length > 1"\n                  color="primary"\n                  selected\n                  matTooltip="{{ \'SEARCH.FILTER.BUTTONS.CLEAR-ALL.TOOLTIP\' | translate }}"\n                  matTooltipPosition="right"\n                  (click)="searchFilter.resetAllSelectedBuckets()">\n            {{ \'SEARCH.FILTER.BUTTONS.CLEAR-ALL.LABEL\' | translate }}\n        </mat-chip>\n\n        <mat-chip\n            *ngFor="let selection of searchFilter.selectedBuckets"\n            [removable]="true"\n            (removed)="searchFilter.unselectFacetBucket(selection.field, selection.bucket)">\n            {{ (selection.bucket.display || selection.bucket.label) | translate }}\n            <mat-icon matChipRemove>cancel</mat-icon>\n        </mat-chip>\n    </ng-container>\n</mat-chip-list>\n',encapsulation:y.ViewEncapsulation.None,host:{"class":"adf-search-chip-list"}}]}],Tn.propDecorators={searchFilter:[{type:y.Input}],clearAll:[{type:y.Input}]},Tn);function Tn(){this.clearAll=!1}var On=(Dn.prototype.ngOnInit=function(){this.options=this.queryBuilder.getSortingOptions();var e=this.queryBuilder.getPrimarySorting();e&&(this.value=e.key,this.ascending=e.ascending)},Dn.prototype.onValueChanged=function(e){this.value=e,this.ascending=this.getSortingOrder(),this.applySorting()},Dn.prototype.onSortingChanged=function(e){this.ascending=e,this.applySorting()},Dn.prototype.findOptionByKey=function(t){return t?this.options.find(function(e){return e.key===t}):null},Dn.prototype.applySorting=function(){var e=this.findOptionByKey(this.value);e&&(this.queryBuilder.sorting=[T({},e,{ascending:this.ascending})],this.queryBuilder.update())},Dn.prototype.getSortingOrder=function(){var e=this.findOptionByKey(this.value);return e?e.ascending:this.queryBuilder.getPrimarySorting().ascending},Dn.decorators=[{type:y.Component,args:[{selector:"adf-search-sorting-picker",template:'<adf-sorting-picker\n    [options]="options"\n    [selected]="value"\n    [ascending]="ascending"\n    (valueChange)="onValueChanged($event)"\n    (sortingChange)="onSortingChanged($event)">\n</adf-sorting-picker>\n',encapsulation:y.ViewEncapsulation.None,host:{"class":"adf-search-sorting-picker"},styles:[""]}]}],Dn.ctorParameters=function(){return[{type:Ht}]},Dn);function Dn(e){this.queryBuilder=e,this.options=[]}var wn=(Ln.prototype.ngOnInit=function(){var e=this.searchFilterService.widgets[this.selector];if(e){var t=this.componentFactoryResolver.resolveComponentFactory(e);t&&(this.content.clear(),this.componentRef=this.content.createComponent(t,0),this.setupWidget(this.componentRef))}},Ln.prototype.setupWidget=function(e){e&&e.instance&&(e.instance.id=this.id,e.instance.settings=T({},this.settings),e.instance.context=this.queryBuilder)},Ln.prototype.ngOnDestroy=function(){this.componentRef&&(this.componentRef.destroy(),this.componentRef=null)},Ln.decorators=[{type:y.Component,args:[{selector:"adf-search-widget-container",template:"<div #content></div>"}]}],Ln.ctorParameters=function(){return[{type:En},{type:Ht},{type:y.ComponentFactoryResolver}]},Ln.propDecorators={content:[{type:y.ViewChild,args:["content",{read:y.ViewContainerRef}]}],id:[{type:y.Input}],selector:[{type:y.Input}],settings:[{type:y.Input}],config:[{type:y.Input}]},Ln);function Ln(e,t,n){this.searchFilterService=e,this.queryBuilder=t,this.componentFactoryResolver=n}var Nn=[qt,Xt,Jt,Qt,on,Cn],Fn=(Rn.decorators=[{type:y.NgModule,args:[{imports:[g.CommonModule,v.FormsModule,v.ReactiveFormsModule,I,b.CoreModule.forChild()],declarations:N(Nn,[wn,an,ln,dn,fn,gn,Sn,On]),exports:N(Nn,[wn,an,ln,dn,fn,gn,Sn,On]),entryComponents:[wn,an,ln,dn,fn,gn,Sn]}]}],Rn);function Rn(){}var kn={Members:"members",Containers:"containers"},xn=(Pn.prototype.ngOnInit=function(){var t=this;this.siteSelect.openedChange.pipe(m.takeUntil(this.onDestroy$)).subscribe(function(){t.siteSelect.panelOpen&&t.siteSelect.panel.nativeElement.addEventListener("scroll",function(e){return t.loadAllOnScroll(e)})}),this.siteList||this.loadSiteList()},Pn.prototype.ngOnDestroy=function(){this.onDestroy$.next(!0),this.onDestroy$.complete()},Pn.prototype.loadAllOnScroll=function(e){this.isInfiniteScrollingEnabled()&&this.isScrollInNextFetchArea(e)&&(this.loading=!0,this.loadSiteList())},Pn.prototype.isScrollInNextFetchArea=function(e){return e.target.scrollTop>=e.target.scrollHeight-e.target.offsetHeight-this.ITEM_HEIGHT_TO_WAIT_BEFORE_LOAD_NEXT},Pn.prototype.selectedSite=function(e){this.change.emit(e.value)},Pn.prototype.loadSiteList=function(){var i=this,e={skipCount:this.skipCount,maxItems:this.MAX_ITEMS};this.skipCount+=this.MAX_ITEMS,this.relations&&(e.relations=[this.relations]),this.sitesService.getSites(e).subscribe(function(e){if(i.siteList){var t=i.relations===kn.Members?i.filteredResultsByMember(e):e;i.siteList.list.entries=i.siteList.list.entries.concat(t.list.entries),i.siteList.list.pagination=e.list.pagination}else if(i.siteList=i.relations===kn.Members?i.filteredResultsByMember(e):e,!i.hideMyFiles){var n=new f.SiteEntry({entry:{id:"-my-",guid:"-my-",title:"DROPDOWN.MY_FILES_OPTION"}});i.siteList.list.entries.unshift(n),i.value||(i.value="-my-")}i.selected=i.siteList.list.entries.find(function(e){return e.entry.id===i.value}),i.loading=!1},function(e){i.logService.error(e)})},Pn.prototype.showLoading=function(){return this.loading&&this.siteList&&this.siteList.list.pagination&&this.siteList.list.pagination.hasMoreItems},Pn.prototype.isInfiniteScrollingEnabled=function(){return!this.loading&&this.siteList&&this.siteList.list.pagination&&this.siteList.list.pagination.hasMoreItems},Pn.prototype.filteredResultsByMember=function(e){var t=this,n=this.sitesService.getEcmCurrentLoggedUserName();return e.list.entries=e.list.entries.filter(function(e){return t.isCurrentUserMember(e,n)}),e},Pn.prototype.isCurrentUserMember=function(e,t){return"PUBLIC"===e.entry.visibility||!!e.relations.members.list.entries.find(function(e){return e.entry.id.toLowerCase()===t.toLowerCase()})},Pn.decorators=[{type:y.Component,args:[{selector:"adf-sites-dropdown",template:'<div id="site-dropdown-container" class="adf-site-dropdown-container">\n    <mat-form-field>\n        <mat-select\n            #siteSelect\n            data-automation-id="site-my-files-option"\n            class="adf-site-dropdown-list-element"\n            id="site-dropdown"\n            placeholder="{{placeholder | translate}}"\n            floatPlaceholder="never"\n            [(value)]="selected"\n            (selectionChange)="selectedSite($event)">\n            <mat-option *ngFor="let site of siteList?.list.entries;" [value]="site">\n                {{ site.entry.title | translate}}\n            </mat-option>\n            <mat-option *ngIf="showLoading()" disabled="true" data-automation-id="site-loading">\n                {{ \'ADF_DROPDOWN.LOADING\' | translate}}\n            </mat-option>\n        </mat-select>\n    </mat-form-field>\n</div>\n',encapsulation:y.ViewEncapsulation.None,host:{"class":"adf-sites-dropdown"},styles:[".adf-sites-dropdown.adf-full-width .mat-form-field{width:100%}"]}]}],Pn.ctorParameters=function(){return[{type:b.SitesService},{type:b.LogService}]},Pn.propDecorators={hideMyFiles:[{type:y.Input}],siteList:[{type:y.Input}],value:[{type:y.Input}],placeholder:[{type:y.Input}],relations:[{type:y.Input}],change:[{type:y.Output}],siteSelect:[{type:y.ViewChild,args:["siteSelect"]}]},Pn);function Pn(e,t){this.sitesService=e,this.logService=t,this.hideMyFiles=!1,this.siteList=null,this.value=null,this.placeholder="DROPDOWN.PLACEHOLDER_LABEL",this.change=new y.EventEmitter,this.loading=!0,this.skipCount=0,this.MAX_ITEMS=50,this.ITEM_HEIGHT=45,this.ITEM_HEIGHT_TO_WAIT_BEFORE_LOAD_NEXT=this.ITEM_HEIGHT*(this.MAX_ITEMS/2),this.onDestroy$=new u.Subject,this.selected=null,this.MY_FILES_VALUE="-my-"}var Mn=(_n.decorators=[{type:y.NgModule,args:[{imports:[g.CommonModule,I,v.FormsModule,v.ReactiveFormsModule,b.CoreModule.forChild()],exports:[xn],declarations:[xn]}]}],_n);function _n(){}var Un=(Object.defineProperty(Bn.prototype,"hasRoot",{get:function(){return!!this.root},enumerable:!0,configurable:!0}),Bn.prototype.ngOnInit=function(){var t=this;this.transform=this.transform?this.transform:null,this.target&&this.target.$folderNode.pipe(m.takeUntil(this.onDestroy$)).subscribe(function(e){t.folderNode=e,t.recalculateNodes()})},Bn.prototype.ngOnChanges=function(){this.recalculateNodes()},Bn.prototype.recalculateNodes=function(){var e=this.transform?this.transform(this.folderNode):this.folderNode;this.route=this.parseRoute(e),this.maxItems&&this.route.length>this.maxItems?(this.lastNodes=this.route.slice(this.route.length-this.maxItems),this.previousNodes=this.route.slice(0,this.route.length-this.maxItems),this.previousNodes.reverse()):(this.lastNodes=this.route,this.previousNodes=null)},Bn.prototype.open=function(){this.dropdown&&this.dropdown.open()},Bn.prototype.hasPreviousNodes=function(){return!!this.previousNodes},Bn.prototype.parseRoute=function(e){if(e&&e.path){var t=(e.path.elements||[]).slice();t.push({id:e.id,name:e.name,node:e});var n=this.getElementPosition(t,this.rootId);return 0<n&&t.splice(0,n),-1===n&&this.rootId&&(t[0].id=this.rootId),this.root&&(t[0].name=this.root),t}return[]},Bn.prototype.getElementPosition=function(e,t){var n=-1;return e&&0<e.length&&t&&(n=e.findIndex(function(e){return e.id===t})),n},Bn.prototype.onRoutePathClick=function(e,t){t&&t.preventDefault(),e&&(this.navigate.emit(e),this.target&&this.target.navigateTo(e.id))},Bn.prototype.ngOnDestroy=function(){this.onDestroy$.next(!0),this.onDestroy$.complete()},Bn.decorators=[{type:y.Component,args:[{selector:"adf-breadcrumb",template:'<nav *ngIf="folderNode" data-automation-id="breadcrumb" class="adf-breadcrumb-container" role="list">\n    <button\n        *ngIf="hasPreviousNodes()"\n        tabindex="0"\n        class="adf-breadcrumb-dropdown-trigger"\n        (click)="open()">\n        <div class="adf-breadcrumb-dropdown-trigger-icon">\n            <mat-icon [class.adf-isRoot]="!hasPreviousNodes()">folder</mat-icon>\n            <mat-icon [class.adf-isRoot]="!hasPreviousNodes()" class="adf-breadcrumb-dropdown-trigger-arrow">arrow_drop_down</mat-icon>\n        </div>\n    </button>\n\n    <mat-select\n        #dropdown\n        *ngIf="hasPreviousNodes()"\n        class="adf-breadcrumb-dropdown-path"\n        tabindex="0">\n\n        <mat-option\n            *ngFor="let node of previousNodes;"\n            (click)="onRoutePathClick(node, $event)"\n            class="adf-breadcrumb-path-option"\n            tabindex="0">\n            {{ node.name | translate }}\n        </mat-option>\n    </mat-select>\n\n    <div *ngFor="let item of lastNodes; let last = last"\n        [class.adf-active]="last"\n        [ngSwitch]="last"\n        title="{{ item.name | translate }}"\n        class="adf-breadcrumb-item"\n        role="listitem">\n\n        <a *ngSwitchDefault href="#" [attr.data-automation-id]="\'breadcrumb_\' + item.name"\n            class="adf-breadcrumb-item-anchor"\n            (click)="onRoutePathClick(item, $event)">\n            {{ item.name | translate }}\n        </a>\n\n        <div *ngSwitchCase="true" class="adf-breadcrumb-item-current">\n            {{ item.name | translate }}\n        </div>\n\n        <mat-icon class="adf-breadcrumb-item-chevron" *ngIf="!last">\n            chevron_right\n        </mat-icon>\n    </div>\n</nav>\n\n<nav *ngIf="!folderNode && hasRoot" data-automation-id="breadcrumb" role="navigation">\n    <div class="adf-breadcrumb-item adf-active" role="listitem">\n        <div class="adf-breadcrumb-item-current">\n            {{ root | translate }}\n        </div>\n    </div>\n</nav>\n',encapsulation:y.ViewEncapsulation.None,host:{"class":"adf-breadcrumb"},styles:[""]}]}],Bn.propDecorators={folderNode:[{type:y.Input}],root:[{type:y.Input}],rootId:[{type:y.Input}],target:[{type:y.Input}],transform:[{type:y.Input}],dropdown:[{type:y.ViewChild,args:["dropdown"]}],maxItems:[{type:y.Input}],navigate:[{type:y.Output}]},Bn);function Bn(){this.folderNode=null,this.root=null,this.rootId=null,this.route=[],this.onDestroy$=new u.Subject,this.navigate=new y.EventEmitter}var Vn,jn=(C($n,Vn=Un),$n.prototype.recalculateNodes=function(){var e=this.transform?this.transform(this.folderNode):this.folderNode;this.route=this.parseRoute(e),this.currentNode=this.route[this.route.length-1],this.previousNodes=this.route.slice(0,this.route.length-1).reverse()},$n.prototype.open=function(){this.dropdown&&this.dropdown.open()},$n.prototype.hasPreviousNodes=function(){return 0<this.previousNodes.length},$n.decorators=[{type:y.Component,args:[{selector:"adf-dropdown-breadcrumb",template:'<ng-container *ngIf="route.length > 0" class="adf-dropdown-breadcrumb-container">\n\n    <button\n        tabindex="0"\n        class="adf-dropdown-breadcrumb-trigger"\n        (click)="open()"\n        data-automation-id="dropdown-breadcrumb-trigger">\n        <mat-icon [class.adf-isRoot]="!hasPreviousNodes()">folder</mat-icon>\n    </button>\n\n    <mat-icon class="adf-dropdown-breadcrumb-item-chevron">chevron_right</mat-icon>\n\n    <div class="adf-dropdown-breadcrumb-path">\n        <mat-select\n            #dropdown\n            *ngIf="hasPreviousNodes()"\n            tabindex="0"\n            data-automation-id="dropdown-breadcrumb-path">\n\n            <mat-option\n                *ngFor="let node of previousNodes;"\n                (click)="onRoutePathClick(node, $event)"\n                class="adf-dropdown-breadcrumb-path-option"\n                tabindex="0"\n                data-automation-class="dropdown-breadcrumb-path-option">\n                {{ node.name | translate }}\n            </mat-option>\n        </mat-select>\n    </div>\n\n    <span\n        class="adf-current-folder"\n        [class.adf-isRoot]="!hasPreviousNodes()"\n        data-automation-id="current-folder">{{ currentNode.name }}\n    </span>\n</ng-container>\n',encapsulation:y.ViewEncapsulation.None,host:{"class":"adf-dropdown-breadcrumb"},styles:[""]}]}],$n.propDecorators={dropdown:[{type:y.ViewChild,args:["dropdown"]}]},$n);function $n(){return null!==Vn&&Vn.apply(this,arguments)||this}var Hn=(Gn.decorators=[{type:y.NgModule,args:[{imports:[g.CommonModule,I,b.CoreModule.forChild()],exports:[Un,jn],declarations:[Un,jn]}]}],Gn);function Gn(){}var qn=(Yn.prototype.sanitizedHtmlContent=function(){return this.sanitizer.sanitize(y.SecurityContext.HTML,this.htmlContent)},Yn.decorators=[{type:y.Component,args:[{selector:"adf-confirm-dialog",template:'<h1 mat-dialog-title data-automation-id="adf-confirm-dialog-title">{{ title | translate }}</h1>\n<mat-dialog-content>\n    <p *ngIf="!htmlContent; else cutomContent" data-automation-id="adf-confirm-dialog-base-message">\n        {{ message | translate }}\n    </p>\n    <ng-template #cutomContent>\n        <span [innerHTML]="sanitizedHtmlContent()" data-automation-id="adf-confirm-dialog-custom-content">\n        </span>\n    </ng-template>\n</mat-dialog-content>\n<mat-dialog-actions>\n    <span class="adf-dialog-spacer" data-automation-id="adf-confirm-dialog-spacer"></span>\n    <button id="adf-confirm-accept" mat-button color="primary" data-automation-id="adf-confirm-dialog-confirmation"\n        [mat-dialog-close]="true">{{ yesLabel | translate }}</button>\n    <button id="adf-confirm-all" mat-button *ngIf="thirdOptionLabel" [mat-dialog-close]="thirdOptionLabel" data-automation-id="adf-confirm-dialog-confirm-all">{{ thirdOptionLabel | translate }}</button>\n    <button id="adf-confirm-cancel" mat-button [mat-dialog-close]="false" data-automation-id="adf-confirm-dialog-reject"\n        cdkFocusInitial>{{ noLabel | translate }}</button>\n</mat-dialog-actions>\n',host:{"class":"adf-confirm-dialog"},encapsulation:y.ViewEncapsulation.None,styles:[".adf-dialog-spacer{flex:1 1 auto}.adf-confirm-dialog .mat-dialog-actions .mat-button-wrapper{text-transform:uppercase}"]}]}],Yn.ctorParameters=function(){return[{type:undefined,decorators:[{type:y.Inject,args:[d.MAT_DIALOG_DATA]}]},{type:i.DomSanitizer}]},Yn);function Yn(e,t){this.sanitizer=t,e=e||{},this.title=e.title||"ADF_CONFIRM_DIALOG.CONFIRM",this.message=e.message||"ADF_CONFIRM_DIALOG.MESSAGE",this.yesLabel=e.yesLabel||"ADF_CONFIRM_DIALOG.YES_LABEL",this.thirdOptionLabel=e.thirdOptionLabel,this.noLabel=e.noLabel||"ADF_CONFIRM_DIALOG.NO_LABEL",this.htmlContent=e.htmlContent}var zn=(Qn.prototype.ngOnChanges=function(){this.loadVersionHistory()},Qn.prototype.canUpdate=function(){return this.contentService.hasAllowableOperations(this.node,"update")&&1<this.versions.length},Qn.prototype.canDelete=function(){return this.contentService.hasAllowableOperations(this.node,"delete")&&1<this.versions.length},Qn.prototype.restore=function(e){var t=this;this.canUpdate()&&this.versionsApi.revertVersion(this.node.id,e,{majorVersion:!0,comment:""}).then(function(){return t.alfrescoApi.nodesApi.getNodeInfo(t.node.id,{include:["permissions","path","isFavorite","allowableOperations"]})}).then(function(e){return t.onVersionRestored(e)})},Qn.prototype.loadVersionHistory=function(){var t=this;this.isLoading=!0,this.versionsApi.listVersionHistory(this.node.id).then(function(e){t.versions=e.list.entries,t.isLoading=!1})},Qn.prototype.downloadVersion=function(e){if(this.allowDownload){var t=this.getVersionContentUrl(this.node.id,e,!0);this.downloadContent(t)}},Qn.prototype.deleteVersion=function(t){var n=this;this.canUpdate()&&this.dialog.open(qn,{data:{title:"ADF_VERSION_LIST.CONFIRM_DELETE.TITLE",message:"ADF_VERSION_LIST.CONFIRM_DELETE.MESSAGE",yesLabel:"ADF_VERSION_LIST.CONFIRM_DELETE.YES_LABEL",noLabel:"ADF_VERSION_LIST.CONFIRM_DELETE.NO_LABEL"},minWidth:"250px"}).afterClosed().subscribe(function(e){!0===e&&n.alfrescoApi.versionsApi.deleteVersion(n.node.id,t).then(function(){return n.onVersionDeleted(n.node)})})},Qn.prototype.onVersionDeleted=function(e){this.loadVersionHistory(),this.deleted.emit(e)},Qn.prototype.onVersionRestored=function(e){this.loadVersionHistory(),this.restored.emit(e)},Qn.prototype.getVersionContentUrl=function(e,t,n){return this.alfrescoApi.contentApi.getContentUrl(e,n).replace("/content","/versions/"+t+"/content")},Qn.prototype.downloadContent=function(e){if(e){var t=document.createElement("a");t.style.display="none",t.href=e,document.body.appendChild(t),t.click(),document.body.removeChild(t)}},Qn.decorators=[{type:y.Component,args:[{selector:"adf-version-list",template:'<mat-list class="adf-version-list" *ngIf="!isLoading; else loading_template">\n    <mat-list-item *ngFor="let version of versions; let idx = index">\n        <mat-icon mat-list-icon>insert_drive_file</mat-icon>\n        <h4 mat-line class="adf-version-list-item-name" [id]="\'adf-version-list-item-name-\' + version.entry.id" >{{version.entry.name}}</h4>\n        <p mat-line>\n            <span class="adf-version-list-item-version"  [id]="\'adf-version-list-item-version-\' + version.entry.id" >{{version.entry.id}}</span> -\n            <span class="adf-version-list-item-date"     [id]="\'adf-version-list-item-date-\' + version.entry.id" >{{version.entry.modifiedAt | date}}</span>\n        </p>\n        <p mat-line [id]="\'adf-version-list-item-comment-\'+ version.entry.id" class="adf-version-list-item-comment"\n           *ngIf="showComments">{{version.entry.versionComment}}</p>\n\n        <div *ngIf="showActions">\n            <mat-menu [id]="\'adf-version-list-action-menu-\'+version.entry.id"\n                      #versionMenu="matMenu" yPosition="below" xPosition="before">\n                <button\n                    [id]="\'adf-version-list-action-restore-\'+version.entry.id"\n                    [disabled]="!canUpdate()"\n                    mat-menu-item\n                    (click)="restore(version.entry.id)">\n                    {{ \'ADF_VERSION_LIST.ACTIONS.RESTORE\' | translate }}\n                </button>\n                <button *ngIf="allowDownload"\n                        [id]="\'adf-version-list-action-download-\'+version.entry.id"\n                        mat-menu-item\n                        (click)="downloadVersion(version.entry.id)">\n                    {{ \'ADF_VERSION_LIST.ACTIONS.DOWNLOAD\' | translate }}\n                </button>\n                <button\n                    [disabled]="!canDelete()"\n                    [id]="\'adf-version-list-action-delete-\'+version.entry.id"\n                    (click)="deleteVersion(version.entry.id)"\n                    mat-menu-item>\n                    {{ \'ADF_VERSION_LIST.ACTIONS.DELETE\' | translate }}\n                </button>\n            </mat-menu>\n\n            <button mat-icon-button [matMenuTriggerFor]="versionMenu" [id]="\'adf-version-list-action-menu-button-\'+version.entry.id">\n                <mat-icon>more_vert</mat-icon>\n            </button>\n        </div>\n    </mat-list-item>\n</mat-list>\n\n<ng-template #loading_template>\n    <mat-progress-bar data-automation-id="version-history-loading-bar" mode="indeterminate"\n                      color="accent"></mat-progress-bar>\n</ng-template>\n',encapsulation:y.ViewEncapsulation.None,host:{"class":"adf-version-list"},styles:[".adf-version-list .mat-list-item-content{border-bottom:1px solid #d8d8d8}.adf-version-list-item-version{font-weight:700}.adf-version-list-item-date{opacity:.6}.adf-version-list-item-comment{opacity:.5}"]}]}],Qn.ctorParameters=function(){return[{type:b.AlfrescoApiService},{type:b.ContentService},{type:d.MatDialog}]},Qn.propDecorators={node:[{type:y.Input}],showComments:[{type:y.Input}],allowDownload:[{type:y.Input}],showActions:[{type:y.Input}],restored:[{type:y.Output}],deleted:[{type:y.Output}]},Qn);function Qn(e,t,n){this.alfrescoApi=e,this.contentService=t,this.dialog=n,this.versions=[],this.isLoading=!0,this.showComments=!0,this.allowDownload=!0,this.showActions=!0,this.restored=new y.EventEmitter,this.deleted=new y.EventEmitter,this.versionsApi=this.alfrescoApi.versionsApi}var Wn=(Xn.prototype.refresh=function(e){this.alfrescoApiService.nodeUpdated.next(e),this.versionListComponent.loadVersionHistory(),this.uploadSuccess.emit(e),this.uploadState="close"},Xn.prototype.onUploadSuccess=function(e){this.alfrescoApiService.nodeUpdated.next(e.value.entry),this.versionListComponent.loadVersionHistory(),this.uploadSuccess.emit(e.value.entry),this.uploadState="close"},Xn.prototype.onUploadError=function(e){this.uploadError.emit(e)},Xn.prototype.onUploadCancel=function(){this.uploadState="close"},Xn.prototype.toggleNewVersion=function(){this.uploadState="open"===this.uploadState?"close":"open"},Xn.prototype.canUpdate=function(){return this.contentService.hasAllowableOperations(this.node,"update")},Xn.decorators=[{type:y.Component,args:[{selector:"adf-version-manager",template:'<div class="adf-new-version-container">\n    <div class="adf-new-version-uploader-container" id="adf-new-version-uploader-container" fxLayout="row" fxLayoutAlign="end center" [@uploadToggle]="uploadState">\n        <table class="adf-version-upload" *ngIf="uploadState !== \'close\'">\n            <tr>\n                <td>\n                    <adf-version-upload\n                        id="adf-version-upload-button"\n                        [node]="node"\n                        (success)="onUploadSuccess($event)"\n                        (cancel)="onUploadCancel()"\n                        (error)="onUploadError($event)">\n                    </adf-version-upload>\n                </td>\n            </tr>\n        </table>\n    </div>\n\n    <div class="adf-version-list-container">\n        <div class="adf-version-list-table">\n            <div>\n                <button mat-raised-button\n                        id="adf-show-version-upload-button"\n                        (click)="toggleNewVersion()" color="primary"\n                        *ngIf="uploadState ===\'close\'">{{\n                    \'ADF_VERSION_LIST.ACTIONS.UPLOAD.ADD\'|\n                    translate }}\n                </button>\n            </div>\n            <div>\n\n                <adf-version-list\n                    #versionList\n                    [node]="node"\n                    [allowDownload]="allowDownload"\n                    [showComments]="showComments"\n                    (deleted)="refresh($event)"\n                    (restored)="refresh($event)">\n                </adf-version-list>\n            </div>\n        </div>\n    </div>\n</div>\n',animations:[o.trigger("uploadToggle",[o.state("open",o.style({height:"175px",opacity:1,visibility:"visible"})),o.state("close",o.style({height:"0%",opacity:0,visibility:"hidden"})),o.transition("open => close",[o.style({visibility:"hidden"}),o.animate("0.4s cubic-bezier(0.25, 0.8, 0.25, 1)")]),o.transition("close => open",[o.style({visibility:"visible"}),o.animate("0.4s cubic-bezier(0.25, 0.8, 0.25, 1)")])])],encapsulation:y.ViewEncapsulation.None,styles:["adf-version-manager .mat-list .mat-3-line{height:auto!important;width:100%!important}adf-version-manager .mat-list-item-content{padding:16px 0!important}.adf-version-list-item-comment.mat-line{height:100%;word-break:break-all;white-space:unset!important;overflow:unset!important}.adf-button.adf-upload-new-version{box-shadow:none;width:100%;height:175px;float:left;position:relative}.adf-new-version-uploader-container{padding:16px 0;width:100%;height:0%;position:relative;float:left!important}.adf-new-version-container{height:inherit;overflow:hidden}.adf-version-list-table,.adf-version-upload-table{width:100%}.adf-version-list{width:100%!important;float:left!important}"]}]}],Xn.ctorParameters=function(){return[{type:b.AppConfigService},{type:b.ContentService},{type:b.AlfrescoApiService}]},Xn.propDecorators={node:[{type:y.Input}],showComments:[{type:y.Input}],allowDownload:[{type:y.Input}],uploadSuccess:[{type:y.Output}],uploadError:[{type:y.Output}],versionListComponent:[{type:y.ViewChild,args:["versionList"]}]},Xn);function Xn(e,t,n){this.contentService=t,this.alfrescoApiService=n,this.showComments=!0,this.allowDownload=!0,this.uploadSuccess=new y.EventEmitter,this.uploadError=new y.EventEmitter,this.uploadState="close"}var Zn=(Kn.prototype.canUpload=function(){return this.contentService.hasAllowableOperations(this.node,"update")},Kn.prototype.isMajorVersion=function(){return"minor"!==this.semanticVersion},Kn.prototype.cancelUpload=function(){this.cancel.emit()},Kn.decorators=[{type:y.Component,args:[{selector:"adf-version-upload",template:'<div class="adf-new-version-max-width">\n    <mat-radio-group class="adf-new-version-radio-group" [(ngModel)]="semanticVersion">\n        <mat-radio-button class="adf-new-version-radio-button" id="adf-new-version-minor"[value]="\'minor\'">{{\n            \'ADF_VERSION_LIST.ACTIONS.UPLOAD.MINOR\' |\n            translate }}\n        </mat-radio-button>\n        <mat-radio-button class="adf-new-version-radio-button" id="adf-new-version-major" [value]="\'major\'">{{\n            \'ADF_VERSION_LIST.ACTIONS.UPLOAD.MAJOR\' |\n            translate }}\n        </mat-radio-button>\n    </mat-radio-group>\n    <mat-form-field class="adf-new-version-max-width">\n                    <textarea matInput [(ngModel)]="comment" class="adf-new-version-text-area" id="adf-new-version-text-area"\n                              placeholder="{{ \'ADF_VERSION_LIST.ACTIONS.UPLOAD.COMMENT\' | translate }}"></textarea>\n    </mat-form-field>\n\n</div>\n<div class="adf-version-upload-buttons">\n    <adf-upload-version-button\n        data-automation-id="adf-new-version-file-upload"\n        staticTitle="{{ \'ADF_VERSION_LIST.ACTIONS.UPLOAD.TITLE\' | translate }}"\n        [node]="node"\n        [disabled]="!canUpload()"\n        [rootFolderId]="node.parentId"\n        tooltip="{{ \'ADF_VERSION_LIST.ACTIONS.UPLOAD.TOOLTIP\' | translate }}"\n        [comment]="comment"\n        [versioning]="true"\n        [majorVersion]="isMajorVersion()"\n        (success)="success.emit($event)"\n        (error)="error.emit($event)">\n    </adf-upload-version-button>\n    <button mat-raised-button (click)="cancelUpload()" id="adf-new-version-cancel"  >{{\n        \'ADF_VERSION_LIST.ACTIONS.UPLOAD.CANCEL\'| translate }}\n    </button>\n</div>\n\n',encapsulation:y.ViewEncapsulation.None,host:{"class":"adf-version-upload"},styles:[".adf-new-version-radio-group{display:inline-flex;flex-direction:column}.adf-new-version-radio-button{margin:5px}.adf-version-upload-buttons{display:flex;float:right;justify-content:space-between;width:100%}.adf-new-version-max-width{width:100%;float:right}.adf-new-version-text-area{resize:none!important}"]}]}],Kn.ctorParameters=function(){return[{type:b.ContentService}]},Kn.propDecorators={node:[{type:y.Input}],success:[{type:y.Output}],error:[{type:y.Output}],cancel:[{type:y.Output}]},Kn);function Kn(e){this.contentService=e,this.semanticVersion="minor",this.uploadVersion=!1,this.success=new y.EventEmitter,this.error=new y.EventEmitter,this.cancel=new y.EventEmitter}var Jn=(ei.decorators=[{type:y.NgModule,args:[{imports:[g.CommonModule,I,b.CoreModule.forChild(),Bt,v.FormsModule],exports:[Zn,Wn,zn,v.FormsModule],declarations:[Zn,Wn,zn]}]}],ei);function ei(){}var ti=(ni.prototype.ngOnInit=function(){if(this.row){this.name=this.row.getValue("name");var e=this.row.getValue("path");e&&(this.path=e.name||"")}},ni.decorators=[{type:y.Component,args:[{selector:"adf-name-location-cell",template:'\n        <div class="adf-name-location-cell-name adf-datatable-cell-value" [title]="name">{{ name }}</div>\n        <div class="adf-name-location-cell-location adf-datatable-cell-value" [title]="path">{{ path }}</div>\n    ',encapsulation:y.ViewEncapsulation.None,changeDetection:y.ChangeDetectionStrategy.OnPush,host:{"class":"adf-name-location-cell adf-datatable-content-cell"},styles:[""]}]}],ni.propDecorators={row:[{type:y.Input}]},ni);function ni(){this.name="",this.path=""}var ii=(oi.prototype.search=function(e,t,n,i,o){void 0===t&&(t=null),void 0===n&&(n=0),void 0===i&&(i=25);var r="";o&&o.length&&o.filter(function(e){return e!==t}).forEach(function(e){r+=" OR ANCESTOR:'workspace://SpacesStore/"+e+"'"});var a={query:{query:e+"* OR name:"+e+"*"},include:["path","allowableOperations","properties"],paging:{maxItems:i,skipCount:n},filterQueries:N([{query:"TYPE:'cm:folder'"},{query:"NOT cm:creator:System"}],t?[{query:"ANCESTOR:'workspace://SpacesStore/"+t+"'"+r}]:[]),scope:{locations:["nodes"]}};return this.searchService.searchByQueryBody(a)},oi.decorators=[{type:y.Injectable,args:[{providedIn:"root"}]}],oi.ctorParameters=function(){return[{type:b.SearchService}]},oi.ngInjectableDef=y.defineInjectable({factory:function(){return new oi(y.inject(b.SearchService))},token:oi,providedIn:"root"}),oi);function oi(e){this.searchService=e}function ri(){return!0}var ai=(Object.defineProperty(si.prototype,"rowFilter",{get:function(){return this._rowFilter},set:function(e){this.createRowFilter(e)},enumerable:!0,configurable:!0}),Object.defineProperty(si.prototype,"excludeSiteContent",{get:function(){return this._excludeSiteContent},set:function(e){this._excludeSiteContent=e,this.createRowFilter(this._rowFilter)},enumerable:!0,configurable:!0}),Object.defineProperty(si.prototype,"chosenNode",{get:function(){return this._chosenNode},set:function(e){var t=null;(this._chosenNode=e)&&(t=[e]),this.select.next(t)},enumerable:!0,configurable:!0}),si.prototype.ngOnInit=function(){var t=this;this.searchInput.valueChanges.pipe(m.debounceTime(this.debounceSearch),m.takeUntil(this.onDestroy$)).subscribe(function(e){return t.search(e)}),this.userPreferencesService.select(b.UserPreferenceValues.PaginationSize).pipe(m.takeUntil(this.onDestroy$)).subscribe(function(e){return t.pageSize=e}),this.target=this.documentList,this.folderIdToShow=this.currentFolderId,this.breadcrumbTransform=this.breadcrumbTransform?this.breadcrumbTransform:null,this.isSelectionValid=this.isSelectionValid?this.isSelectionValid:ri},si.prototype.ngOnDestroy=function(){this.onDestroy$.next(!0),this.onDestroy$.complete()},si.prototype.createRowFilter=function(i){var o=this;i=i||function(){return!0},this._rowFilter=function(e,t,n){return i(e,t,n)&&!o.isExcludedSiteContent(e)}},si.prototype.isExcludedSiteContent=function(e){var t=e.node.entry;return!!(this._excludeSiteContent&&this._excludeSiteContent.length&&t&&t.properties&&t.properties["st:componentId"])&&!!this._excludeSiteContent.find(function(e){return t.properties["st:componentId"]===e})},si.prototype.siteChanged=function(e){this.siteId=e.entry.guid,this.setTitleIfCustomSite(e),this.updateResults()},si.prototype.search=function(e){this.searchTerm=e,this.updateResults()},Object.defineProperty(si.prototype,"breadcrumbFolderNode",{get:function(){return this.showingSearchResults&&this.chosenNode?this.chosenNode:this.documentList.folderNode},enumerable:!0,configurable:!0}),si.prototype.clear=function(){this.clearSearch(),this.folderIdToShow=this.siteId||this.currentFolderId},si.prototype.clearSearch=function(){this.searchTerm="",this.nodePaging=null,this.pagination.maxItems=this.pageSize,this.chosenNode=null,this.showingSearchResults=!1},si.prototype.updateResults=function(){this.target=0<this.searchTerm.length?null:this.documentList,0===this.searchTerm.length?this.clear():this.startNewSearch()},si.prototype.startNewSearch=function(){this.nodePaging=null,this.pagination.maxItems=this.pageSize,this.target&&this.infinitePaginationComponent.reset(),this.chosenNode=null,this.folderIdToShow=null,this.querySearch()},si.prototype.querySearch=function(){var t=this;this.loadingSearchResults=!0,this.customResourcesService.hasCorrespondingNodeIds(this.siteId)?this.customResourcesService.getCorrespondingNodeIds(this.siteId).subscribe(function(e){t.contentNodeSelectorService.search(t.searchTerm,t.siteId,t.pagination.skipCount,t.pagination.maxItems,e).subscribe(t.showSearchResults.bind(t))},function(){t.showSearchResults({list:{entries:[]}})}):this.contentNodeSelectorService.search(this.searchTerm,this.siteId,this.pagination.skipCount,this.pagination.maxItems).subscribe(this.showSearchResults.bind(this))},si.prototype.showSearchResults=function(e){this.showingSearchResults=!0,this.loadingSearchResults=!1,this.nodePaging=e},si.prototype.onFolderChange=function(){this.showingSearchResults=!1,this.infiniteScroll=!1,this.clearSearch()},si.prototype.onFolderLoaded=function(){this.showingSearchResults||this.attemptNodeSelection(this.documentList.folderNode)},si.prototype.showBreadcrumbs=function(){return!this.showingSearchResults||this.chosenNode},si.prototype.getNextPageOfSearch=function(e){this.infiniteScroll=!0,this.pagination=e,0<this.searchTerm.length&&this.querySearch()},si.prototype.attemptNodeSelection=function(e){e&&this.isSelectionValid(e)?this.chosenNode=e:this.resetChosenNode()},si.prototype.resetChosenNode=function(){this.chosenNode=null},si.prototype.onNodeSelect=function(e){this.attemptNodeSelection(e.detail.node.entry)},si.prototype.setTitleIfCustomSite=function(e){this.customResourcesService.isCustomSource(e.entry.guid)?this.breadcrumbFolderTitle=e.entry.title:this.breadcrumbFolderTitle=null},si.decorators=[{type:y.Component,args:[{selector:"adf-content-node-selector-panel",template:'<div class="adf-content-node-selector-content" (node-select)="onNodeSelect($event)">\n    <mat-form-field floatPlaceholder="never" class="adf-content-node-selector-content-input">\n        <input matInput\n            id="searchInput"\n            [formControl]="searchInput"\n            type="text"\n            placeholder="{{\'NODE_SELECTOR.SEARCH\' | translate}}"\n            [value]="searchTerm"\n            data-automation-id="content-node-selector-search-input">\n\n        <mat-icon *ngIf="searchTerm.length > 0"\n            matSuffix (click)="clear()"\n            class="adf-content-node-selector-content-input-icon"\n            data-automation-id="content-node-selector-search-clear">clear\n        </mat-icon>\n\n        <mat-icon *ngIf="searchTerm.length === 0"\n            matSuffix\n            class="adf-content-node-selector-content-input-icon"\n            data-automation-id="content-node-selector-search-icon">search\n        </mat-icon>\n\n    </mat-form-field>\n\n    <adf-sites-dropdown\n        class="full-width"\n        (change)="siteChanged($event)"\n        [placeholder]="\'NODE_SELECTOR.SELECT_LOCATION\'"\n        [hideMyFiles]="dropdownHideMyFiles"\n        [siteList]="dropdownSiteList"\n        data-automation-id="content-node-selector-sites-combo">\n    </adf-sites-dropdown>\n\n    <adf-toolbar>\n        <adf-toolbar-title>\n            <ng-container *ngIf="!showBreadcrumbs()">\n                <span class="adf-search-results-label">{{ \'NODE_SELECTOR.SEARCH_RESULTS\' | translate }}</span>\n            </ng-container>\n            <adf-dropdown-breadcrumb *ngIf="showBreadcrumbs()"\n                class="adf-content-node-selector-content-breadcrumb"\n                (navigate)="clearSearch()"\n                [target]="documentList"\n                [transform]="breadcrumbTransform"\n                [folderNode]="breadcrumbFolderNode"\n                [root]="breadcrumbFolderTitle"\n                data-automation-id="content-node-selector-content-breadcrumb">\n            </adf-dropdown-breadcrumb>\n        </adf-toolbar-title>\n    </adf-toolbar>\n\n    <div\n        class="adf-content-node-selector-content-list"\n        [class.adf-content-node-selector-content-list-searchLayout]="showingSearchResults"\n        data-automation-id="content-node-selector-content-list">\n        <adf-document-list\n            #documentList\n            [adf-highlight]="searchTerm"\n            adf-highlight-selector=".adf-name-location-cell-name"\n            [showHeader]="false"\n            [node]="nodePaging"\n            [maxItems]="pageSize"\n            [rowFilter]="_rowFilter"\n            [imageResolver]="imageResolver"\n            [currentFolderId]="folderIdToShow"\n            selectionMode="single"\n            [contextMenuActions]="false"\n            [contentActions]="false"\n            [allowDropFiles]="false"\n            [sorting]="\'server\'"\n            [where]="where"\n            (folderChange)="onFolderChange()"\n            (ready)="onFolderLoaded()"\n            data-automation-id="content-node-selector-document-list">\n\n            <adf-custom-empty-content-template>\n                <div>{{ \'NODE_SELECTOR.NO_RESULTS\' | translate }}</div>\n            </adf-custom-empty-content-template>\n\n            <data-columns>\n                <data-column key="$thumbnail" type="image"></data-column>\n                <data-column key="name" type="text" class="adf-full-width adf-ellipsis-cell">\n                    <ng-template let-context>\n                        <adf-name-location-cell [row]="context.row"></adf-name-location-cell>\n                    </ng-template>\n                </data-column>\n                <data-column key="modifiedAt" type="date" format="timeAgo" class="adf-content-selector-modified-cell"></data-column>\n                <data-column key="createdByUser.displayName" type="text" class="adf-content-selector-modifier-cell"></data-column>\n                <data-column key="visibility" type="text" class="adf-content-selector-visibility-cell"></data-column>\n            </data-columns>\n\n        </adf-document-list>\n\n        <adf-infinite-pagination\n            [target]="target"\n            [loading]="loadingSearchResults"\n            (loadMore)="getNextPageOfSearch($event)"\n            data-automation-id="content-node-selector-search-pagination">\n            {{ \'ADF-DOCUMENT-LIST.LAYOUT.LOAD_MORE\' | translate }}\n        </adf-infinite-pagination>\n    </div>\n</div>\n',encapsulation:y.ViewEncapsulation.None,host:{"class":"adf-content-node-selector-panel"},styles:[""]}]}],si.ctorParameters=function(){return[{type:ii},{type:R},{type:b.UserPreferencesService}]},si.propDecorators={currentFolderId:[{type:y.Input}],dropdownHideMyFiles:[{type:y.Input}],dropdownSiteList:[{type:y.Input}],where:[{type:y.Input}],rowFilter:[{type:y.Input}],excludeSiteContent:[{type:y.Input}],imageResolver:[{type:y.Input}],pageSize:[{type:y.Input}],isSelectionValid:[{type:y.Input}],breadcrumbTransform:[{type:y.Input}],select:[{type:y.Output}],documentList:[{type:y.ViewChild,args:["documentList"]}],highlighter:[{type:y.ViewChild,args:[b.HighlightDirective]}],infinitePaginationComponent:[{type:y.ViewChild,args:[b.InfinitePaginationComponent]}]},si);function si(e,t,n){this.contentNodeSelectorService=e,this.customResourcesService=t,this.userPreferencesService=n,this.DEFAULT_PAGINATION=new f.Pagination({maxItems:25,skipCount:0,totalItems:0,hasMoreItems:!1}),this.currentFolderId=null,this.dropdownHideMyFiles=!1,this.dropdownSiteList=null,this._rowFilter=ri,this._excludeSiteContent=[],this.imageResolver=null,this.pageSize=this.DEFAULT_PAGINATION.maxItems,this.isSelectionValid=ri,this.select=new y.EventEmitter,this.nodePaging=null,this.searchTerm="",this.showingSearchResults=!1,this.loadingSearchResults=!1,this.inDialog=!1,this._chosenNode=null,this.folderIdToShow=null,this.breadcrumbFolderTitle=null,this.pagination=this.DEFAULT_PAGINATION,this.infiniteScroll=!1,this.debounceSearch=200,this.searchInput=new v.FormControl,this.onDestroy$=new u.Subject}var li=(ci.decorators=[{type:y.NgModule,args:[{imports:[v.FormsModule,v.ReactiveFormsModule,b.CoreModule.forChild(),g.CommonModule,I,Mn,Hn,jt],exports:[ai,ti,M],entryComponents:[ai,M],declarations:[ai,ti,M]}]}],ci);
/*!
     * @license
     * Copyright 2019 Alfresco Software, Ltd.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *     http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function ci(){}var di="CORE.FOLDER_DIALOG.FOLDER_NAME.ERRORS";function pi(e){var t=e.value;return!/([\*\"\<\>\\\/\?\:\|])/.test(t)?null:{message:di+".SPECIAL_CHARACTERS"}}function ui(e){return"."!==(e.value||"").trim().split("").pop()?null:{message:di+".ENDING_DOT"}}function hi(e){return!!(e.value||"").trim()?null:{message:di+".ONLY_SPACES"}}var fi=(Object.defineProperty(mi.prototype,"editing",{get:function(){return!!this.data.folder},enumerable:!0,configurable:!0}),mi.prototype.ngOnInit=function(){var e=this.data.folder,t="",n="";if(e){var i=e.properties;t=e.name||"",n=i?i["cm:description"]:""}var o={name:[v.Validators.required,pi,ui,hi]};this.form=this.formBuilder.group({name:[t,o.name],description:[n]})},Object.defineProperty(mi.prototype,"name",{get:function(){return(this.form.value.name||"").trim()},enumerable:!0,configurable:!0}),Object.defineProperty(mi.prototype,"description",{get:function(){return(this.form.value.description||"").trim()},enumerable:!0,configurable:!0}),Object.defineProperty(mi.prototype,"properties",{get:function(){return{"cm:title":this.name,"cm:description":this.description}},enumerable:!0,configurable:!0}),mi.prototype.create=function(){var e=this,t=e.name,n=e.properties,i=e.nodeType,o=e.nodesApi,r=e.data.parentNodeId;return o.createFolder(r,{name:t,properties:n,nodeType:i})},mi.prototype.edit=function(){var e=this.name,t=this.properties,n=this.nodesApi,i=this.data.folder.id;return n.updateNode(i,{name:e,properties:t})},mi.prototype.submit=function(){var t=this,e=this.form,n=this.dialog,i=this.editing;e.valid&&(i?this.edit():this.create()).subscribe(function(e){t.success.emit(e),n.close(e)},function(e){return t.handleError(e)})},mi.prototype.handleError=function(e){var t="CORE.MESSAGES.ERRORS.GENERIC";try{409===JSON.parse(e.message).error.statusCode&&(t="CORE.MESSAGES.ERRORS.EXISTENT_FOLDER")}catch(n){}return this.error.emit(this.translation.instant(t)),e},mi.decorators=[{type:y.Component,args:[{selector:"adf-folder-dialog",template:'<h2 mat-dialog-title>\n    {{ (editing ? editTitle : createTitle) | translate }}\n</h2>\n\n<mat-dialog-content>\n    <form [formGroup]="form" (submit)="submit()">\n        <mat-form-field class="adf-full-width">\n            <input\n                id="adf-folder-name-input"\n                placeholder="{{ \'CORE.FOLDER_DIALOG.FOLDER_NAME.LABEL\' | translate }}"\n                matInput\n                required\n                [formControl]="form.controls[\'name\']"/>\n\n            <mat-hint *ngIf="form.controls[\'name\'].dirty">\n                <span *ngIf="form.controls[\'name\'].errors?.required">\n                    {{ \'CORE.FOLDER_DIALOG.FOLDER_NAME.ERRORS.REQUIRED\' | translate }}\n                </span>\n\n                <span *ngIf="!form.controls[\'name\'].errors?.required && form.controls[\'name\'].errors?.message">\n                    {{ form.controls[\'name\'].errors?.message | translate }}\n                </span>\n            </mat-hint>\n        </mat-form-field>\n\n        <br />\n        <br />\n\n        <mat-form-field class="adf-full-width">\n            <textarea\n                id="adf-folder-description-input"\n                matInput\n                placeholder="{{ \'CORE.FOLDER_DIALOG.FOLDER_DESCRIPTION.LABEL\' | translate }}"\n                rows="4"\n                [formControl]="form.controls[\'description\']"></textarea>\n        </mat-form-field>\n    </form>\n</mat-dialog-content>\n\n<mat-dialog-actions class="adf-dialog-buttons">\n    <span class="adf-fill-remaining-space"></span>\n\n    <button\n        mat-button\n        id="adf-folder-cancel-button"\n        mat-dialog-close>\n        {{ \'CORE.FOLDER_DIALOG.CANCEL_BUTTON.LABEL\' | translate }}\n    </button>\n\n    <button class="adf-dialog-action-button"\n            id="adf-folder-create-button"\n            mat-button\n            (click)="submit()"\n            [disabled]="!form.valid">\n        {{\n        (editing\n        ? \'CORE.FOLDER_DIALOG.UPDATE_BUTTON.LABEL\'\n        : \'CORE.FOLDER_DIALOG.CREATE_BUTTON.LABEL\'\n        ) | translate\n        }}\n    </button>\n</mat-dialog-actions>\n',styles:[".adf-fill-remaining-space{flex:1 1 auto}.adf-full-width,.adf-lock-file-name .mat-checkbox-layout{width:100%}.adf-lock-file-name .mat-checkbox-label{text-overflow:ellipsis;overflow:hidden}.adf-lock-file-name .mat-checkbox-inner-container{margin:auto 8px auto 0}"]}]}],mi.ctorParameters=function(){return[{type:v.FormBuilder},{type:d.MatDialogRef},{type:b.NodesApiService},{type:b.TranslationService},{type:undefined,decorators:[{type:y.Optional},{type:y.Inject,args:[d.MAT_DIALOG_DATA]}]}]},mi.propDecorators={error:[{type:y.Output}],success:[{type:y.Output}]},mi);function mi(e,t,n,i,o){this.formBuilder=e,this.dialog=t,this.nodesApi=n,this.translation=i,this.data=o,this.folder=null,this.error=new y.EventEmitter,this.success=new y.EventEmitter,this.editTitle="CORE.FOLDER_DIALOG.EDIT_FOLDER_TITLE",this.createTitle="CORE.FOLDER_DIALOG.CREATE_FOLDER_TITLE",this.nodeType="cm:folder",o&&(this.editTitle=o.editTitle||this.editTitle,this.createTitle=o.createTitle||this.createTitle,this.nodeType=o.nodeType||this.nodeType)}var gi=(yi.prototype.ngOnInit=function(){var t=this,e={id:[v.Validators.required,v.Validators.maxLength(72),this.forbidSpecialCharacters],title:[v.Validators.required,this.forbidOnlySpaces,v.Validators.minLength(2),v.Validators.maxLength(256)],description:[v.Validators.maxLength(512)]};this.form=this.formBuilder.group({title:[null,e.title],id:[null,e.id,this.createSiteIdValidator()],description:["",e.description]}),this.visibilityOption=this.visibilityOptions[0].value,this.form.controls.title.valueChanges.pipe(m.debounceTime(300),m.mergeMap(function(e){return t.checkLibraryNameExists(e)},function(e){return e}),m.takeUntil(this.onDestroy$)).subscribe(function(e){!t.form.controls.id.dirty&&t.canGenerateId(e)&&(t.form.patchValue({id:t.sanitize(e.trim())}),t.form.controls.id.markAsTouched())})},yi.prototype.ngOnDestroy=function(){this.onDestroy$.next(!0),this.onDestroy$.complete()},Object.defineProperty(yi.prototype,"title",{get:function(){return(this.form.value.title||"").trim()},enumerable:!0,configurable:!0}),Object.defineProperty(yi.prototype,"id",{get:function(){return(this.form.value.id||"").trim()},enumerable:!0,configurable:!0}),Object.defineProperty(yi.prototype,"description",{get:function(){return(this.form.value.description||"").trim()},enumerable:!0,configurable:!0}),Object.defineProperty(yi.prototype,"visibility",{get:function(){return this.visibilityOption||""},enumerable:!0,configurable:!0}),yi.prototype.submit=function(){var t=this,e=this.form,n=this.dialog;e.valid&&this.create().subscribe(function(e){t.success.emit(e),n.close(e)},function(e){return t.handleError(e)})},yi.prototype.visibilityChangeHandler=function(e){this.visibilityOption=e.value},yi.prototype.create=function(){var e=this.title,t={id:this.id,title:e,description:this.description,visibility:this.visibility};return u.from(this.alfrescoApiService.sitesApi.createSite(t))},yi.prototype.sanitize=function(e){return e.replace(/[\s\s]+/g,"-").replace(/[^A-Za-z0-9-]/g,"")},yi.prototype.canGenerateId=function(e){return Boolean(e.replace(/[^A-Za-z0-9-]/g,"").length)},yi.prototype.handleError=function(e){try{409===JSON.parse(e.message).error.statusCode&&this.form.controls.id.setErrors({message:"LIBRARY.ERRORS.CONFLICT"})}catch(e){}return e},yi.prototype.checkLibraryNameExists=function(n){return O(this,void 0,void 0,function(){var t;return D(this,function(e){switch(e.label){case 0:t=[],e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.findLibraryByTitle(n)];case 2:return t=e.sent().list.entries,[3,4];case 3:return e.sent(),t=[],[3,4];case 4:return t.length?this.libraryTitleExists=t[0].entry.title.toLowerCase()===n.toLowerCase():this.libraryTitleExists=!1,[2]}})})},yi.prototype.findLibraryByTitle=function(t){return O(this,void 0,void 0,function(){return D(this,function(e){return[2,this.alfrescoApiService.getInstance().core.queriesApi.findSites(t,{maxItems:1,fields:["title"]})]})})},yi.prototype.forbidSpecialCharacters=function(e){var t=e.value;return null===t||0===t.length?null:/[^A-Za-z0-9-]/.test(t)?{message:"LIBRARY.ERRORS.ILLEGAL_CHARACTERS"}:null},yi.prototype.forbidOnlySpaces=function(e){var t=e.value;return null===t||0===t.length?null:(t||"").trim()?null:{message:"LIBRARY.ERRORS.ONLY_SPACES"}},yi.prototype.createSiteIdValidator=function(){var n,i=this;return function(t){return n&&clearTimeout(n),new Promise(function(e){n=setTimeout(function(){return u.from(i.alfrescoApiService.sitesApi.getSite(t.value)).subscribe(function(){return e({message:"LIBRARY.ERRORS.EXISTENT_SITE"})},function(){return e(null)})},300)})}},yi.decorators=[{type:y.Component,args:[{selector:"adf-library-dialog",template:'<h2 mat-dialog-title>{{ createTitle | translate }}</h2>\n\n<mat-dialog-content>\n  <form novalidate [formGroup]="form" (submit)="submit()">\n    <mat-form-field>\n      <input\n        placeholder="{{ \'LIBRARY.DIALOG.FORM.NAME\' | translate }}"\n        required\n        matInput\n        autofocus\n        formControlName="title"\n        autocomplete="off"\n      />\n\n      <mat-hint *ngIf="libraryTitleExists">{{\n        \'LIBRARY.HINTS.SITE_TITLE_EXISTS\' | translate\n      }}</mat-hint>\n      <mat-error *ngIf="form.controls[\'title\'].hasError(\'maxlength\')">\n        {{ \'LIBRARY.ERRORS.TITLE_TOO_LONG\' | translate }}\n      </mat-error>\n\n      <mat-error *ngIf="form.controls[\'title\'].hasError(\'minlength\')">\n        {{ \'LIBRARY.ERRORS.TITLE_TOO_SHORT\' | translate }}\n      </mat-error>\n\n      <mat-error *ngIf="form.controls[\'title\'].errors?.message">\n        {{ form.controls[\'title\'].errors?.message | translate }}\n      </mat-error>\n    </mat-form-field>\n\n    <mat-form-field>\n      <input\n        required\n        placeholder="{{ \'LIBRARY.DIALOG.FORM.SITE_ID\' | translate }}"\n        matInput\n        formControlName="id"\n        autocomplete="off"\n      />\n\n      <mat-error *ngIf="form.controls[\'id\'].errors?.message">\n        {{ form.controls[\'id\'].errors?.message | translate }}\n      </mat-error>\n\n      <mat-error *ngIf="form.controls[\'id\'].hasError(\'maxlength\')">\n        {{ \'LIBRARY.ERRORS.ID_TOO_LONG\' | translate }}\n      </mat-error>\n    </mat-form-field>\n\n    <mat-form-field>\n      <textarea\n        matInput\n        placeholder="{{ \'LIBRARY.DIALOG.FORM.DESCRIPTION\' | translate }}"\n        rows="3"\n        formControlName="description"\n      ></textarea>\n\n      <mat-error *ngIf="form.controls[\'description\'].hasError(\'maxlength\')">\n        {{ \'LIBRARY.ERRORS.DESCRIPTION_TOO_LONG\' | translate }}\n      </mat-error>\n    </mat-form-field>\n\n    <mat-radio-group\n      [ngModelOptions]="{ standalone: true }"\n      [(ngModel)]="visibilityOption"\n      (change)="visibilityChangeHandler($event)"\n    >\n      <mat-radio-button\n        color="primary"\n        [disabled]="option.disabled"\n        *ngFor="let option of visibilityOptions"\n        [attr.data-automation-id]="option.value"\n        [value]="option.value"\n        [checked]="visibilityOption.value === option.value"\n      >\n        {{ option.label | translate }}\n      </mat-radio-button>\n    </mat-radio-group>\n  </form>\n</mat-dialog-content>\n\n<mat-dialog-actions class="adf-action-buttons">\n  <button mat-button mat-dialog-close data-automation-id="cancel-library-id">\n    {{ \'LIBRARY.DIALOG.CANCEL\' | translate }}\n  </button>\n\n  <button\n    color="primary"\n    mat-button\n    (click)="submit()"\n    [disabled]="!form.valid"\n    data-automation-id="create-library-id"\n  >\n    {{ \'LIBRARY.DIALOG.CREATE\' | translate }}\n  </button>\n</mat-dialog-actions>\n',encapsulation:y.ViewEncapsulation.None,host:{"class":"adf-library-dialog"},styles:[".adf-library-dialog .mat-radio-group{display:flex;flex-direction:column;margin:0 0 20px}.adf-library-dialog .mat-radio-group .mat-radio-button{margin:10px 0}.adf-library-dialog .mat-form-field{width:100%}.adf-library-dialog mat-form-field{padding-top:20px}.adf-library-dialog .adf-action-buttons{display:flex;flex-direction:row;justify-content:flex-end}.adf-library-dialog .adf-action-buttons .mat-button{text-transform:uppercase}"]}]}],yi.ctorParameters=function(){return[{type:b.AlfrescoApiService},{type:v.FormBuilder},{type:d.MatDialogRef}]},yi.propDecorators={error:[{type:y.Output}],success:[{type:y.Output}]},yi);function yi(e,t,n){this.alfrescoApiService=e,this.formBuilder=t,this.dialog=n,this.error=new y.EventEmitter,this.success=new y.EventEmitter,this.onDestroy$=new u.Subject,this.createTitle="LIBRARY.DIALOG.CREATE_TITLE",this.libraryTitleExists=!1,this.visibilityOptions=[{value:"PUBLIC",label:"LIBRARY.VISIBILITY.PUBLIC",disabled:!1},{value:"PRIVATE",label:"LIBRARY.VISIBILITY.PRIVATE",disabled:!1},{value:"MODERATED",label:"LIBRARY.VISIBILITY.MODERATED",disabled:!1}]}var vi=(bi.decorators=[{type:y.NgModule,args:[{imports:[g.CommonModule,I,b.CoreModule.forChild(),v.FormsModule,v.ReactiveFormsModule,a.MatMomentDatetimeModule,r.MatDatetimepickerModule],declarations:[fi,U,qn,gi],exports:[fi,U,qn,gi],entryComponents:[fi,U,qn,gi]}]}],bi);function bi(){}var Si=(Ii.prototype.onClick=function(e){e.preventDefault(),this.openDialog()},Object.defineProperty(Ii.prototype,"dialogConfig",{get:function(){var e=Ii.DIALOG_WIDTH;return{data:{parentNodeId:this.parentNodeId,createTitle:this.title,nodeType:this.nodeType},width:e+"px"}},enumerable:!0,configurable:!0}),Ii.prototype.openDialog=function(){var t=this,e=this.dialogRef,n=this.dialogConfig,i=this.content,o=e.open(fi,n);o.componentInstance.error.subscribe(function(e){t.error.emit(e)}),o.componentInstance.success.subscribe(function(e){t.success.emit(e)}),o.afterClosed().subscribe(function(e){e&&i.folderCreate.next(e)})},Ii.DIALOG_WIDTH=400,Ii.decorators=[{type:y.Directive,args:[{selector:"[adf-create-folder]"}]}],Ii.ctorParameters=function(){return[{type:d.MatDialog},{type:b.ContentService}]},Ii.propDecorators={parentNodeId:[{type:y.Input,args:["adf-create-folder"]}],title:[{type:y.Input}],nodeType:[{type:y.Input}],error:[{type:y.Output}],success:[{type:y.Output}],onClick:[{type:y.HostListener,args:["click",["$event"]]}]},Ii);function Ii(e,t){this.dialogRef=e,this.content=t,this.parentNodeId="-my-",this.title=null,this.nodeType="cm:folder",this.error=new y.EventEmitter,this.success=new y.EventEmitter}var Ei=(Ai.prototype.onClick=function(e){e.preventDefault(),this.folder&&this.openDialog()},Object.defineProperty(Ai.prototype,"dialogConfig",{get:function(){var e=Ai.DIALOG_WIDTH;return{data:{folder:this.folder,editTitle:this.title},width:e+"px"}},enumerable:!0,configurable:!0}),Ai.prototype.openDialog=function(){var t=this,e=this.dialogRef,n=this.dialogConfig,i=this.content,o=e.open(fi,n);o.componentInstance.error.subscribe(function(e){t.error.emit(e)}),o.componentInstance.success.subscribe(function(e){t.success.emit(e)}),o.afterClosed().subscribe(function(e){e&&i.folderEdit.next(e)})},Ai.DIALOG_WIDTH=400,Ai.decorators=[{type:y.Directive,args:[{selector:"[adf-edit-folder]"}]}],Ai.ctorParameters=function(){return[{type:d.MatDialog},{type:y.ElementRef},{type:b.ContentService}]},Ai.propDecorators={folder:[{type:y.Input,args:["adf-edit-folder"]}],error:[{type:y.Output}],title:[{type:y.Input}],success:[{type:y.Output}],onClick:[{type:y.HostListener,args:["click",["$event"]]}]},Ai);function Ai(e,t,n){this.dialogRef=e,this.elementRef=t,this.content=n,this.error=new y.EventEmitter,this.title=null,this.success=new y.EventEmitter}var Ci=(Ti.decorators=[{type:y.NgModule,args:[{imports:[g.CommonModule,I],declarations:[Si,Ei],exports:[Si,Ei]}]}],Ti);function Ti(){}var Oi=(Object.defineProperty(Di.prototype,"displayDefaultProperties",{get:function(){return this._displayDefaultProperties},set:function(e){this._displayDefaultProperties=e,this.onDisplayDefaultPropertiesChange()},enumerable:!0,configurable:!0}),Di.prototype.ngOnChanges=function(e){e.displayAspect&&e.displayAspect.currentValue&&(this.expanded=!0)},Di.prototype.onDisplayDefaultPropertiesChange=function(){this.expanded=!this._displayDefaultProperties},Di.prototype.toggleEdit=function(){this.editable=!this.editable},Di.prototype.toggleExpanded=function(){this.expanded=!this.expanded},Di.prototype.hasAllowableOperations=function(){return this.contentService.hasAllowableOperations(this.node,b.AllowableOperationsEnum.UPDATE)},Di.decorators=[{type:y.Component,args:[{selector:"adf-content-metadata-card",template:'<mat-card *ngIf="node">\n    <mat-card-content>\n        <adf-content-metadata\n            [displayDefaultProperties]="displayDefaultProperties"\n            [expanded]="expanded"\n            [node]="node"\n            [displayEmpty]="displayEmpty"\n            [editable]="editable"\n            [multi]="multi"\n            [displayAspect]="displayAspect"\n            [preset]="preset">\n        </adf-content-metadata>\n    </mat-card-content>\n    <mat-card-footer class="adf-content-metadata-card-footer" fxLayout="row" fxLayoutAlign="space-between stretch">\n        <div>\n            <button *ngIf="!readOnly && hasAllowableOperations()"\n                mat-icon-button\n                (click)="toggleEdit()"\n                [attr.title]="\'CORE.METADATA.ACTIONS.EDIT\' | translate"\n                data-automation-id="meta-data-card-toggle-edit">\n                <mat-icon>mode_edit</mat-icon>\n            </button>\n        </div>\n        <button *ngIf="displayDefaultProperties" mat-button (click)="toggleExpanded()" data-automation-id="meta-data-card-toggle-expand">\n            <ng-container *ngIf="expanded">\n                <span data-automation-id="meta-data-card-toggle-expand-label">{{ \'ADF_VIEWER.SIDEBAR.METADATA.MORE_INFORMATION\' | translate }}</span>\n                <mat-icon>keyboard_arrow_down</mat-icon>\n            </ng-container>\n            <ng-container *ngIf="!expanded">\n                <span data-automation-id="meta-data-card-toggle-expand-label">{{ \'ADF_VIEWER.SIDEBAR.METADATA.LESS_INFORMATION\' | translate }}</span>\n                <mat-icon>keyboard_arrow_up</mat-icon>\n            </ng-container>\n        </button>\n    </mat-card-footer>\n</mat-card>\n',encapsulation:y.ViewEncapsulation.None,host:{"class":"adf-content-metadata-card"},styles:[""]}]}],Di.ctorParameters=function(){return[{type:b.ContentService}]},Di.propDecorators={node:[{type:y.Input}],displayEmpty:[{type:y.Input}],displayAspect:[{type:y.Input}],preset:[{type:y.Input}],readOnly:[{type:y.Input}],multi:[{type:y.Input}],displayDefaultProperties:[{type:y.Input}]},Di);function Di(e){this.contentService=e,this.displayEmpty=!1,this.displayAspect=null,this.readOnly=!1,this.multi=!1,this._displayDefaultProperties=!0,this.editable=!1}var wi=(Li.prototype.getProperties=function(e){var t=e.content?e.content.sizeInBytes:"",n=e.content?e.content.mimeTypeName:"",i=e.properties?e.properties["cm:author"]:"",o=e.properties?e.properties["cm:description"]:"",r=e.properties?e.properties["cm:title"]:"";return[new b.CardViewTextItemModel({label:"CORE.METADATA.BASIC.NAME",value:e.name,key:"name",editable:!0}),new b.CardViewTextItemModel({label:"CORE.METADATA.BASIC.TITLE",value:r,key:"properties.cm:title",editable:!0}),new b.CardViewTextItemModel({label:"CORE.METADATA.BASIC.CREATOR",value:e.createdByUser.displayName,key:"createdByUser.displayName",editable:!1}),new b.CardViewDateItemModel({label:"CORE.METADATA.BASIC.CREATED_DATE",value:e.createdAt,key:"createdAt",editable:!1,format:"mediumDate"}),new b.CardViewTextItemModel({label:"CORE.METADATA.BASIC.SIZE",value:t,key:"content.sizeInBytes",pipes:[{pipe:this.fileSizePipe}],editable:!1}),new b.CardViewTextItemModel({label:"CORE.METADATA.BASIC.MODIFIER",value:e.modifiedByUser.displayName,key:"modifiedByUser.displayName",editable:!1}),new b.CardViewDateItemModel({label:"CORE.METADATA.BASIC.MODIFIED_DATE",value:e.modifiedAt,key:"modifiedAt",editable:!1,format:"mediumDate"}),new b.CardViewTextItemModel({label:"CORE.METADATA.BASIC.MIMETYPE",value:n,key:"content.mimeTypeName",editable:!1}),new b.CardViewTextItemModel({label:"CORE.METADATA.BASIC.AUTHOR",value:i,key:"properties.cm:author",editable:!0}),new b.CardViewTextItemModel({label:"CORE.METADATA.BASIC.DESCRIPTION",value:o,key:"properties.cm:description",multiline:!0,editable:!0})]},Li.decorators=[{type:y.Injectable,args:[{providedIn:"root"}]}],Li.ctorParameters=function(){return[{type:b.FileSizePipe}]},Li.ngInjectableDef=y.defineInjectable({factory:function(){return new Li(y.inject(b.FileSizePipe))},token:Li,providedIn:"root"}),Li);function Li(e){this.fileSizePipe=e}var Ni="d:mltext",Fi="d:datetime",Ri="d:float",ki="d:double",xi="d:boolean",Pi=(Mi.prototype.translateToCardViewGroups=function(e,n){var i=this;return e.map(function(e){var t=Object.assign({},e);return t.properties=i.translateArray(e.properties,n),t})},Mi.prototype.translateArray=function(e,t){var n=this;return e.map(function(e){return n.translate(e,t)})},Mi.prototype.translate=function(e,t){var n;t&&t[e.name]&&(n=t[e.name]),this.checkECMTypeValidity(e.dataType);var i,o={label:e.title||e.name,value:n,key:"properties."+e.name,"default":e.defaultValue,editable:!0};switch(e.dataType){case Ni:i=new b.CardViewTextItemModel(Object.assign(o,{multiline:!0}));break;case"d:int":case"d:long":i=new b.CardViewIntItemModel(o);break;case Ri:case ki:i=new b.CardViewFloatItemModel(Object.assign(o,{pipes:[{pipe:this.decimalNumberPipe}]}));break;case"d:date":i=new b.CardViewDateItemModel(o);break;case Fi:i=new b.CardViewDatetimeItemModel(o);break;case xi:i=new b.CardViewBoolItemModel(o);break;case"d:text":default:i=new b.CardViewTextItemModel(Object.assign(o,{multivalued:e.multiValued,multiline:e.multiValued,pipes:[{pipe:this.multiValuePipe,params:[this.valueSeparator]}]}))}return i},Mi.prototype.checkECMTypeValidity=function(e){-1===Mi.RECOGNISED_ECM_TYPES.indexOf(e)&&this.logService.error("Unknown type for mapping: "+e)},Mi.RECOGNISED_ECM_TYPES=["d:text",Ni,"d:date",Fi,"d:int","d:long",Ri,ki,xi],Mi.decorators=[{type:y.Injectable,args:[{providedIn:"root"}]}],Mi.ctorParameters=function(){return[{type:b.LogService},{type:b.MultiValuePipe},{type:b.DecimalNumberPipe},{type:b.AppConfigService}]},Mi.ngInjectableDef=y.defineInjectable({factory:function(){return new Mi(y.inject(b.LogService),y.inject(b.MultiValuePipe),y.inject(b.DecimalNumberPipe),y.inject(b.AppConfigService))},token:Mi,providedIn:"root"}),Mi);function Mi(e,t,n,i){this.logService=e,this.multiValuePipe=t,this.decimalNumberPipe=n,this.appConfig=i,this.valueSeparator=this.appConfig.get("content-metadata.multi-value-pipe-separator")}
/*!
     * @license
     * Copyright 2019 Alfresco Software, Ltd.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *     http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var _i={properties:{}};function Ui(e,t){return e[t]}function Bi(e,t,n){var i=Ui(e,t)||_i;return"*"===n?function o(t){return Object.keys(t).map(function(e){return t[e]})}(i.properties):i.properties[n]}var Vi=(ji.prototype.isGroupAllowed=function(e){return!!this.isIncludeAllEnabled()||-1!==Object.keys(this.config).indexOf(e)},ji.prototype.reorganiseByConfig=function(i){var o=this,e=this.config;return Object.keys(e).reduce(function(e,t){var n=o.getOrganisedPropertyGroup(i,t);return e.concat(n)},[]).filter(function(e){return 0<e.properties.length})},ji.prototype.appendAllPreset=function(i){return Object.keys(i).map(function(e){var t=i[e],n=t.properties;return Object.assign({},t,{properties:Object.keys(n).map(function(e){return n[e]})})})},ji.prototype.filterExcludedPreset=function(e){var t=this;return this.config.exclude?e.filter(function(e){return!t.config.exclude.includes(e.name)}):e},ji.prototype.isIncludeAllEnabled=function(){return this.config.includeAll},ji.prototype.getOrganisedPropertyGroup=function(t,n){var e=Ui(t,n),i=[];if(e){var o=this.config[n],r=void 0;r="*"===o?Bi(t,n,o):o.map(function(e){return Bi(t,n,e)}).filter(function(e){return e!==undefined}),i=[{title:e.title,properties:r}]}return i},ji);
/*!
     * @license
     * Copyright 2019 Alfresco Software, Ltd.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *     http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function ji(e){this.config=e}var $i=(Hi.prototype.isGroupAllowed=function(e){return!0},Hi.prototype.reorganiseByConfig=function(i){return Object.keys(i).map(function(e){var t=i[e],n=t.properties;return Object.assign({},t,{properties:Object.keys(n).map(function(e){return n[e]})})})},Hi.prototype.filterExcludedPreset=function(e){return e},Hi.prototype.appendAllPreset=function(e){return[]},Hi.prototype.isIncludeAllEnabled=function(){return!0},Hi);function Hi(e){}var Gi=(qi.prototype.isGroupAllowed=function(e){return!!this.isIncludeAllEnabled()||0<this.getMatchingGroups(e).length},qi.prototype.reorganiseByConfig=function(i){var n=this;return this.config.filter(function(e){return e.items}).map(function(e){var t=n.flattenItems(e.items).reduce(function(e,t){var n=Bi(i,t.groupName,t.propertyName)||[];return e.concat(n)},[]);return{title:e.title,properties:t}})},qi.prototype.appendAllPreset=function(i){return Object.keys(i).map(function(e){var t=i[e],n=t.properties;return Object.assign({},t,{properties:Object.keys(n).map(function(e){return n[e]})})})},qi.prototype.filterExcludedPreset=function(e){var t=this.config.map(function(e){return e.exclude}).find(function(e){return e!==undefined});return t===undefined?t=[]:"string"==typeof t&&(t=[t]),e.filter(function(e){return!t.includes(e.name)})},qi.prototype.isIncludeAllEnabled=function(){var e=this.config.map(function(e){return e.includeAll}).find(function(e){return e!==undefined});return e!==undefined&&e},qi.prototype.flattenItems=function(e){return e.reduce(function(e,t){var n=(Array.isArray(t.properties)?t.properties:[t.properties]).map(function(e){return{groupName:t.aspect||t.type,propertyName:e}});return e.concat(n)},[])},qi.prototype.getMatchingGroups=function(t){return this.config.map(function(e){return e.items}).reduce(function(e,t){return e.concat(t)},[]).filter(function(e){return e.aspect===t||e.type===t})},qi);function qi(e){this.config=e}var Yi=(zi.prototype.get=function(e){var t;void 0===e&&(e="default");try{t=this.appConfigService.config["content-metadata"].presets[e]}catch(n){e!==zi.DEFAULT_PRESET_NAME&&this.logService.error("No content-metadata preset for: "+e),t=zi.INDIFFERENT_PRESET}return this.createConfig(t)},zi.prototype.createConfig=function(e){var t;return t=this.isLayoutOrientedPreset(e)?new Gi(e):this.isAspectOrientedPreset(e)?new Vi(e):new $i(e),Object.freeze(t),t},zi.prototype.isAspectOrientedPreset=function(e){return this.isObject(e)},zi.prototype.isLayoutOrientedPreset=function(e){return Array.isArray(e)},zi.prototype.isObject=function(e){return null!=e&&"object"==typeof e},zi.INDIFFERENT_PRESET="*",zi.DEFAULT_PRESET_NAME="default",zi.decorators=[{type:y.Injectable,args:[{providedIn:"root"}]}],zi.ctorParameters=function(){return[{type:b.AppConfigService},{type:b.LogService}]},zi.ngInjectableDef=y.defineInjectable({factory:function(){return new zi(y.inject(b.AppConfigService),y.inject(b.LogService))},token:zi,providedIn:"root"}),zi);function zi(e,t){this.appConfigService=e,this.logService=t}var Qi=(Wi.prototype.load=function(e){var t=this,n=e.map(function(e){return e.replace(":","_")}).map(function(e){return u.defer(function(){return t.alfrescoApiService.classesApi.getClass(e)})});return u.forkJoin(n).pipe(m.map(this.convertToObject))},Wi.prototype.convertToObject=function(e){return e.reduce(function(e,t){var n;return Object.assign({},e,((n={})[t.name]=t,n))},{})},Wi.decorators=[{type:y.Injectable,args:[{providedIn:"root"}]}],Wi.ctorParameters=function(){return[{type:b.AlfrescoApiService}]},Wi.ngInjectableDef=y.defineInjectable({factory:function(){return new Wi(y.inject(b.AlfrescoApiService))},token:Wi,providedIn:"root"}),Wi);function Wi(e){this.alfrescoApiService=e}var Xi=(Zi.prototype.getBasicProperties=function(e){return u.of(this.basicPropertiesService.getProperties(e))},Zi.prototype.getGroupedProperties=function(t,e){var n=this;void 0===e&&(e="default");var i=u.of([]);if(t.aspectNames){var o=this.contentMetadataConfigFactory.get(e),r=t.aspectNames.concat(t.nodeType).filter(function(e){return o.isGroupAllowed(e)});0<r.length&&(i=this.propertyDescriptorsService.load(r).pipe(m.switchMap(function(e){return u.iif(function(){return o.isIncludeAllEnabled()},u.of(o.appendAllPreset(e).concat(o.reorganiseByConfig(e))),u.of(o.reorganiseByConfig(e)))}),m.map(function(e){return o.filterExcludedPreset(e)}),m.map(function(e){return n.filterEmptyPreset(e)}),m.map(function(e){return n.setTitleToNameIfNotSet(e)}),m.map(function(e){return n.propertyGroupTranslatorService.translateToCardViewGroups(e,t.properties)})))}return i},Zi.prototype.setTitleToNameIfNotSet=function(e){return e.map(function(e){e.title=e.title||e.name}),e},Zi.prototype.filterEmptyPreset=function(e){return e.filter(function(e){return e.properties.length})},Zi.decorators=[{type:y.Injectable,args:[{providedIn:"root"}]}],Zi.ctorParameters=function(){return[{type:wi},{type:Yi},{type:Pi},{type:Qi}]},Zi.ngInjectableDef=y.defineInjectable({factory:function(){return new Zi(y.inject(wi),y.inject(Yi),y.inject(Pi),y.inject(Qi))},token:Zi,providedIn:"root"}),Zi);function Zi(e,t,n,i){this.basicPropertiesService=e,this.contentMetadataConfigFactory=t,this.propertyGroupTranslatorService=n,this.propertyDescriptorsService=i,this.error=new u.Subject}var Ki=(Ji.prototype.ngOnInit=function(){var t=this;this.cardViewUpdateService.itemUpdated$.pipe(m.switchMap(function(e){return t.saveNode(e).pipe(m.catchError(function(e){return t.handleUpdateError(e),u.of(null)}))}),m.takeUntil(this.onDestroy$)).subscribe(function(e){e&&(Object.assign(t.node,e),t.alfrescoApiService.nodeUpdated.next(t.node))}),this.loadProperties(this.node)},Ji.prototype.handleUpdateError=function(e){this.logService.error(e);var t=0;try{t=JSON.parse(e.message).error.statusCode}catch(i){}var n="METADATA.ERRORS."+t;this.translationService.instant(n)===n&&(n="METADATA.ERRORS.GENERIC"),this.contentMetadataService.error.next({statusCode:t,message:n})},Ji.prototype.ngOnChanges=function(e){e.node&&!e.node.firstChange&&this.loadProperties(e.node.currentValue)},Ji.prototype.loadProperties=function(e){e&&(this.basicProperties$=this.contentMetadataService.getBasicProperties(e),this.groupedProperties$=this.contentMetadataService.getGroupedProperties(e,this.preset))},Ji.prototype.saveNode=function(e){var t=e.changed;return this.nodesApiService.updateNode(this.node.id,t)},Ji.prototype.showGroup=function(e){return 0<e.properties.filter(function(e){return!!e.displayValue}).length},Ji.prototype.ngOnDestroy=function(){this.onDestroy$.next(!0),this.onDestroy$.complete()},Ji.prototype.canExpandTheCard=function(e){return e.title===this.displayAspect},Ji.prototype.canExpandProperties=function(){return!this.expanded||"Properties"===this.displayAspect},Ji.decorators=[{type:y.Component,args:[{selector:"adf-content-metadata",template:'<div class="adf-metadata-properties">\n    <mat-accordion displayMode="flat" [multi]="multi">\n        <mat-expansion-panel\n            *ngIf="displayDefaultProperties"\n            [expanded]="canExpandProperties()"\n            [hideToggle]="canExpandProperties()"\n            [attr.data-automation-id]="\'adf-metadata-group-properties\'" >\n            <mat-expansion-panel-header>\n                <mat-panel-title>\n                    {{ \'CORE.METADATA.BASIC.HEADER\' | translate }}\n                </mat-panel-title>\n            </mat-expansion-panel-header>\n\n            <adf-card-view\n                [properties]="basicProperties$ | async"\n                [editable]="editable"\n                [displayEmpty]="displayEmpty">\n            </adf-card-view>\n        </mat-expansion-panel>\n\n        <ng-container *ngIf="expanded">\n            <ng-container *ngIf="groupedProperties$ | async; else loading; let groupedProperties">\n                <div *ngFor="let group of groupedProperties; let first = first;" class="adf-metadata-grouped-properties-container">\n                    <mat-expansion-panel *ngIf="showGroup(group) || editable"\n                    [attr.data-automation-id]="\'adf-metadata-group-\' + group.title"\n                    [expanded]="canExpandTheCard(group) || !displayDefaultProperties && first">\n                        <mat-expansion-panel-header>\n                            <mat-panel-title>\n                                {{ group.title | translate }}\n                            </mat-panel-title>\n                        </mat-expansion-panel-header>\n\n                        <adf-card-view\n                            [properties]="group.properties"\n                            [editable]="editable"\n                            [displayEmpty]="displayEmpty">\n                        </adf-card-view>\n                    </mat-expansion-panel>\n\n                </div>\n            </ng-container>\n            <ng-template #loading>\n                <mat-progress-bar mode="indeterminate"></mat-progress-bar>\n            </ng-template>\n        </ng-container>\n    </mat-accordion>\n</div>\n',host:{"class":"adf-content-metadata"},encapsulation:y.ViewEncapsulation.None,styles:[""]}]}],Ji.ctorParameters=function(){return[{type:Xi},{type:b.CardViewUpdateService},{type:b.NodesApiService},{type:b.LogService},{type:b.AlfrescoApiService},{type:b.TranslationService}]},Ji.propDecorators={node:[{type:y.Input}],editable:[{type:y.Input}],displayEmpty:[{type:y.Input}],expanded:[{type:y.Input}],multi:[{type:y.Input}],preset:[{type:y.Input}],displayDefaultProperties:[{type:y.Input}],displayAspect:[{type:y.Input}]},Ji);function Ji(e,t,n,i,o,r){this.contentMetadataService=e,this.cardViewUpdateService=t,this.nodesApiService=n,this.logService=i,this.alfrescoApiService=o,this.translationService=r,this.onDestroy$=new u.Subject,this.editable=!1,this.displayEmpty=!1,this.expanded=!1,this.multi=!1,this.displayDefaultProperties=!0,this.displayAspect=null}var eo=(to.decorators=[{type:y.NgModule,args:[{imports:[g.CommonModule,I,s.FlexLayoutModule,b.CoreModule.forChild()],exports:[Ki,Oi],declarations:[Ki,Oi]}]}],to);
/*!
     * @license
     * Copyright 2019 Alfresco Software, Ltd.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *     http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function to(){}var no=function zo(e){this.isInherited=!1,e&&(this.authorityId=e.authorityId,this.name=e.name,this.accessStatus=e.accessStatus,this.isInherited=null!==e.isInherited&&e.isInherited!==undefined&&e.isInherited,this.icon=e.icon?e.icon:"vpn_key")},io=(oo.prototype.getNodeRoles=function(n){var i=this,e=this.buildRetrieveSiteQueryBody(n.path.elements);return this.searchApiService.searchByQueryBody(e).pipe(m.switchMap(function(e){if(0<e.list.entries.length){var t=e.list.entries[0].entry.name;return i.getGroupMembersBySiteName(t)}return u.of(n.permissions.settable)}))},oo.prototype.updatePermissionRole=function(e,t){var n={permissions:{locallySet:[]}},i=e.permissions.locallySet.map(function(e){return e.authorityId}).indexOf(t.authorityId);return n.permissions.locallySet=n.permissions.locallySet.concat(e.permissions.locallySet),-1!==i?n.permissions.locallySet[i]=t:n.permissions.locallySet.push(t),this.nodeService.updateNode(e.id,n)},oo.prototype.updateNodePermissions=function(e,i){var o=this;return this.nodeService.getNode(e).pipe(m.switchMap(function(t){return o.getNodeRoles(t).pipe(m.switchMap(function(e){return u.of({node:t,nodeRoles:e})}))}),m.switchMap(function(e){var t=e.node,n=e.nodeRoles;return o.updateLocallySetPermissions(t,i,n)}))},oo.prototype.updateLocallySetPermissions=function(e,t,n){var i={permissions:{locallySet:[]}},o=this.transformNodeToPermissionElement(t,n[0]),r=this.getDuplicatedPermissions(e.permissions.locallySet,o);if(0<r.length){var a=r.map(function(e){return"authority -> "+e.authorityId+" / role -> "+e.name}).join(", "),s=this.translation.instant("PERMISSION_MANAGER.ERROR.DUPLICATE-PERMISSION",{list:a});return u.throwError(s)}return i.permissions.locallySet=e.permissions.locallySet?e.permissions.locallySet.concat(o):o,this.nodeService.updateNode(e.id,i)},oo.prototype.getDuplicatedPermissions=function(n,e){var i=this,o=[];return n&&e.forEach(function(t){var e=n.find(function(e){return i.isEqualPermission(e,t)});e&&o.push(e)}),o},oo.prototype.isEqualPermission=function(e,t){return e.accessStatus===t.accessStatus&&e.authorityId===t.authorityId&&e.name===t.name},oo.prototype.transformNodeToPermissionElement=function(e,t){return e.map(function(e){return{authorityId:e.entry.properties["cm:authorityName"]?e.entry.properties["cm:authorityName"]:e.entry.properties["cm:userName"],name:t,accessStatus:"ALLOWED"}})},oo.prototype.removePermission=function(e,t){var n={permissions:{locallySet:[]}},i=e.permissions.locallySet.map(function(e){return e.authorityId}).indexOf(t.authorityId);if(-1!==i)return e.permissions.locallySet.splice(i,1),n.permissions.locallySet=e.permissions.locallySet,this.nodeService.updateNode(e.id,n)},oo.prototype.getGroupMembersBySiteName=function(n){var i=this,e="GROUP_site_"+n;return this.getGroupMemberByGroupName(e).pipe(m.map(function(e){var t=[];return e.list.entries.forEach(function(e){t.push(i.formattedRoleName(e.entry.displayName,"site_"+n))}),t}))},oo.prototype.getGroupMemberByGroupName=function(e,t){return u.from(this.apiService.groupsApi.getGroupMembers(e,t))},oo.prototype.formattedRoleName=function(e,t){return e.replace(t+"_","")},oo.prototype.buildRetrieveSiteQueryBody=function(e){return{query:{query:e.map(function(e){return'name: "'+e.name+'"'}).join(" OR ")},paging:{maxItems:100,skipCount:0},include:["aspectNames","properties"],filterQueries:[{query:"TYPE:'st:site'"}]}},oo.decorators=[{type:y.Injectable,args:[{providedIn:"root"}]}],oo.ctorParameters=function(){return[{type:b.AlfrescoApiService},{type:b.SearchService},{type:b.NodesApiService},{type:b.TranslationService}]},oo.ngInjectableDef=y.defineInjectable({factory:function(){return new oo(y.inject(b.AlfrescoApiService),y.inject(b.SearchService),y.inject(b.NodesApiService),y.inject(b.TranslationService))},token:oo,providedIn:"root"}),oo);function oo(e,t,n,i){this.apiService=e,this.searchApiService=t,this.nodeService=n,this.translation=i}var ro=(ao.prototype.ngOnInit=function(){this.fetchNodePermissions()},ao.prototype.reload=function(){this.fetchNodePermissions()},ao.prototype.fetchNodePermissions=function(){var t=this;this.nodeService.getNode(this.nodeId).subscribe(function(e){t.actualNode=e,t.permissionList=t.getPermissionList(e),t.nodePermissionService.getNodeRoles(e).subscribe(function(e){t.settableRoles=e})})},ao.prototype.getPermissionList=function(e){var n=[];return e.permissions.locallySet&&e.permissions.locallySet.map(function(e){var t=new no(e);n.push(t)}),e.permissions.inherited&&e.permissions.inherited.map(function(e){var t=new no(e);t.isInherited=!0,n.push(t)}),n},ao.prototype.saveNewRole=function(e,t){var n=this,i=this.buildUpdatedPermission(e.value,t);this.nodePermissionService.updatePermissionRole(this.actualNode,i).subscribe(function(){n.update.emit(i)})},ao.prototype.buildUpdatedPermission=function(e,t){var n={};return n.accessStatus=t.accessStatus,n.name=e,n.authorityId=t.authorityId,n},ao.prototype.removePermission=function(e){var t=this;this.nodePermissionService.removePermission(this.actualNode,e).subscribe(function(e){return t.update.emit(e)},function(e){return t.error.emit(e)})},ao.decorators=[{type:y.Component,args:[{selector:"adf-permission-list",template:'<div id="adf-permission-display-container" class="adf-display-permission-container">\n\n    <div *ngIf="!permissionList || !permissionList.length" id="adf-no-permissions-template">\n        <div #ref>\n            <ng-content select="adf-no-permission-template"></ng-content>\n        </div>\n\n        <p *ngIf="ref.children.length == 0">\n            {{ \'PERMISSION_MANAGER.PERMISSION_DISPLAY.NO_PERMISSIONS\' | translate }}\n        </p>\n    </div>\n\n    <adf-datatable [rows]="permissionList" class="adf-datatable-permission" *ngIf="permissionList && permissionList.length">\n        <data-columns>\n            <data-column [class] = "\'adf-key-icon\'" key="icon" type="icon" [sortable]="false">\n            </data-column>\n            <data-column [class]= "\'adf-authorityId-label adf-ellipsis-cell adf-expand-cell-2\'" title="{{\'PERMISSION_MANAGER.PERMISSION_DISPLAY.AUTHORITY_ID\' | translate}}" key="authorityId"></data-column>\n            <data-column [class]="\'adf-ellipsis-cell adf-expand-cell-1\'" title="{{\'PERMISSION_MANAGER.PERMISSION_DISPLAY.ROLE\' | translate}}" key="name">\n                <ng-template let-entry="$implicit">\n                    <mat-form-field *ngIf="!entry.row.getValue(\'isInherited\') else show_only_label">\n                        <mat-select id="adf-select-role-permission"\n                                    [placeholder]="entry.data.getValue(entry.row, entry.col)"\n                                    value="{{entry.data.getValue(entry.row, entry.col)}}"\n                                    (selectionChange)="saveNewRole($event, entry.row.obj)">\n                          <mat-option *ngFor="let role of settableRoles" [value]="role">\n                            {{ role }}\n                          </mat-option>\n                        </mat-select>\n                      </mat-form-field>\n                      <ng-template #show_only_label>\n                          <span>{{entry.data.getValue(entry.row, entry.col)}}</span>\n                      </ng-template>\n                </ng-template>\n            </data-column>\n            <data-column [class]="\'adf-permission-label\'" title="{{\'PERMISSION_MANAGER.PERMISSION_DISPLAY.INHERITED\' | translate}}" key="isInherited">\n                <ng-template let-entry="$implicit">\n                    <mat-chip-list>\n                        <mat-chip [class]="\'mat-chip mat-primary mat-standard-chip mat-chip-selected adf-inherited-label \'"\n                                  *ngIf="!!entry.data.getValue(entry.row, entry.col) else locally_set_chip"\n                                id="adf-permission-inherited-label"\n                                color="primary" selected="true">{{\'PERMISSION_MANAGER.PERMISSION_DISPLAY.INHERITED\' | translate}}</mat-chip>\n                    </mat-chip-list>\n                    <ng-template #locally_set_chip>\n                            <mat-chip-list [class] = "\'adf-locallyset-label\'">\n                                    <mat-chip id="adf-permission-locallyset-label"\n                                              color="accent" selected="true">\n                                              {{\'PERMISSION_MANAGER.PERMISSION_DISPLAY.LOCALLY_SET\' | translate}}\n                                    </mat-chip>\n                            </mat-chip-list>\n                    </ng-template>\n                </ng-template>\n            </data-column>\n            <data-column [class]="\'adf-delete-permission\'" key="delete">\n            <ng-template let-entry="$implicit">\n                <button *ngIf="!entry.row.getValue(\'isInherited\')" mat-icon-button color="primary" (click)="removePermission(entry.row.obj)" data-automation-id="adf-delete-permission-button">\n                    <mat-icon>highlight_off</mat-icon>\n                </button>\n            </ng-template>\n        </data-column>\n        </data-columns>\n    </adf-datatable>\n</div>\n\n',encapsulation:y.ViewEncapsulation.None,styles:[""]}]}],ao.ctorParameters=function(){return[{type:b.NodesApiService},{type:io}]},ao.propDecorators={nodeId:[{type:y.Input}],update:[{type:y.Output}],error:[{type:y.Output}]},ao);function ao(e,t){this.nodeService=e,this.nodePermissionService=t,this.nodeId="",this.update=new y.EventEmitter,this.error=new y.EventEmitter}var so=(lo.decorators=[{type:y.Component,args:[{selector:"adf-no-permission-template",template:"<ng-content></ng-content>"}]}],lo);function lo(){}var co=(po.prototype.onInheritPermissionClicked=function(){var n=this;this.nodeService.getNode(this.nodeId).subscribe(function(e){if(n.contentService.hasAllowableOperations(e,b.AllowableOperationsEnum.UPDATEPERMISSIONS)){var t={permissions:{isInheritanceEnabled:!e.permissions.isInheritanceEnabled}};n.nodeService.updateNode(n.nodeId,t,{include:["permissions"]}).subscribe(function(e){n.updated.emit(e)},function(e){return n.error.emit(e)})}else n.error.emit("PERMISSION_MANAGER.ERROR.NOT-ALLOWED")})},po.decorators=[{type:y.Directive,args:[{selector:"button[adf-inherit-permission], mat-button-toggle[adf-inherit-permission]",host:{role:"button","(click)":"onInheritPermissionClicked()"}}]}],po.ctorParameters=function(){return[{type:b.NodesApiService},{type:b.ContentService}]},po.propDecorators={nodeId:[{type:y.Input}],updated:[{type:y.Output}],error:[{type:y.Output}]},po);function po(e,t){this.nodeService=e,this.contentService=t,this.updated=new y.EventEmitter,this.error=new y.EventEmitter}var uo=(ho.prototype.onSelect=function(e){this.currentSelection=e},ho.prototype.onAddClicked=function(){this.data.confirm.next(this.currentSelection),this.data.confirm.complete()},ho.decorators=[{type:y.Component,args:[{selector:"adf-add-permission-dialog",template:'<h2 mat-dialog-title id="add-permission-dialog-title">\n    {{(data?.title ? data?.title : \'PERMISSION_MANAGER.ADD-PERMISSION.BASE-DIALOG-TITLE\') | translate}}\n</h2>\n<mat-dialog-content>\n    <adf-add-permission-panel\n        (select)="onSelect($event)">\n    </adf-add-permission-panel>\n</mat-dialog-content>\n<mat-dialog-actions>\n    <button mat-button mat-dialog-close id="add-permission-dialog-close-button">{{\'PERMISSION_MANAGER.ADD-PERMISSION.CLOSE-ACTION\' | translate}}</button>\n    <button mat-button id="add-permission-dialog-confirm-button" [mat-dialog-close]="true"\n            class="adf-choose-action"\n            [disabled]="currentSelection?.length === 0"\n            (click)="onAddClicked()">{{\'PERMISSION_MANAGER.ADD-PERMISSION.ADD-ACTION\' | translate}}</button>\n</mat-dialog-actions>\n\n',encapsulation:y.ViewEncapsulation.None,styles:[""]}]}],ho.ctorParameters=function(){return[{type:undefined,decorators:[{type:y.Inject,args:[d.MAT_DIALOG_DATA]}]}]},ho.propDecorators={addPermissionComponent:[{type:y.ViewChild,args:["addPermission"]}]},ho);function ho(e){this.data=e,this.currentSelection=[]}var fo=(mo.prototype.openAddPermissionDialog=function(e,t){if(this.contentService.hasAllowableOperations(e,b.AllowableOperationsEnum.UPDATEPERMISSIONS)){var n=new u.Subject;n.subscribe({complete:this.close.bind(this)});var i={nodeId:e.id,title:t,confirm:n};return this.openDialog(i,"adf-add-permission-dialog","630px"),n}var o=new Error(JSON.stringify({error:{statusCode:403}}));return o.message="PERMISSION_MANAGER.ERROR.NOT-ALLOWED",u.throwError(o)},mo.prototype.openDialog=function(e,t,n){this.dialog.open(uo,{data:e,panelClass:t,width:n})},mo.prototype.close=function(){this.dialog.closeAll()},mo.prototype.updateNodePermissionByDialog=function(t,n){var i=this;return this.contentService.getNode(t,{include:["allowableOperations"]}).pipe(m.switchMap(function(e){return i.openAddPermissionDialog(e.entry,n).pipe(m.switchMap(function(e){return i.nodePermissionService.updateNodePermissions(t,e)}))}))},mo.decorators=[{type:y.Injectable,args:[{providedIn:"root"}]}],mo.ctorParameters=function(){return[{type:d.MatDialog},{type:io},{type:b.ContentService}]},mo.ngInjectableDef=y.defineInjectable({factory:function(){return new mo(y.inject(l.MatDialog),y.inject(io),y.inject(b.ContentService))},token:mo,providedIn:"root"}),mo);
/*!
     * @license
     * Copyright 2019 Alfresco Software, Ltd.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *     http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function mo(e,t,n){this.dialog=e,this.nodePermissionService=t,this.contentService=n}var go=(yo.prototype.generateQueryBody=function(e,t,n){return{query:{query:e?"authorityName:*"+e+"* OR userName:*"+e+"*":e},include:["properties","aspectNames"],paging:{maxItems:t,skipCount:n},filterQueries:[{query:"TYPE:'cm:authority'"}]}},yo);function yo(){}var vo=(bo.prototype.elementClicked=function(e){this.isAlreadySelected(e)?this.selectedItems.splice(this.selectedItems.indexOf(e),1):this.selectedItems.push(e),this.select.emit(this.selectedItems)},bo.prototype.isAlreadySelected=function(e){return 0<=this.selectedItems.indexOf(e)},bo.prototype.clearSearch=function(){this.searchedWord="",this.selectedItems.splice(0,this.selectedItems.length),this.search.resetResults()},bo.decorators=[{type:y.Component,args:[{selector:"adf-add-permission-panel",template:'<mat-form-field floatPlaceholder="never" class="adf-permission-search-input">\n    <input matInput\n        id="searchInput"\n        [formControl]="searchInput"\n        type="text"\n        placeholder="{{\'PERMISSION_MANAGER.ADD-PERMISSION.SEARCH\' | translate}}"\n        [value]="searchedWord">\n\n    <mat-icon *ngIf="searchedWord?.length > 0"\n        class="adf-permission-search-icon"\n        data-automation-id="adf-permission-clear-input"\n        id="adf-permission-clear-input"\n        matSuffix (click)="clearSearch()">clear\n    </mat-icon>\n\n    <mat-icon *ngIf="searchedWord?.length === 0"\n        class="adf-permission-search-icon"\n        data-automation-id="adf-permission-search-icon"\n        matSuffix>search\n    </mat-icon>\n</mat-form-field>\n\n<div *ngIf="searchedWord?.length === 0" id="adf-add-permission-type-search">\n    <span class="adf-permission-start-message">{{\'PERMISSION_MANAGER.ADD-PERMISSION.TYPE-MESSAGE\' | translate}}</span>\n</div>\n\n<adf-search #search [searchTerm]="searchedWord"\n        id="adf-add-permission-authority-results"\n        class="adf-permission-result-list"\n        [class.adf-permission-result-list-search]="searchedWord.length === 0">\n<ng-template let-data>\n    <mat-selection-list class="adf-permission-result-list-elements">\n        <mat-list-option\n            id="adf-add-permission-group-everyone"\n            class="adf-list-option-item"\n            (click)="elementClicked(EVERYONE)">\n            <mat-icon mat-list-icon id="add-group-icon">\n                group_add\n            </mat-icon>\n            <p>\n                {{\'PERMISSION_MANAGER.ADD-PERMISSION.EVERYONE\' | translate}}\n            </p>\n        </mat-list-option>\n\n        <mat-list-option *ngFor="let item of data?.list?.entries; let idx = index"\n                            (click)="elementClicked(item)"\n                            class="adf-list-option-item"\n                            id="result_option_{{idx}}">\n            <mat-icon mat-list-icon id="add-group-icon"\n                      *ngIf="item?.entry?.nodeType === \'cm:authorityContainer\' else show_person_icon">\n                      group_add\n            </mat-icon>\n            <ng-template #show_person_icon>\n                <mat-icon id="add-person-icon" mat-list-icon>person_add</mat-icon>\n            </ng-template>\n            <p>\n             {{item.entry?.properties[\'cm:authorityName\']?\n                                    item.entry?.properties[\'cm:authorityName\'] :\n                                    item.entry?.properties[\'cm:firstName\']}}</p>\n        </mat-list-option>\n    </mat-selection-list>\n</ng-template>\n</adf-search>\n',encapsulation:y.ViewEncapsulation.None,providers:[{provide:b.SearchConfigurationService,useClass:go},b.SearchService],styles:[""]}]}],bo.ctorParameters=function(){return[]},bo.propDecorators={search:[{type:y.ViewChild,args:["search"]}],select:[{type:y.Output}]},bo);function bo(){var t=this;this.select=new y.EventEmitter,this.searchInput=new v.FormControl,this.searchedWord="",this.debounceSearch=200,this.selectedItems=[],this.EVERYONE=new f.NodeEntry({entry:{properties:{"cm:authorityName":"GROUP_EVERYONE"}}}),this.searchInput.valueChanges.pipe(m.debounceTime(this.debounceSearch)).subscribe(function(e){(t.searchedWord=e)||t.search.resetResults()})}var So=(Io.prototype.onSelect=function(e){this.selectedItems=e},Io.prototype.isAddEnabled=function(){return this.contentService.hasAllowableOperations(this.currentNode,b.AllowableOperationsEnum.UPDATEPERMISSIONS)&&0!==this.selectedItems.length},Io.prototype.applySelection=function(){var t=this;this.contentService.hasAllowableOperations(this.currentNode,b.AllowableOperationsEnum.UPDATEPERMISSIONS)&&this.nodePermissionService.updateNodePermissions(this.nodeId,this.selectedItems).subscribe(function(e){t.success.emit(e)},function(e){t.error.emit(e)})},Io.decorators=[{type:y.Component,args:[{selector:"adf-add-permission",template:'<adf-add-permission-panel\n    (select)="onSelect($event)">\n</adf-add-permission-panel>\n<div id="adf-add-permission-actions">\n   <button mat-button\n          id="adf-add-permission-action-button"\n          class="adf-permission-action"\n          [disabled]="!isAddEnabled()"\n          (click)="applySelection()">\n     {{\'PERMISSION_MANAGER.ADD-PERMISSION.ADD-ACTION\' | translate}}\n    </button>\n</div>\n\n\n',encapsulation:y.ViewEncapsulation.None,styles:[""]}]}],Io.ctorParameters=function(){return[{type:io},{type:b.NodesApiService},{type:b.ContentService}]},Io.propDecorators={nodeId:[{type:y.Input}],success:[{type:y.Output}],error:[{type:y.Output}]},Io);function Io(e,t,n){var i=this;this.nodePermissionService=e,this.nodeApiService=t,this.contentService=n,this.success=new y.EventEmitter,this.error=new y.EventEmitter,this.selectedItems=[],this.nodeApiService.getNode(this.nodeId).subscribe(function(e){return i.currentNode=e})}var Eo=(Ao.decorators=[{type:y.NgModule,args:[{imports:[b.CoreModule.forChild(),g.CommonModule,v.FormsModule,v.ReactiveFormsModule,I,Fn],declarations:[ro,so,vo,co,So,uo],entryComponents:[vo,So,uo],exports:[ro,so,vo,co,So,uo]}]}],Ao);function Ao(){}var Co=(To.prototype.ngOnInit=function(){var t=this;if(this.type=this.appConfigService.get("sharedLinkDateTimePickerType","datetime"),this.canUpdate||this.form.controls.time.disable(),this.form.controls.time.valueChanges.pipe(m.skip(1),m.distinctUntilChanged(),m.mergeMap(function(e){return t.updateNode(e)},function(e){return e}),m.catchError(function(e){return u.throwError(e)}),m.takeUntil(this.onDestroy$)).subscribe(function(e){return t.updateEntryExpiryDate(e)}),this.data.node&&this.data.node.entry){this.fileName=this.data.node.entry.name,this.baseShareUrl=this.data.baseShareUrl;var e=this.data.node.entry.properties;e&&e["qshare:sharedId"]?(this.sharedId=e["qshare:sharedId"],this.isFileShared=!0,this.updateForm()):this.createSharedLinks(this.data.node.entry.id)}},To.prototype.ngOnDestroy=function(){this.onDestroy$.next(!0),this.onDestroy$.complete()},To.prototype.removeShare=function(){this.deleteSharedLink(this.sharedId)},To.prototype.onSlideShareChange=function(e){e.checked?this.createSharedLinks(this.data.node.entry.id):this.openConfirmationDialog()},Object.defineProperty(To.prototype,"canUpdate",{get:function(){var e=this.data.node.entry;return!e||!e.allowableOperations||this.contentService.hasAllowableOperations(e,"update")},enumerable:!0,configurable:!0}),To.prototype.onToggleExpirationDate=function(e){e.checked?this.matDatetimepickerToggle.datetimepicker.open():(this.matDatetimepickerToggle.datetimepicker.close(),this.form.controls.time.setValue(null))},To.prototype.onDatetimepickerClosed=function(){this.dateTimePickerInput.nativeElement.blur(),this.form.controls.time.value||(this.slideToggleExpirationDate.checked=!1)},To.prototype.openConfirmationDialog=function(){var t=this;this.isFileShared=!1,this.dialog.open(qn,{data:{title:"SHARE.CONFIRMATION.DIALOG-TITLE",message:"SHARE.CONFIRMATION.MESSAGE",yesLabel:"SHARE.CONFIRMATION.REMOVE",noLabel:"SHARE.CONFIRMATION.CANCEL"},minWidth:"250px",closeOnNavigation:!0}).beforeClose().subscribe(function(e){e?t.deleteSharedLink(t.sharedId):t.isFileShared=!0})},To.prototype.createSharedLinks=function(e){var t=this;this.isDisabled=!0,this.sharedLinksApiService.createSharedLinks(e).subscribe(function(e){e.entry&&(t.sharedId=e.entry.id,t.data.node.entry.properties?t.data.node.entry.properties["qshare:sharedId"]=t.sharedId:t.data.node.entry.properties={"qshare:sharedId":t.sharedId},t.isDisabled=!1,t.isFileShared=!0,t.renditionService.generateRenditionForNode(t.data.node.entry.id).subscribe(function(){}),t.updateForm())},function(){t.isDisabled=!1,t.isFileShared=!1})},To.prototype.deleteSharedLink=function(e){var t=this;this.isDisabled=!0,this.sharedLinksApiService.deleteSharedLink(e).subscribe(function(e){e instanceof Error?(t.isDisabled=!1,t.isFileShared=!0,t.handleError(e)):(t.data.node.entry.properties&&(t.data.node.entry.properties["qshare:sharedId"]=null,t.data.node.entry.properties["qshare:expiryDate"]=null),t.dialogRef.close(!1))})},To.prototype.handleError=function(e){var t="SHARE.UNSHARE_ERROR",n=0;try{n=JSON.parse(e.message).error.statusCode}catch(i){}403===n&&(t="SHARE.UNSHARE_PERMISSION_ERROR"),this.sharedLinksApiService.error.next({statusCode:n,message:t})},To.prototype.updateForm=function(){var e=this.data.node.entry,t=null;e&&e.properties&&(t=e.properties["qshare:expiryDate"]),this.form.setValue({sharedUrl:""+this.baseShareUrl+this.sharedId,time:t?c(t).local():null})},To.prototype.updateNode=function(e){return this.nodesApiService.updateNode(this.data.node.entry.id,{properties:{"qshare:expiryDate":e?"date"===this.type?e.endOf("day").utc().format():e.utc().format():null}})},To.prototype.updateEntryExpiryDate=function(e){var t=this.data.node.entry.properties;t&&(t["qshare:expiryDate"]=e?e.local():null)},To.decorators=[{type:y.Component,args:[{selector:"adf-share-dialog",template:'<div class="adf-share-link__dialog-content">\n    <h1 data-automation-id="adf-share-dialog-title" class="adf-share-link__title">\n        {{ \'SHARE.DIALOG-TITLE\' | translate }} {{ fileName }}\n    </h1>\n\n    <mat-dialog-content>\n        <p class="adf-share-link__info">{{ \'SHARE.DESCRIPTION\' | translate }}</p>\n\n        <div class="adf-share-link--row">\n            <h1 class="adf-share-link__label">{{ \'SHARE.TITLE\' | translate }}</h1>\n\n            <mat-slide-toggle color="primary" data-automation-id="adf-share-toggle" [checked]="isFileShared"\n                [disabled]="!canUpdate || isDisabled" (change)="onSlideShareChange($event)">\n            </mat-slide-toggle>\n        </div>\n\n        <form [formGroup]="form">\n            <mat-form-field class="adf-full-width">\n                <input #sharedLinkInput data-automation-id="adf-share-link" class="adf-share-link__input" matInput\n                    cdkFocusInitial placeholder="{{ \'SHARE.PUBLIC-LINK\' | translate }}" formControlName="sharedUrl"\n                    readonly="readonly">\n                <mat-icon class="adf-input-action" matSuffix\n                    [clipboard-notification]="\'SHARE.CLIPBOARD-MESSAGE\' | translate" [adf-clipboard]\n                    [target]="sharedLinkInput">\n                    link\n                </mat-icon>\n            </mat-form-field>\n\n            <div class="adf-share-link--row">\n            <h1 class="adf-share-link__label">{{ \'SHARE.EXPIRES\' | translate }}</h1>\n            <mat-slide-toggle [disabled]="!canUpdate" #slideToggleExpirationDate color="primary"\n                data-automation-id="adf-expire-toggle" [checked]="form.controls[\'time\'].value"\n                (change)="onToggleExpirationDate($event)">\n            </mat-slide-toggle>\n            </div>\n\n            <mat-form-field class="adf-full-width">\n                <mat-datetimepicker-toggle #matDatetimepickerToggle="matDatetimepickerToggle" [for]="datetimePicker" matSuffix></mat-datetimepicker-toggle>\n                <mat-datetimepicker #datetimePicker (closed)="onDatetimepickerClosed()" [type]="type" openOnFocus="true" timeInterval="1"></mat-datetimepicker>\n                <input class="adf-share-link__input"\n                    #dateTimePickerInput\n                    matInput\n                    [min]="minDate"\n                    formControlName="time"\n                    [matDatetimepicker]="datetimePicker" />\n            </mat-form-field>\n        </form>\n    </mat-dialog-content>\n\n    <div mat-dialog-actions>\n        <button data-automation-id="adf-share-dialog-close" mat-button color="primary" mat-dialog-close>\n            {{ \'SHARE.CLOSE\' | translate }}\n        </button>\n    </div>\n</div>\n',host:{"class":"adf-share-dialog"},encapsulation:y.ViewEncapsulation.None,styles:[".adf-share-link-dialog .adf-share-link__dialog-content{display:flex;flex-direction:column}.adf-share-link-dialog .adf-share-link__label{letter-spacing:-.4px;line-height:2;font-weight:400;font-style:normal;font-stretch:normal;font-size:16px;opacity:.87;flex:1 1 auto}.adf-share-link-dialog .adf-share-link__title{letter-spacing:-.4px;line-height:2;font-weight:400;font-style:normal;font-stretch:normal;font-size:16px;opacity:.87}.adf-share-link-dialog .adf-share-link__info{letter-spacing:-.4px;line-height:2;font-weight:400;font-style:normal;font-stretch:normal;opacity:.87;opacity:.54;font-size:13px}.adf-share-link-dialog .adf-share-link--row{display:flex;flex-direction:row;flex-wrap:wrap;align-items:center}.adf-share-link-dialog .adf-share-link__input{opacity:.54}.adf-share-link-dialog .adf-input-action{cursor:pointer}.adf-share-link-dialog .adf-full-width{width:100%}.adf-share-link-dialog .mat-form-field-infix{border-top:unset}.adf-share-link-dialog .mat-dialog-actions{justify-content:flex-end}.adf-share-link-dialog .mat-dialog-actions>button{text-transform:uppercase}.adf-share-link-dialog .mat-form-field-flex{align-items:center}"]}]}],To.ctorParameters=function(){return[{type:b.AppConfigService},{type:b.SharedLinksApiService},{type:d.MatDialogRef},{type:d.MatDialog},{type:b.NodesApiService},{type:b.ContentService},{type:b.RenditionsService},{type:undefined,decorators:[{type:y.Inject,args:[d.MAT_DIALOG_DATA]}]}]},To.propDecorators={matDatetimepickerToggle:[{type:y.ViewChild,args:["matDatetimepickerToggle"]}],slideToggleExpirationDate:[{type:y.ViewChild,args:["slideToggleExpirationDate"]}],dateTimePickerInput:[{type:y.ViewChild,args:["dateTimePickerInput"]}]},To);function To(e,t,n,i,o,r,a,s){this.appConfigService=e,this.sharedLinksApiService=t,this.dialogRef=n,this.dialog=i,this.nodesApiService=o,this.contentService=r,this.renditionService=a,this.data=s,this.minDate=c().add(1,"d"),this.isFileShared=!1,this.isDisabled=!1,this.form=new v.FormGroup({sharedUrl:new v.FormControl(""),time:new v.FormControl({value:"",disabled:!1})}),this.type="datetime",this.onDestroy$=new u.Subject}var Oo=(Do.prototype.ngOnDestroy=function(){this.onDestroy$.next(!0),this.onDestroy$.complete()},Do.prototype.shareNode=function(e){var t=this;if(e&&e.entry&&e.entry.isFile){var n=e.entry.nodeId||e.entry.guid;n?this.getNodeInfo(n).subscribe(function(e){t.openShareLinkDialog({entry:e})}):this.openShareLinkDialog(e)}},Do.prototype.getNodeInfo=function(e){return u.from(this.alfrescoApiService.nodesApi.getNodeInfo(e,{include:["allowableOperations"]}))},Do.prototype.openShareLinkDialog=function(e){this.dialog.open(Co,{width:"600px",panelClass:"adf-share-link-dialog",data:{node:e,baseShareUrl:this.baseShareUrl}})},Do.prototype.ngOnChanges=function(){var e=this;this.zone.onStable.pipe(m.takeUntil(this.onDestroy$)).subscribe(function(){e.node&&e.node.entry&&(e.isFile=e.node.entry.isFile,e.isShared=!!e.node.entry.properties&&e.node.entry.properties["qshare:sharedId"])})},Do.prototype.onClick=function(){this.node&&this.shareNode(this.node)},Do.decorators=[{type:y.Directive,args:[{selector:"[adf-share]",exportAs:"adfShare"}]}],Do.ctorParameters=function(){return[{type:d.MatDialog},{type:y.NgZone},{type:b.AlfrescoApiService}]},Do.propDecorators={node:[{type:y.Input,args:["adf-share"]}],baseShareUrl:[{type:y.Input}],onClick:[{type:y.HostListener,args:["click"]}]},Do);function Do(e,t,n){this.dialog=e,this.zone=t,this.alfrescoApiService=n,this.isFile=!1,this.isShared=!1,this.onDestroy$=new u.Subject}var wo=(Lo.forRoot=function(){return{ngModule:Lo}},Lo.forChild=function(){return{ngModule:Lo}},Lo.decorators=[{type:y.NgModule,args:[{imports:[b.CoreModule.forChild(),g.CommonModule,I],declarations:[Co,Oo],exports:[Co,Oo],entryComponents:[Co]}]}],Lo);function Lo(){}var No=function Qo(e,t,n){this.expandable=!0,this.name=e.entry.name,this.nodeId=e.entry.id,this.level=t||0,this.expandable=n||!0,this.node=e?new f.NodeEntry(e):undefined},Fo=(Ro.prototype.getTreeNodes=function(e){return this.nodeApi.getNodeChildren(e).pipe(m.map(function(e){return e.list.entries.filter(function(e){return e.entry.isFolder?e:null})}),m.map(function(e){return e.map(function(e){return new No(e)})}))},Ro.decorators=[{type:y.Injectable,args:[{providedIn:"root"}]}],Ro.ctorParameters=function(){return[{type:b.NodesApiService}]},Ro.ngInjectableDef=y.defineInjectable({factory:function(){return new Ro(y.inject(b.NodesApiService))},token:Ro,providedIn:"root"}),Ro);function Ro(e){this.nodeApi=e}var ko=(Object.defineProperty(xo.prototype,"data",{get:function(){return this.treeNodes},set:function(e){this.treeControl.dataNodes=e,this.dataChange.next(e)},enumerable:!0,configurable:!0}),xo.prototype.connect=function(e){var t=this;return this.changeSubscription=this.treeControl.expansionModel.onChange.subscribe(function(e){e.added&&0<e.added.length?t.expandTreeNodes(e):e.removed&&t.reduceTreeNodes(e)}),u.merge(e.viewChange,this.dataChange).pipe(m.map(function(){return t.data}))},xo.prototype.disconnect=function(){this.childrenSubscription&&this.childrenSubscription.unsubscribe(),this.changeSubscription&&this.changeSubscription.unsubscribe()},xo.prototype.expandTreeNodes=function(e){var t=this;e.added.forEach(function(e){return t.expandNode(e)})},xo.prototype.reduceTreeNodes=function(e){var t=this;e.removed.slice().reverse().forEach(function(e){return t.toggleNode(e)})},xo.prototype.expandNode=function(o){var r=this;this.childrenSubscription=this.treeViewService.getTreeNodes(o.nodeId).subscribe(function(e){var t,n=r.data.indexOf(o);if(!e||n<0)o.expandable=!1;else{var i=e.map(function(e){return e.level=o.level+1,e});(t=r.data).splice.apply(t,N([n+1,0],i)),r.dataChange.next(r.data)}})},xo.prototype.toggleNode=function(e){for(var t=this.data.indexOf(e),n=0,i=t+1;i<this.data.length&&this.data[i].level>e.level;i++,n++);this.data.splice(t+1,n),this.dataChange.next(this.data)},xo.decorators=[{type:y.Injectable}],xo.ctorParameters=function(){return[{type:h.FlatTreeControl},{type:Fo}]},xo);function xo(e,t){var n=this;this.treeControl=e,this.treeViewService=t,this.dataChange=new u.BehaviorSubject([]),this.childrenSubscription=null,this.changeSubscription=null,this.dataChange.subscribe(function(e){return n.treeNodes=e})}var Po=(Mo.prototype.ngOnChanges=function(e){e.nodeId&&e.nodeId.currentValue&&e.nodeId.currentValue!==e.nodeId.previousValue?this.loadTreeNode():this.dataSource.data=[]},Mo.prototype.onNodeClicked=function(e){this.nodeClicked.emit(e)},Mo.prototype.loadTreeNode=function(){var t=this;this.treeViewService.getTreeNodes(this.nodeId).subscribe(function(e){t.dataSource.data=e},function(e){return t.error.emit(e)})},Mo.decorators=[{type:y.Component,args:[{selector:"adf-tree-view-list",template:'<mat-tree class="adf-tree-view-main" [dataSource]="dataSource"\n          [treeControl]="treeControl" *ngIf="nodeId; else missingNodeId">\n    <mat-tree-node class="adf-tree-view-node"\n        *matTreeNodeDef="let treeNode" id="{{treeNode.name + \'-tree-node\'}}"\n        matTreeNodePadding [matTreeNodePaddingIndent]="15">\n        {{treeNode.name}}\n    </mat-tree-node>\n    <mat-tree-node class="adf-tree-view-node"\n        id="{{treeNode.name + \'-tree-child-node\'}}" *matTreeNodeDef="let treeNode; when: hasChild"\n        matTreeNodePadding [matTreeNodePaddingIndent]="15">\n        <button id="{{\'button-\'+treeNode.name}}" (click)="onNodeClicked(treeNode.node)"\n                mat-icon-button [attr.aria-label]="\'toggle \' + treeNode.filename" matTreeNodeToggle>\n            <mat-icon class="adf-tree-view-icon">\n                {{treeControl.isExpanded(treeNode) ? \'folder_open\' : \'folder\'}}\n            </mat-icon>\n        </button>\n        {{treeNode.name}}\n    </mat-tree-node>\n</mat-tree>\n<ng-template #missingNodeId>\n    <div id="adf-tree-view-missing-node">\n        {{\'ADF-TREE-VIEW.MISSING-ID\' | translate}}\n    </div>\n</ng-template>\n',styles:[""]}]}],Mo.ctorParameters=function(){return[{type:Fo}]},Mo.propDecorators={nodeId:[{type:y.Input}],nodeClicked:[{type:y.Output}],error:[{type:y.Output}]},Mo);function Mo(e){this.treeViewService=e,this.nodeClicked=new y.EventEmitter,this.error=new y.EventEmitter,this.getLevel=function(e){return e.level},this.isExpandable=function(e){return e.expandable},this.hasChild=function(e,t){return t.expandable},this.treeControl=new h.FlatTreeControl(this.getLevel,this.isExpandable),this.dataSource=new ko(this.treeControl,this.treeViewService)}var _o=(Uo.decorators=[{type:y.NgModule,args:[{imports:[g.CommonModule,I,p.TranslateModule.forChild()],declarations:[Po],exports:[Po]}]}],Uo);function Uo(){}var Bo=(Vo.decorators=[{type:y.NgModule,args:[{imports:[b.CoreModule.forChild(),K,le,g.CommonModule,ue,v.FormsModule,v.ReactiveFormsModule,vi,Fn,jt,Bt,I,Mn,Hn,li,wo,eo,Ci,G,Eo,Jn,_o],exports:[K,le,ue,jt,Bt,Fn,Mn,Hn,li,wo,eo,vi,Ci,G,Eo,Jn,_o]}]}],Vo);function Vo(){}var jo={name:"adf-content-services",source:"assets/adf-content-services"},$o=(Ho.forRoot=function(){return{ngModule:Ho,providers:[{provide:b.TRANSLATION_PROVIDER,multi:!0,useValue:{name:"adf-content-services",source:"assets/adf-content-services"}}]}},Ho.forChild=function(){return{ngModule:Bo}},Ho.decorators=[{type:y.NgModule,args:[{imports:[b.CoreModule.forChild(),K,le,g.CommonModule,ue,v.FormsModule,v.ReactiveFormsModule,vi,Fn,jt,Bt,I,Mn,Hn,li,wo,eo,Ci,G,Eo,Jn,_o],providers:[{provide:b.TRANSLATION_PROVIDER,multi:!0,useValue:jo}],exports:[K,le,ue,jt,Bt,Fn,Mn,Hn,li,wo,eo,vi,Ci,G,Eo,Jn,_o]}]}],Ho);function Ho(){}e.ContentDirectiveModule=G,e.RatingComponent=Q,e.LikeComponent=X,e.RatingService=Y,e.SocialModule=K,e.TagActionsComponent=ne,e.TagListComponent=oe,e.TagNodeListComponent=ae,e.TagService=ee,e.TagModule=le,e.WebscriptComponent=de,e.WebScriptModule=ue,e.DocumentListComponent=ke,e.NodeEntityEvent=we,e.NodeEntryEvent=Fe,e.ContentColumnComponent=_e,e.ContentColumnListComponent=Pe,e.ContentActionComponent=Qe,e.ContentActionListComponent=Ye,e.LibraryNameColumnComponent=Xe,e.LibraryRoleColumnComponent=Ke,e.LibraryStatusColumnComponent=et,e.NameColumnComponent=nt,e.TrashcanNameColumnComponent=ot,e.ShareDataTableAdapter=ge,e.ShareDataRow=fe,e.FolderActionsService=Ge,e.DocumentActionsService=$e,e.DocumentListService=x,e.NodeActionsService=Ve,e.CustomResourcesService=R,e.ContentActionModel=Se,e.ContentActionTarget=Ie,e.DocumentActionModel=Ee,e.FolderActionModel=Te,e.NodePaging=at,e.NodePagingList=st,e.NodeMinimalEntry=lt,e.Pagination=ct,e.NodeMinimal=dt,e.UserInfo=pt,e.ContentInfo=ut,e.PathInfoEntity=ht,e.PathElementEntity=ft,e.PermissionModel=Be,e.PermissionStyleModel=mt,e.DocumentListModule=jt,e.UploadButtonComponent=Dt,e.UploadVersionButtonComponent=Nt,e.FileUploadingDialogComponent=gt,e.UploadDragAreaComponent=kt,e.FileUploadingListComponent=St,e.FileUploadingListRowComponent=vt,e.UploadFilesEvent=Et,e.FileDraggableDirective=_t,e.FileUploadErrorPipe=Pt,e.UploadBase=Ct,e.UploadModule=Bt,e.SearchQueryBuilderService=Ht,e.SearchComponent=qt,e.SearchControlComponent=Xt,e.SEARCH_AUTOCOMPLETE_VALUE_ACCESSOR=Kt,e.SearchTriggerDirective=Jt,e.EmptySearchResultComponent=Qt,e.SearchFilterComponent=on,e.SearchFilterService=En,e.SearchChipListComponent=Cn,e.SearchSortingPickerComponent=On,e.ALFRESCO_SEARCH_DIRECTIVES=Nn,e.SearchModule=Fn,e.Relations=kn,e.DropdownSitesComponent=xn,e.SitesDropdownModule=Mn,e.BreadcrumbComponent=Un,e.DropdownBreadcrumbComponent=jn,e.BreadcrumbModule=Hn,e.VersionListComponent=zn,e.VersionManagerComponent=Wn,e.VersionUploadComponent=Zn,e.VersionManagerModule=Jn,e.NameLocationCellComponent=ti,e.ContentNodeSelectorPanelComponent=ai,e.ContentNodeSelectorComponent=M,e.ContentNodeSelectorService=ii,e.ContentNodeDialogService=V,e.ContentNodeSelectorModule=li,e.FolderDialogComponent=fi,e.NodeLockDialogComponent=U,e.ConfirmDialogComponent=qn,e.DialogModule=vi,e.LibraryDialogComponent=gi,e.forbidSpecialCharacters=pi,e.forbidEndingDot=ui,e.forbidOnlySpaces=hi,e.FolderCreateDirective=Si,e.FolderEditDirective=Ei,e.FolderDirectiveModule=Ci,e.ContentMetadataCardComponent=Oi,e.BasicPropertiesService=wi,e.ContentMetadataService=Xi,e.PropertyDescriptorsService=Qi,e.PropertyGroupTranslatorService=Pi,e.ContentMetadataConfigFactory=Yi,e.IndifferentConfigService=$i,e.LayoutOrientedConfigService=Gi,e.AspectOrientedConfigService=Vi,e.ContentMetadataModule=eo,e.PermissionListComponent=ro,e.NoPermissionTemplateComponent=so,e.InheritPermissionDirective=co,e.PermissionDisplayModel=no,e.NodePermissionDialogService=fo,e.NodePermissionService=io,e.AddPermissionPanelComponent=vo,e.AddPermissionComponent=So,e.AddPermissionDialogComponent=uo,e.PermissionManagerModule=Eo,e.ShareDialogComponent=Co,e.NodeSharedDirective=Oo,e.ContentNodeShareModule=wo,e.TreeViewModule=_o,e.TreeViewComponent=Po,e.TreeViewDataSource=ko,e.TreeBaseNode=No,e.TreeViewService=Fo,e.ContentModuleLazy=Bo,e.ContentModule=$o,e.l=Ki,e.c=$,e.b=I,e.a=S,e.m=go,e.d=zt,e.j=gn,e.k=Sn,e.i=fn,e.g=ln,e.h=dn,e.f=an,e.e=wn,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=adf-content-services.umd.min.js.map